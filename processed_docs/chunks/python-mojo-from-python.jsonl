{"chunk_id": "python-mojo-from-python-000", "document_id": "python-mojo-from-python", "content": "If you have an existing Python project that would benefit from Mojo's\nhigh-performance computing, you shouldn't have to rewrite the whole thing in\nMojo. Instead, you can write just the performance-critical parts your code in\nMojo and then call it from Python.\n\nexperiment Beta feature\n\nCalling Mojo code from Python is in early development. You should expect a lot\nof changes to the API and ergonomics. Likewise, this documentation is still a\nwork in progress. See below for [known limitations](#known-limitations).\n\n## Impor", "position": 0, "token_count": 113, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "python-mojo-from-python-000", "document_id": "python-mojo-from-python", "position": 0, "token_count": 113, "has_code": false, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python"}}
{"chunk_id": "python-mojo-from-python-001", "document_id": "python-mojo-from-python", "content": "t a Mojo module in Python\n\nTo illustrate what calling Mojo from Python looks like, we'll start with a\nsimple example, and then dig into the details of how it works and what is\npossible today.\n\nConsider a project with the following structure:\n\n```text\nproject\nâ”œâ”€â”€ ðŸ main.py\nâ””â”€â”€ ðŸ”¥ mojo_module.mojo\n```\n\nThe main entrypoint is a Python program called `main.py`, and the Mojo code\nincludes functions to call from Python.\n\nFor example, let's say we want a Mojo function to take a Python value as an\nargument:\n\n```mojo title=\"mojo_module.mojo\"\nfn factorial(py_obj: PythonObject) raises -> Python\n var n = Int(py_obj)\n return math.factorial(n)\n```\n\nAnd we want to call it from Python like this:\n\n```python title=\"main.py\"\nimport mojo_module\n\nprint(mojo_module.factorial(5))\n```\n\nHowever, before we can call the Mojo function from Python, we must declare it\nso Python knows it exists.\n\nBecause Python is trying to load `mojo_module`, it looks for a function called\n`PyInit_mojo_module()`. (If our file was called `foo.mojo`, the function Python\nlooked for would be `PyInit_foo()`.) Within the `PyInit_mojo_module()`, we must\ndeclare all Mojo functions and types that are callable from Python using\n[`PythonModuleBuilder`](/mojo/stdlib/python/bindings/PythonModuleBuilder).\n\nSo the complete Mojo code looks like this:\n\n```mojo title=\"mojo_module.mojo\"\nfrom python import PythonObject\nfrom python.bindings import PythonModuleBuilder\nimport math\nfrom os import abort", "position": 1, "token_count": 357, "has_code": true, "section_hierarchy": ["Import a Mojo module in Python"], "metadata": {"chunk_id": "python-mojo-from-python-001", "document_id": "python-mojo-from-python", "position": 1, "token_count": 357, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Import a Mojo module in Python"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#import-a-mojo-module-in-python"}}
{"chunk_id": "python-mojo-from-python-002", "document_id": "python-mojo-from-python", "content": "So the complete Mojo code looks like this:\n\n```mojo title=\"mojo_module.mojo\"\nfrom python import PythonObject\nfrom python.bindings import PythonModuleBuilder\nimport math\nfrom os import abort\n\n@export\nfn PyInit_mojo_module() -> PythonObject:\n try:\n var m = PythonModuleBuilder(\"mojo_module\")\n m.def_function[factorial](\"factorial\", docstring=\"Compute n!\")\n return m.finalize()\n except e:\n return abort[PythonObject](String(\"error creating Python Mojo module:\", e))\n\nfn factorial(py_obj: PythonObject) raises -> PythonObject:\n # Raises an exception if `py_obj` is not convertible to a Mojo `Int`.\n var n = Int(py_obj)\n\n return math.factorial(n)\n```\n\nOn the Python side, we add the directory containing `mojo_module.mojo` to the\nPython path, and then use a normal `import` statement to load our Mojo code:\n\n```python title=\"main.py\"\nimport mojo.importer\nimport sys\n\nsys.path.insert(0, \"\")\n\nimport mojo_module\n\nprint(mojo_module.factorial(5))\n```\n\nThat's it! Try it:\n\n```sh\npython main.py\n```\n\n```output\n120\n```\n\n### How it works\n\nPython supports a standard mechanism ca", "position": 2, "token_count": 266, "has_code": true, "section_hierarchy": ["Import a Mojo module in Python"], "metadata": {"chunk_id": "python-mojo-from-python-002", "document_id": "python-mojo-from-python", "position": 2, "token_count": 266, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Import a Mojo module in Python"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#import-a-mojo-module-in-python"}}
{"chunk_id": "python-mojo-from-python-003", "document_id": "python-mojo-from-python", "content": "lled [Python extension\nmodules](https://docs.python.org/3/extending/extending.html) that enables\ncompiled languages (like Mojo, C, C++, or Rust) to make themselves callable\nfrom Python in an intuitive way. Concretely, a Python extension module is\nsimply a dynamic library that defines a suitable `PyInit_*()` function.\n\nMojo comes with built-in functionality for defining Python extension modules.\nThe special stuff happens in the `mojo.importer` module we imported.\n\nIf we have a look at the filesystem after Python imports the Mojo code, we'll\nnotice there's a new `__mojocache__` directory, with dynamic library (`.so`)\nfile inside:\n\n```text\nproject\nâ”œâ”€â”€ main.py\nâ”œâ”€â”€ mojo_module.mojo\nâ””â”€â”€ __mojocache__\n â””â”€â”€ mojo_module.hash-ABC123.so\n```\n\nLoading `mojo.importer` loads our Python Mojo [import\nhook](https://docs.python.org/3/reference/import.html#import-hooks), which\nbehind the scenes looks for a `.mojo` (or `.ðŸ”¥`) file that matches the imported\nmodule name, and if found, compiles it using [`mojo build --emit shared-lib`](/mojo/cli/build#--emit-file_type) to generate a static library.\nThe resulting file is stored in `__mojocache__`, and is rebuilt only when\nit becomes stale (typically, when the Mojo source file changes).\n\nnote Clearing `__mojocache__`\n\nThe `__mojocache__` directory should only contain derived artifacts. It is always safe to delete the contents of a `__mojocache__` directory. Needed artifacts will simply be rebuilt the next time the Mojo module is imported.", "position": 3, "token_count": 369, "has_code": true, "section_hierarchy": ["Import a Mojo module in Python", "How it works"], "metadata": {"chunk_id": "python-mojo-from-python-003", "document_id": "python-mojo-from-python", "position": 3, "token_count": 369, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Import a Mojo module in Python", "How it works"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#how-it-works"}}
{"chunk_id": "python-mojo-from-python-004", "document_id": "python-mojo-from-python", "content": "note Clearing `__mojocache__`\n\nThe `__mojocache__` directory should only contain derived artifacts. It is always safe to delete the contents of a `__mojocache__` directory. Needed artifacts will simply be rebuilt the next time the Mojo module is imported.\n\nNow that we've looked at the basics of how Mojo can be used from Python, let's\ndig into the available features and how you can leverage them to accelerate\nyour Python with Mojo.\n\n## Bindings features\n\n### Binding Mojo types\n\nYou can bind any Mojo", "position": 4, "token_count": 113, "has_code": false, "section_hierarchy": ["Import a Mojo module in Python", "How it works"], "metadata": {"chunk_id": "python-mojo-from-python-004", "document_id": "python-mojo-from-python", "position": 4, "token_count": 113, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Import a Mojo module in Python", "How it works"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#how-it-works"}}
{"chunk_id": "python-mojo-from-python-005", "document_id": "python-mojo-from-python", "content": "type for use in Python", "position": 5, "token_count": 5, "has_code": false, "section_hierarchy": ["Bindings features"], "metadata": {"chunk_id": "python-mojo-from-python-005", "document_id": "python-mojo-from-python", "position": 5, "token_count": 5, "has_code": false, "overlap_with_previous": false, "section_hierarchy": ["Bindings features"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#bindings-features"}}
{"chunk_id": "python-mojo-from-python-006", "document_id": "python-mojo-from-python", "content": "using\n[`PythonModuleBuilder`](/mojo/stdlib/python/bindings/PythonModuleBuilder/).\nFor example:\n\n```mojo\n@fieldwise_init\nstruct Person(Movable, Representable):\n var name: String\n var age: Int\n\n fn __repr__(self) -> String:\n return String(\"Person(\", self.name, \", \", self.age, \")\")\n\n@export\nfn PyInit_person_module() -> PythonObject:\n try:\n var mb = PythonModuleBuilder(\"person_module\")\n var person_type = mb.add_type[Person](\"Person\")\n except e:\n return abort[PythonObject](\"error creating Mojo module\")\n```\n\nWhen you call\n[`add_type()`](/mojo/stdlib/python/bindings/PythonModuleBuilder/#add_type), it\nreturns a\n[`PythonTypeBuilder`](/mojo/stdlib/python/bindings/PythonTypeBuilder), which\nyou can then use to bind the type constructor (see [binding Python\ninitializers](#constructing-mojo-objects-in-python), below) and methods.\n\nAny Mojo type bound using a `PythonTypeBuilder` has the resulting Python\n'type' object globally registered, enabling two features:\n\n* Constructing Python objects that wrap Mojo values for use from Python using\n `PythonObject(alloc=Person(..))`.\n\n* Downcasting using `python_obj.downcast_value_ptr[Person]()`\n\n[note]\nMojo types must implement\n[`Representable`](/mojo/stdlib/builtin/repr/Representable/) to be bound for use\nin Python. Additional traits are required for specific binding features:\n`Movable` for custom initializers (`def_py_init`), and both `Defaultable` and\n`Movable` for default initializers (`def_init_defaultable`).", "position": 6, "token_count": 359, "has_code": true, "section_hierarchy": ["Bindings features", "Binding Mojo types"], "metadata": {"chunk_id": "python-mojo-from-python-006", "document_id": "python-mojo-from-python", "position": 6, "token_count": 359, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Bindings features", "Binding Mojo types"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#binding-mojo-types"}}
{"chunk_id": "python-mojo-from-python-007", "document_id": "python-mojo-from-python", "content": "[note]\nMojo types must implement\n[`Representable`](/mojo/stdlib/builtin/repr/Representable/) to be bound for use\nin Python. Additional traits are required for specific binding features:\n`Movable` for custom initializers (`def_py_init`), and both `Defaultable` and\n`Movable` for default initializers (`def_init_defaultable`).\n\nHowever, merely binding a Mojo type to a Python `type` object isnâ€™t very useful on its own. Next, weâ€™ll tell Python how to interact with our Mojo typeâ€”starting with how to construct instances of our Mojo type from within Python.\n\n### Constructing Mojo objects in Python\n\nMojo types can be constructed from Python by declaring a Mojo constructor func", "position": 7, "token_count": 153, "has_code": false, "section_hierarchy": ["Bindings features", "Binding Mojo types"], "metadata": {"chunk_id": "python-mojo-from-python-007", "document_id": "python-mojo-from-python", "position": 7, "token_count": 153, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Bindings features", "Binding Mojo types"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#binding-mojo-types"}}
{"chunk_id": "python-mojo-from-python-008", "document_id": "python-mojo-from-python", "content": "tion as a Python-compatible object initializer using\n[`def_py_init()`](/mojo/stdlib/python/bindings/PythonTypeBuilder#def_py_init)\nwhen you add the type to your module. For example:\n\n```mojo\n@export\nfn PyInit_person_module() -> PythonObject:\n try:\n var mb = PythonModuleBuilder(\"person_module\")\n # highlight-start\n _ = mb.add_type[Person](\"Person\").def_py_init[Person.py_init]()\n # highlight-end\n return mb.finalize()\n except e:\n return abort[PythonObject](\n String(\"error creating Python Mojo module:\", e)\n )\n\n@fieldwise_init\nstruct Person(Movable, Representable):\n var name: String\n var age: Int\n\n fn __repr__(self) -> String:\n return String(\"Person(\", self.name, \", \", self.age, \")\")\n\n # highlight-start\n @staticmethod\n fn py_init(\n out self: Person, args: PythonObject, kwargs: PythonObject\n ) raises:\n # Validate argument count\n if len(args) != 2:\n raise Error(\"Person() takes exactly 2 arguments\")\n\n # Convert Python arguments to Mojo types\n var name = String(args[0])\n var age = Int(args[1])\n\n self = Self(name, age)\n # highlight-end\n```\n\nWith this Mojo binding, you can create `Person` instances in Python:\n\n```python\nperson = person_module.Person(\"Sarah\", 32)\nprint(person)\n```\n\n```output\nPerson(Sarah, 32)\n```\n\nFor types that support default construction, you can use the simpler\n[`def_init_defaultable()`](/mojo/stdlib/python/bindings/PythonTypeBuilder#def_init_defaultable)\nmethod:\n\n```mojo\nvar counter_type = m.add_type[Counter](\"Counter\")\ncounter_type.def_init_defaultable[Counter]()\n```\n\nThis enables Python code to create instances without arguments:\n\n```python\ncounter = counter_module.Counter() # Creates Counter()\n```", "position": 8, "token_count": 398, "has_code": true, "section_hierarchy": ["Bindings features", "Constructing Mojo objects in Python"], "metadata": {"chunk_id": "python-mojo-from-python-008", "document_id": "python-mojo-from-python", "position": 8, "token_count": 398, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Bindings features", "Constructing Mojo objects in Python"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#constructing-mojo-objects-in-python"}}
{"chunk_id": "python-mojo-from-python-009", "document_id": "python-mojo-from-python", "content": "```mojo\nvar counter_type = m.add_type[Counter](\"Counter\")\ncounter_type.def_init_defaultable[Counter]()\n```\n\nThis enables Python code to create instances without arguments:\n\n```python\ncounter = counter_module.Counter() # Creates Counter()\n```\n\nnote \"Constructor\" vs \"Initializer\"\n\nIn Python, object construction happens across both the `__new__()` and\n`__init__()` methods, so the `__init__()` method is technically just the\nattribute initializer. However, in a Mojo struct, there's no `__new__()`\nmethod, so we prefer to always call `__init__()` the constructor.\n\n### Returning Mojo objects to Python\n\nMojo functions called from Python don't just need to be able to accept\n[`PythonObject`](/mojo/stdlib/python/python_object/PythonObject) values as\narguments, they also need to be able to return new values. And sometimes, they\neven need to be able t", "position": 9, "token_count": 196, "has_code": true, "section_hierarchy": ["Bindings features", "Constructing Mojo objects in Python"], "metadata": {"chunk_id": "python-mojo-from-python-009", "document_id": "python-mojo-from-python", "position": 9, "token_count": 196, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Bindings features", "Constructing Mojo objects in Python"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#constructing-mojo-objects-in-python"}}
{"chunk_id": "python-mojo-from-python-010", "document_id": "python-mojo-from-python", "content": "o return Mojo native values back to Python. This is\npossible by using the `PythonObject(alloc=<value>)` constructor.\n\nAn example of this looks like:\n\n```mojo\nfn create_person() -> PythonObject:\n var person = Person(\"Sarah\", 32)\n return PythonObject(alloc=person^)\n```\n\n[caution]\n`PythonObject(alloc=...)` will raise an exception if the provided Mojo\nobject type had not previously been registered using\n[`PythonModuleBuilder.add_type()`](/mojo/stdlib/python/bindings/PythonModuleBuilder#add_type).\n\n### `PythonObject` to Mojo values\n\nWithin any Mojo code that is handling a\n[`PythonObject`](/mojo/stdlib/python/python_object/PythonObject), but\nespecially within Mojo functions called from Python, it's common to expect an\nargument of a particular type.\n\nThere are two ways in which a `PythonObject", "position": 10, "token_count": 188, "has_code": true, "section_hierarchy": ["Bindings features", "Returning Mojo objects to Python"], "metadata": {"chunk_id": "python-mojo-from-python-010", "document_id": "python-mojo-from-python", "position": 10, "token_count": 188, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Bindings features", "Returning Mojo objects to Python"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#returning-mojo-objects-to-python"}}
{"chunk_id": "python-mojo-from-python-011", "document_id": "python-mojo-from-python", "content": "` can be turned into a native\nMojo value:\n\n* **Converting** a Python object into a newly constructed Mojo value that has\n the same logical value as the original Python object.\n This is handled by the [`ConvertibleFromPython`][ConvertibleFromPython] trait.\n\n* **Downcasting** a Python object that holds a native Mojo value to a pointer\n to that inner value.\n This is handled by [`PythonObject.downcast_value_ptr()`][downcast_value_ptr].\n\n#### `PythonObject` conversions\n\nMany Mojo types support conversion directly from equivalent Python types, via\nthe [`ConvertibleFromPython`][ConvertibleFromPython] trait:\n\n```mojo\n# Given a person, clone them and give them a different name.\nfn create_person(\n name_obj: PythonObject,\n age_obj: PythonOb", "position": 11, "token_count": 163, "has_code": true, "section_hierarchy": ["Bindings features", "`PythonObject` to Mojo values"], "metadata": {"chunk_id": "python-mojo-from-python-011", "document_id": "python-mojo-from-python", "position": 11, "token_count": 163, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Bindings features", "`PythonObject` to Mojo values"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#pythonobject-to-mojo-values"}}
{"chunk_id": "python-mojo-from-python-012", "document_id": "python-mojo-from-python", "content": "ject\n) raises -> PythonObject:\n # These conversions will raise an exception if they fail\n var name = String(name_obj)\n var age = Int(age_obj)\n\n return PythonObject(alloc=Person(nam", "position": 12, "token_count": 42, "has_code": false, "section_hierarchy": ["Bindings features", "`PythonObject` to Mojo values", "`PythonObject` conversions"], "metadata": {"chunk_id": "python-mojo-from-python-012", "document_id": "python-mojo-from-python", "position": 12, "token_count": 42, "has_code": false, "overlap_with_previous": false, "section_hierarchy": ["Bindings features", "`PythonObject` to Mojo values", "`PythonObject` conversions"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#pythonobject-conversions"}}
{"chunk_id": "python-mojo-from-python-013", "document_id": "python-mojo-from-python", "content": "e, age))\n```\n\nWhich could be called from Python using:\n\n```python\nperson = mojo_module.create_person(\"John Smith\")\n```\n\nPassing invalid arguments will result in a runtime argument error:\n\n```python\nperson = mojo_module.create_person(42)\n```\n\n#### `PythonObject` downcasts\n\nDowncasting from `PythonObject` values to the inner Mojo value:\n\n```mojo\nfn print_age(person_obj: PythonObject) raises:\n # Raises if `obj` does not contain an instance of the Mojo `Person` type.\n var person = person_obj.downcast_value_ptr[Person]()\n\n print(\"Person is\", person[].age, \"year", "position": 13, "token_count": 135, "has_code": true, "section_hierarchy": ["Given a person, clone them and give them a different name."], "metadata": {"chunk_id": "python-mojo-from-python-013", "document_id": "python-mojo-from-python", "position": 13, "token_count": 135, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Given a person, clone them and give them a different name."], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#given-a-person-clone-them-and-give-them-a-different-name"}}
{"chunk_id": "python-mojo-from-python-014", "document_id": "python-mojo-from-python", "content": "s old\")\n```\n\nUnsafe mutation via downcasting is also supported. It is up to the user to ensure\nthat this mutable pointer does not alias any other pointers to the same object\nwithin Mojo:\n\n```mojo\nfn birthday(person_obj: PythonObject):\n var person = person_obj.downcast_value_ptr[Person]()\n\n person[].age += 1\n```\n\nEntirely unchecked downcastingâ€”which does no type checkingâ€”can be done using:\n\n```mojo\nfn get_person(person_obj: PythonObject):\n var person = person_obj.unchecked_downcast_value_ptr[Person]()\n```\n\nUnchecked downcasting can be used to eliminate overhead when optimizing a tight\ninner loop with Mojo, and you've benchmarked and measured that type checking\ndowncasts is a significant bottleneck.\n\n{/* <!-- TODO:\nSince `PythonObject` are reference counted, and Mojo `Pointer` is guaranteed\nto be either immutable or a unique pointer, safe object downcasting currently\nonly works to immutable pointers.\n--> */}\n\n### Methods\n\nWhen binding Mojo objects for use from Python, you can expose chosen methods to\nPython as well, using [`PythonTypeBuilder.def_method()`](/mojo/stdlib/python/bindings/PythonTypeBuilder/#def_method).\n\nCurrently, Mojo methods being exposed to Python must be written with a modification\ncompared to normal Mojo methods: they must", "position": 14, "token_count": 275, "has_code": true, "section_hierarchy": ["Given a person, clone them and give them a different name.", "`PythonObject` downcasts"], "metadata": {"chunk_id": "python-mojo-from-python-014", "document_id": "python-mojo-from-python", "position": 14, "token_count": 275, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Given a person, clone them and give them a different name.", "`PythonObject` downcasts"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#pythonobject-downcasts"}}
{"chunk_id": "python-mojo-from-python-015", "document_id": "python-mojo-from-python", "content": "be a `@staticmethod` that takes\neither `py_self: PythonObject` or `self_ptr: UnsafePointer[Self]`:\n\n```mojo\nfrom python import PythonObject\nfrom python.bindings import PythonModuleBuilder\nfrom os import abort\n\n@export\nfn PyInit_mojo_module() -> PythonObject:\n try:\n var mb = PythonModuleBuilder(\"mojo_module\")\n # highlight-start\n _ = mb.add_type[Person](\"Person\")\n .def_method[Person.get_name](\"get_name\")\n .def_method[Person.set_age](\"set_age\")\n # highlight-end\n return mb.finalize()\n except e:\n return abort[PythonObject](\"error creating Mojo module\")\n\nstruct Person(Representable):\n var name: String\n var age: Int\n\n # highlight-start\n @staticmethod\n fn get_name(py_self: PythonObject) raises -> PythonObject:\n var self_ptr = py_self.downcast_value_ptr[Self]()\n return self_ptr[].name\n\n @staticmethod\n fn set_age(self_ptr: UnsafePointer[Self], new_age: PythonObject) raises:\n self_ptr[].age = Int(new_age)\n # highlight-end\n\n fn __repr__(self) -> String:\n return String(\"Person(\", self.name, \", \", self.age, \")\")\n```\n\nTaking `py_self: PythonObject` allows access to the full `PythonObject` allocation that a Mojo object instance is stored inside of. Typically though, taking `py_self: UnsafePointer[Self]` will minimize boilerplate in the common case that a method merely needs to access the fields of an object.\n\nMojo methods called from Python are currently required to take non-standard self types due to limitations that will be lifted in future versions of Python Mojo bindings.\n\n### Static methods", "position": 15, "token_count": 352, "has_code": true, "section_hierarchy": ["Given a person, clone them and give them a different name.", "Methods"], "metadata": {"chunk_id": "python-mojo-from-python-015", "document_id": "python-mojo-from-python", "position": 15, "token_count": 352, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Given a person, clone them and give them a different name.", "Methods"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#methods"}}
{"chunk_id": "python-mojo-from-python-016", "document_id": "python-mojo-from-python", "content": "Mojo methods called from Python are currently required to take non-standard self types due to limitations that will be lifted in future versions of Python Mojo bindings.\n\n### Static methods\n\nPython Mojo bindings supports exposing Python `@staticmethods`, bound using [`PythonTypeBuilder.def_staticmethod()`](/mojo/stdlib/python/bindings/PythonTypeBuilder/#def_staticmethod). A function declared using `def_staticmethod()` is callable as a static method on the type within Python, without needing an object instance.\n\n```mojo\nfrom python import PythonObject\nfrom python.bindings import PythonModuleBuilder\nfrom os import abort\n\n@export", "position": 16, "token_count": 126, "has_code": true, "section_hierarchy": ["Given a person, clone them and give them a different name.", "Methods"], "metadata": {"chunk_id": "python-mojo-from-python-016", "document_id": "python-mojo-from-python", "position": 16, "token_count": 126, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Given a person, clone them and give them a different name.", "Methods"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#methods"}}
{"chunk_id": "python-mojo-from-python-017", "document_id": "python-mojo-from-python", "content": "fn PyInit_mojo_module() -> PythonObject:\n try:\n var mb = PythonModuleBuilder(\"mojo_module\")\n # highlight-start\n mb.add_type[Person](\"Person\")\n .def_staticmethod[Person.is_valid_age](\"is_valid_age\")\n # highlight-end\n return mb.finalize()\n except e:\n return abort[PythonObject](\"error creating Mojo module\")\n\nstruct Person(Representable):\n var name: String\n var age: Int\n\n # highlight-start\n @staticmethod\n fn is_valid_age(age_obj: PythonObject) raises -> PythonObject:\n var age = Int(age_obj)\n return 0 <= age <= 130\n # highlight-end\n\n fn __repr__(self) -> String:\n return String(\"Person(\", self.name, \", \", self.age, \")\")\n```\n\nCalling a Mojo function bound as a static method looks like a typical Python static method call directly on the type object:\n\n```python title=\"main.py\"\nfrom mojo_module import Person\n\nprint(Person.is_valid_age(45)) # Prints 'True'\nprint(Person.is_valid_age(-1)) # Prints 'False'\n```\n\n### Keyword arguments\n\n[Keyword arguments in Mojo](/mojo/manual/functions/#keyword-arguments) come in two forms:\n\n1. Keyword-only arguments: `fn foo(*, x: Int)`\n This is not currently supported in Python Mojo bindings.\n2. [Variadic keyword arguments](/manual/functions/#variadic-keyword-arguments): `fn foo(**kwargs: Int)`\n This is supported in Python Mojo bindings when used in the unsugared form: `fn foo(kwargs: OwnedKwargsDict)`. (The `**kwargs` syntax limitation will be removed in the future.)\n\nYou can define Mojo functions that accept variadic keyword argu", "position": 17, "token_count": 352, "has_code": true, "section_hierarchy": ["Given a person, clone them and give them a different name.", "Static methods"], "metadata": {"chunk_id": "python-mojo-from-python-017", "document_id": "python-mojo-from-python", "position": 17, "token_count": 352, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Given a person, clone them and give them a different name.", "Static methods"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#static-methods"}}
{"chunk_id": "python-mojo-from-python-018", "document_id": "python-mojo-from-python", "content": "ments using [`OwnedKwargsDict[PythonObject]`](/mojo/stdlib/collections/dict/OwnedKwargsDict) as the last argument. A simple example looks like:\n\n```python\nimport mojo_module\n\nresult = mojo_module.sum_kwargs_ints(a=10, b=20, c=30) # returns 60\n```\n\n```mojo\nfrom collections import OwnedKwargsDict\n\ndef sum_kwargs_ints(kwargs: OwnedKwargsDict[PythonObject]) -> PythonObject:\n var total = 0\n for entry in kwargs.items():\n total += Int(entry.value)\n return PythonObject(total)\n```\n\nKeyword arguments are also supported following normal positional arguments. Additionally, getting specific keyword arguments is a dictionary lookup on the `OwnedKwargsDict`:\n\n```mojo\nfrom collections import OwnedKwargsDict\n\ndef duration_in_seconds(\n hours_obj: PythonObject,\n minutes_obj: PythonObject,\n kwargs: OwnedKwargsDict[PythonObject]\n) -> PythonObject:\n var hours = Int(hours_obj)\n var minutes = Int(minutes_obj)\n\n var seconds = Int(kwargs[\"seconds\"])\n\n return hours * 3600 + minutes * 60 + seconds\n```\n\nIn this example, if a call to `duration_in_seconds()` is missing the required `\"seconds\"` named argument, a runtime exception will occur:\n\n```python title=\"main.py\"\nfrom mojo_module import duration_in_seconds\n\n# Pass hours and minutes, missing \"seconds\"\nduration_in_seconds(4, 5) # ERROR: KeyError\n```\n\nKeyword arguments are supported when bindings top-level functions, methods, and static methods.\n\n### Variadic arguments\n\nPython and Mojo variadic arguments are normally written using the following syntax:\n\n```mojo\nfn foo(*args: Int):\n ...\n```\n\nHowever, this syntax is not yet supported in Python/Mojo bindings, because functions bound using\n[`def_function()`](/mojo/stdlib/python/bindings/PythonModuleBuilder#def_function)\nsupport only fixed-arity functions.", "position": 18, "token_count": 406, "has_code": true, "section_hierarchy": ["Given a person, clone them and give them a different name.", "Keyword arguments"], "metadata": {"chunk_id": "python-mojo-from-python-018", "document_id": "python-mojo-from-python", "position": 18, "token_count": 406, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Given a person, clone them and give them a different name.", "Keyword arguments"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#keyword-arguments"}}
{"chunk_id": "python-mojo-from-python-019", "document_id": "python-mojo-from-python", "content": "pt\na variadic number of arguments to Python using the lower-level\n[`def_py_function()`](/mojo/stdlib/python/bindings/PythonModuleBuilder#def_py_function)\ninterface, which leaves it to the us", "position": 19, "token_count": 46, "has_code": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\""], "metadata": {"chunk_id": "python-mojo-from-python-019", "document_id": "python-mojo-from-python", "position": 19, "token_count": 46, "has_code": false, "overlap_with_previous": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\""], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#pass-hours-and-minutes-missing-seconds"}}
{"chunk_id": "python-mojo-from-python-020", "document_id": "python-mojo-from-python", "content": "er to validate the number of arguments\nprovided:\n\n```mojo\n@export\nfn PyInit_mojo_module() -> PythonObject:\n try:\n var b = PythonModuleBuilder(\"mojo_module\")\n b.def_py_function[count_args](\"count_args\")\n b.def_py_function[sum_args](\"sum_args\")\n b.def_py_function[lookup](\"lookup\")\n\nfn count_args(py_self: PythonObject, args_tuple: PythonObject) raises:\n return len(args_tuple)\n\nfn sum_args(py_self: PythonObject, args_tuple: PythonObject) raises:\n var total = args_tuple[0]\n for i in range(1, len(args_tuple)):\n total += args_tuple[i]\n return total\n\nfn lookup(py_self: PythonObject, args_tuple: PythonObject) raises:\n if len(args_tuple) != 2 and len(args_tuple) != 3:\n raise Error(\"lookup() expects 2 or 3 arguments\")\n\n var collection = args_tuple[0]\n var key = args_tuple[1]\n\n try:\n return collection[key]\n except e:\n if len(args) == 3:\n return args_tuple[2]\n else:\n raise e\n```\n\n## Strategies for porting Python to Mojo\n\n### Writing Pythonic code in Mojo\n\nIn this approach to bindings, we embrace the flexibility of Python, and eschew\ntrying to convert `PythonObject` arguments into the narrowly constrained,\nstrongly-typed space of the Mojo type system, in favor of just writing some code\nand letting it raise an exception at runtime if we got something wrong.\n\nThe flexibility of `PythonObject` enables a unique programming style, wherein\nPython code can be \"ported\" to Mojo with relatively few changes.\n\n```python\ndef foo(x, y, z):\n x[y] = int(z)\n x = y + z\n```\n\nRule of thumb: Any Python builtin function should be accessible in Mojo using\n`Python.<builtin>()`.\n\n```mojo\nfn foo(x: PythonObject, y: Pyth", "position": 20, "token_count": 402, "has_code": true, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Variadic arguments"], "metadata": {"chunk_id": "python-mojo-from-python-020", "document_id": "python-mojo-from-python", "position": 20, "token_count": 402, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Variadic arguments"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#variadic-arguments"}}
{"chunk_id": "python-mojo-from-python-021", "document_id": "python-mojo-from-python", "content": "onObject, z: PythonObject) -> PythonObject", "position": 21, "token_count": 11, "has_code": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Strategies for porting Python to Mojo"], "metadata": {"chunk_id": "python-mojo-from-python-021", "document_id": "python-mojo-from-python", "position": 21, "token_count": 11, "has_code": false, "overlap_with_previous": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Strategies for porting Python to Mojo"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#strategies-for-porting-python-to-mojo"}}
{"chunk_id": "python-mojo-from-python-022", "document_id": "python-mojo-from-python", "content": ":\n x[y] = Python.int(z)\n x = y + z\n```\n\n## Building Mojo extension modules\n\nYou can create and distribute your Mojo modules for Python in the following\nways:\n\n* As source files, compiled on demand using the Python Mojo importer hook.\n\n The advantage of this approach is that it's easy to get started with, and\n keeps your project structure simple, while ensuring that your imported Mojo\n code is always up to date after you make an edit.\n\n* As pre-built Python extension module `.so` dynamic libraries, compiled using:\n\n ```bash\n mojo build mojo_module.mojo --emit shared-lib -o mojo_module.so\n\n This has the advantage that you can specify any other necessary build options\n manually (optimization or debug flags, import paths, etc.), providing an\n \"escape hatch\" from the Mojo i", "position": 22, "token_count": 169, "has_code": true, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Strategies for porting Python to Mojo", "Writing Pythonic code in Mojo"], "metadata": {"chunk_id": "python-mojo-from-python-022", "document_id": "python-mojo-from-python", "position": 22, "token_count": 169, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Strategies for porting Python to Mojo", "Writing Pythonic code in Mojo"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#writing-pythonic-code-in-mojo"}}
{"chunk_id": "python-mojo-from-python-023", "document_id": "python-mojo-from-python", "content": "mport hook abstraction for advanced users.\n\n## Known limitations\n\nWhile we have big ambitions for Python to Mojo interoperabilityâ€”our goal is for\nMojo to be the best way to extend Pythonâ€”this feature is still in early and\nactive development, and there are some limitations to be aware of. These will\nbe lifted over time.\n\n* **Functions taking more than 6 arguments.**\n Currently `PyTypeBuilder.add_function()` and related\n function bindings only support Mojo functions that take up to 6 `PythonObject`\n arguments: `fn(PythonObject, PythonObject, PythonObject, PythonObject, PythonObject, PythonObject)`.\n\n* **Keyword arguments syntax.**\n Currently, Mojo functions called from Python only accept keyword arguments\n when using a trailing `kwargs: OwnedKwargsDict[PythonObject]` argument.\n Supp", "position": 23, "token_count": 170, "has_code": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Building Mojo extension modules"], "metadata": {"chunk_id": "python-mojo-from-python-023", "document_id": "python-mojo-from-python", "position": 23, "token_count": 170, "has_code": false, "overlap_with_previous": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Building Mojo extension modules"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#building-mojo-extension-modules"}}
{"chunk_id": "python-mojo-from-python-024", "document_id": "python-mojo-from-python", "content": "ort for native `**kwargs` syntax will be added in the future.\n\n* **Mojo package dependencies.**\n Mojo code that has dependencies on packages other than the Mojo stdlib\n (like those in the ever-growing\n [Modular Community](https://github.com/modular/modular-community) package\n channel) are currently only supported when building Mojo extension modules\n manually, as the Mojo import hook does not currently support a way to\n specify import paths for Mojo package dependencies.\n\n* **Properties.**\n Computed properties getter and setters are not currently supported.\n\n* **Expected type conversions.**\n A handful of Mojo standard library types can be constructed directly from\n equivalent Python builtin object types, by implementing the\n [`ConvertibleFromPython`][ConvertibleFromPython] trait.\n However, many Mojo standard library types do not yet implement this trait,\n so may require manual conversion logic if needed.\n\n[ConvertibleFromPython]: /mojo/stdlib/python/python_object/ConvertibleFromPython\n\n[downcast_value_ptr]: /mojo/stdlib/python/python_object/PythonObject#downcast_value_ptr", "position": 24, "token_count": 218, "has_code": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Known limitations"], "metadata": {"chunk_id": "python-mojo-from-python-024", "document_id": "python-mojo-from-python", "position": 24, "token_count": 218, "has_code": false, "overlap_with_previous": false, "section_hierarchy": ["Pass hours and minutes, missing \"seconds\"", "Known limitations"], "file_path": "python/mojo-from-python.mdx", "url": "https://docs.modular.com/mojo/manual/python/mojo-from-python", "title": "Calling Mojo from Python", "category": null, "tags": [], "section_url": "https://docs.modular.com/mojo/manual/python/mojo-from-python#known-limitations"}}

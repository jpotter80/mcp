## 2025-11-03 MojoDocs MCP runtime plan

- Goal: Use a minimal MCP server in VS Code to let agents query the Mojo manual via hybrid search (DuckDB + FTS + HNSW + MAX embeddings).
- Runtime-only package: `runtime/` contains only `mcp_server/server.py` wrapper, `search.py`, `main.db`, and README. Preprocessing pipeline stays out of runtime.
- VS Code configuration: Register stdio MCP server with `command: python` (or absolute interpreter), `args: ["mcp_server/server.py"]`, `cwd` pointing to the runtime folder, and env vars: `MOJO_DB_PATH`, `MAX_SERVER_URL`, `EMBED_MODEL_NAME`, `AUTO_START_MAX`.
- Auto-start MAX: Server lifespan tries to start `max serve --model all-mpnet-base-v2` if `MAX_SERVER_URL` isnâ€™t reachable and `AUTO_START_MAX!=0`.
- Robustness: `search.py` avoids stdout logging (stderr only), and falls back to FTS-only if embeddings are unavailable.
- Inspector: `mcp dev mcp_server/server.py` launches the MCP Inspector; use its UI to export `mcp.json` entries for other clients if needed.

[workspace]
channels = ["https://conda.modular.com/max-nightly", "conda-forge"]
name = "mcp"
platforms = ["linux-64"]
version = "0.1.0"

[tasks]
process = "python -m preprocessing.src.pipeline"
generate-embeddings = "python embedding/generate_embeddings.py"
consolidate = "python embedding/consolidate_data.py"
load = "python embedding/load_to_ducklake.py"
index = "python embedding/create_indexes.py"
search = "python search.py"
mcp-dev = "mcp dev mcp_server/server.py"
max-serve = "max serve --model sentence-transformers/all-mpnet-base-v2"

# Phase 3: MCP-specific build tasks (Mojo)
mojo-process = "python -m preprocessing.src.pipeline --config servers/mojo-manual-mcp/config/processing_config.yaml"
mojo-generate-embeddings = "python embedding/generate_embeddings.py --mcp-name mojo --config servers/mojo-manual-mcp/config/processing_config.yaml"
mojo-consolidate = "python embedding/consolidate_data.py --mcp-name mojo"
mojo-load = "python embedding/load_to_ducklake.py --mcp-name mojo"
mojo-index = "python embedding/create_indexes.py --mcp-name mojo"

mojo-build = """
pixi run mojo-process && \
pixi run mojo-generate-embeddings && \
pixi run mojo-consolidate && \
pixi run mojo-load && \
pixi run mojo-index
"""

# Demonstration: generic tasks with explicit mcp-name
process-mojo = "python -m preprocessing.src.pipeline --config servers/mojo-manual-mcp/config/processing_config.yaml --mcp-name mojo"
generate-embeddings-mojo = "python embedding/generate_embeddings.py --mcp-name mojo"







[dependencies]
python = "==3.12.3"
openai = ">=2.3.0,<3"
duckdb = ">=1.4.1,<2"
modular = "==25.6"
tiktoken = ">=0.12.0,<0.13"
python-frontmatter = ">=1.1.0,<2"
pyyaml = ">=6.0.3,<7"
pathlib = ">=1.0.1,<2"
numpy = ">=2.3.3,<3"
requests = ">=2.32.5,<3"
pyarrow = ">=21.0.0,<22"
pandas = ">=2.3.3,<3"
tqdm = ">=4.67.1,<5"
langchain-text-splitters = ">=1.0.0,<2"
sentence-transformers = ">=5.1.2,<6"

[pypi-dependencies]
mcp = { version = ">=1.20.0, <2", extras = ["cli"] }

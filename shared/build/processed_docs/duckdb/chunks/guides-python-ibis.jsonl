{"chunk_id": "guides-python-ibis-000", "document_id": "guides-python-ibis", "content": "[Ibis](https://ibis-project.org) is a Python dataframe library that supports 20+ backends, with DuckDB as the default. Ibis with DuckDB provides a Pythonic interface for SQL with great performance.\n\n## Installation\n\nYou can pip install Ibis with the DuckDB backend:\n\n```batch\npip install 'ibis-framework[duckdb,examples]' # examples is only required to access the sample data Ibis provides\n```\n\nor use conda:\n\n```batch\nconda install ibis-framework\n```\n\nor use mamba:\n\n```batch\nmamba install ibis-framework\n```", "position": 0, "token_count": 143, "has_code": true, "section_hierarchy": ["Installation"], "metadata": {"chunk_id": "guides-python-ibis-000", "document_id": "guides-python-ibis", "position": 0, "token_count": 143, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Installation"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#installation"}}
{"chunk_id": "guides-python-ibis-001", "document_id": "guides-python-ibis", "content": "## Create a Database File\n\nIbis can work with several file types, but at its core, it connects to existing databases and interacts with the data there. You can get started with your own DuckDB databases or create a new one with example data.\n\n```python\nimport ibis\n\ncon = ibis.connect(\"duckdb://penguins.ddb\")\ncon.create_table(\n \"penguins\", ibis.examples.penguins.fetch().to_pyarrow(), overwrite = True\n)\n```\n\n```python", "position": 1, "token_count": 121, "has_code": true, "section_hierarchy": ["Create a Database File"], "metadata": {"chunk_id": "guides-python-ibis-001", "document_id": "guides-python-ibis", "position": 1, "token_count": 121, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Create a Database File"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#create-a-database-file"}}
{"chunk_id": "guides-python-ibis-002", "document_id": "guides-python-ibis", "content": "# Output:\nDatabaseTable: penguins\n species string\n island string\n bill_length_mm float64\n bill_depth_mm float64\n flipper_length_mm int64\n body_mass_g int64\n sex string\n year int64\n```\n\nYou can now see the example dataset copied over to the database:\n\n```python\n# reconnect to the persisted database (dropping temp tables)\ncon = ibis.connect(\"duckdb://penguins.ddb\")\ncon.list_tables()\n```\n\n```python\n# Output:\n['penguins']\n```\n\nThere's one table, called `penguins`. We can ask Ibis to give us an object that we can interact with.\n\n```python\npenguins = con.table(\"penguins\")\npenguins\n```\n\n```text", "position": 2, "token_count": 175, "has_code": true, "section_hierarchy": ["Output:"], "metadata": {"chunk_id": "guides-python-ibis-002", "document_id": "guides-python-ibis", "position": 2, "token_count": 175, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Output:"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#output"}}
{"chunk_id": "guides-python-ibis-003", "document_id": "guides-python-ibis", "content": "# Output:\nDatabaseTable: penguins\n species string\n island string\n bill_length_mm float64\n bill_depth_mm float64\n flipper_length_mm int64\n body_mass_g int64\n sex string\n year int64\n```\n\nIbis is lazily evaluated, so instead of seeing the data, we see the schema of the table. To peek at the data, we can call `head` and then `to_pandas` to get the first few rows of the table as a pandas DataFrame.\n\n```python\npenguins.head().to_pandas()", "position": 3, "token_count": 125, "has_code": true, "section_hierarchy": ["Output:"], "metadata": {"chunk_id": "guides-python-ibis-003", "document_id": "guides-python-ibis", "position": 3, "token_count": 125, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Output:"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#output"}}
{"chunk_id": "guides-python-ibis-004", "document_id": "guides-python-ibis", "content": "```\n\n```text\n species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex year\n0 Adelie Torgersen 39.1 18.7 181.0 3750.0 male 2007\n1 Adelie Torgersen 39.5 17.4 186.0 3800.0 female 2007\n2 Adelie Torgersen 40.3 18.0 195.0 3250.0 female 2007\n3 Adelie Torgersen NaN NaN NaN NaN None 2007\n4 Adelie Torgersen 36.7 19.3 193.0 3450.0 female 2007\n```\n\n`to_pandas` takes the existing lazy table expression and evaluates it. If we leave it off, you'll see the Ibis representation of the table expression that `to_pandas` will evaluate (when you're ready!).\n\n```python\npenguins.head()\n```\n\n```python", "position": 4, "token_count": 207, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-004", "document_id": "guides-python-ibis", "position": 4, "token_count": 207, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-005", "document_id": "guides-python-ibis", "content": "# Output:\nr0 := DatabaseTable: penguins\n species string\n island string\n bill_length_mm float64\n bill_depth_mm float64\n flipper_length_mm int64\n body_mass_g int64\n sex string\n year int64\n\nLimit[r0, n=5]\n```\n\nIbis returns results as a pandas DataFrame using `to_pandas`, but isn't using pandas to perform any of the computation. The query is executed by DuckDB. Only when `to_pandas` is called does Ibis then pull back the results and convert them into a DataFrame.", "position": 5, "token_count": 129, "has_code": true, "section_hierarchy": ["Output:"], "metadata": {"chunk_id": "guides-python-ibis-005", "document_id": "guides-python-ibis", "position": 5, "token_count": 129, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Output:"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#output"}}
{"chunk_id": "guides-python-ibis-006", "document_id": "guides-python-ibis", "content": "## Interactive Mode\n\nFor the rest of this intro, we'll turn on interactive mode, which partially executes queries to give users a preview of the results. There is a small difference in the way the output is formatted, but otherwise this is the same as calling `to_pandas` on the table expression with a limit of 10 result rows returned.\n\n```python\nibis.options.interactive = True\npenguins.head()", "position": 6, "token_count": 94, "has_code": true, "section_hierarchy": ["Interactive Mode"], "metadata": {"chunk_id": "guides-python-ibis-006", "document_id": "guides-python-ibis", "position": 6, "token_count": 94, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Interactive Mode"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#interactive-mode"}}
{"chunk_id": "guides-python-ibis-007", "document_id": "guides-python-ibis", "content": "```\n\n```text\n┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃ species ┃ island ┃ bill_length_mm ┃ bill_depth_mm ┃ flipper_length_mm ┃ body_mass_g ┃ sex ┃ year ┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ string │ string │ float64 │ float64 │ int64 │ int64 │ string │ int64 │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ Adelie │ Torgersen │ 39.1 │ 18.7 │ 181 │ 3750 │ male │ 2007 │\n│ Adelie │ Torgersen │ 39.5 │ 17.4 │ 186 │ 3800 │ female │ 2007 │\n│ Adelie │ Torgersen │ 40.3 │ 18.0 │ 195 │ 3250 │ female │ 2007 │\n│ Adelie │ Torgersen │ nan │ nan │ NULL │ NULL │ NULL │ 2007 │\n│ Adelie │ Torgersen │ 36.7 │ 19.3 │ 193 │ 3450 │ female │ 2007 │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n```", "position": 7, "token_count": 197, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-007", "document_id": "guides-python-ibis", "position": 7, "token_count": 197, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-008", "document_id": "guides-python-ibis", "content": "## Common Operations\n\nIbis has a collection of useful table methods to manipulate and query the data in a table.", "position": 8, "token_count": 25, "has_code": false, "section_hierarchy": ["Common Operations"], "metadata": {"chunk_id": "guides-python-ibis-008", "document_id": "guides-python-ibis", "position": 8, "token_count": 25, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Common Operations"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#common-operations"}}
{"chunk_id": "guides-python-ibis-009", "document_id": "guides-python-ibis", "content": "### filter\n\n`filter` allows you to select rows based on a condition or set of conditions.\n\nWe can filter so we only have penguins of the species Adelie:\n\n```python\npenguins.filter(penguins.species == \"Gentoo\")", "position": 9, "token_count": 57, "has_code": true, "section_hierarchy": ["filter"], "metadata": {"chunk_id": "guides-python-ibis-009", "document_id": "guides-python-ibis", "position": 9, "token_count": 57, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["filter"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#filter"}}
{"chunk_id": "guides-python-ibis-010", "document_id": "guides-python-ibis", "content": "```", "position": 10, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-010", "document_id": "guides-python-ibis", "position": 10, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-011", "document_id": "guides-python-ibis", "content": "```text\n┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃ species ┃ island ┃ bill_length_mm ┃ bill_depth_mm ┃ flipper_length_mm ┃ body_mass_g ┃ sex ┃ year ┃\n┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ string │ string │ float64 │ float64 │ int64 │ int64 │ string │ int64 │\n├─────────┼────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ Gentoo │ Biscoe │ 46.1 │ 13.2 │ 211 │ 4500 │ female │ 2007 │\n│ Gentoo │ Biscoe │ 50.0 │ 16.3 │ 230 │ 5700 │ male │ 2007 │\n│ Gentoo │ Biscoe │ 48.7 │ 14.1 │ 210 │ 4450 │ female │ 2007 │\n│ Gentoo │ Biscoe │ 50.0 │ 15.2 │ 218 │ 5700 │ male │ 2007 │\n│ Gentoo │ Biscoe │ 47.6 │ 14.5 │ 215 │ 5400 │ male │ 2007 │", "position": 11, "token_count": 190, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-011", "document_id": "guides-python-ibis", "position": 11, "token_count": 190, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-012", "document_id": "guides-python-ibis", "content": "│ Gentoo │ Biscoe │ 47.6 │ 14.5 │ 215 │ 5400 │ male │ 2007 │\n│ Gentoo │ Biscoe │ 46.5 │ 13.5 │ 210 │ 4550 │ female │ 2007 │\n│ Gentoo │ Biscoe │ 45.4 │ 14.6 │ 211 │ 4800 │ female │ 2007 │\n│ Gentoo │ Biscoe │ 46.7 │ 15.3 │ 219 │ 5200 │ male │ 2007 │\n│ Gentoo │ Biscoe │ 43.3 │ 13.4 │ 209 │ 4400 │ female │ 2007 │\n│ Gentoo │ Biscoe │ 46.8 │ 15.4 │ 215 │ 5150 │ male │ 2007 │\n│ … │ … │ … │ … │ … │ … │ … │ … │\n└─────────┴────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘", "position": 12, "token_count": 170, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-012", "document_id": "guides-python-ibis", "position": 12, "token_count": 170, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-013", "document_id": "guides-python-ibis", "content": "```\n\nOr filter for Gentoo penguins that have a body mass larger than 6 kg.\n\n```python\npenguins.filter((penguins.species == \"Gentoo\") & (penguins.body_mass_g > 6000))\n```\n\n```text\n┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓\n┃ species ┃ island ┃ bill_length_mm ┃ bill_depth_mm ┃ flipper_length_mm ┃ body_mass_g ┃ sex ┃ year ┃\n┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩\n│ string │ string │ float64 │ float64 │ int64 │ int64 │ string │ int64 │\n├─────────┼────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┤\n│ Gentoo │ Biscoe │ 49.2 │ 15.2 │ 221 │ 6300 │ male │ 2007 │\n│ Gentoo │ Biscoe │ 59.6 │ 17.0 │ 230 │ 6050 │ male │ 2007 │\n└─────────┴────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┘\n```\n\nYou can use any Boolean comparison in a filter (although if you try to do something like use `<` on a string, Ibis will yell at you).", "position": 13, "token_count": 210, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-013", "document_id": "guides-python-ibis", "position": 13, "token_count": 210, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-014", "document_id": "guides-python-ibis", "content": "### select\n\nYour data analysis might not require all the columns present in a given table. `select` lets you pick out only those columns that you want to work with.\n\nTo select a column you can use the name of the column as a string:\n\n```python\npenguins.select(\"species\", \"island\", \"year\").limit(3)\n```\n\n```text\n┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━┓\n┃ species ┃ island ┃ year ┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━┩\n│ string │ string │ int64 │\n├─────────┼───────────┼───────┤\n│ Adelie │ Torgersen │ 2007 │\n│ Adelie │ Torgersen │ 2007 │\n│ Adelie │ Torgersen │ 2007 │\n│ … │ … │ … │\n└─────────┴───────────┴───────┘\n```\n\nOr you can use column objects directly (this can be convenient when paired with tab-completion):\n\n```python\npenguins.select(penguins.species, penguins.island, penguins.year).limit(3)", "position": 14, "token_count": 193, "has_code": true, "section_hierarchy": ["select"], "metadata": {"chunk_id": "guides-python-ibis-014", "document_id": "guides-python-ibis", "position": 14, "token_count": 193, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["select"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#select"}}
{"chunk_id": "guides-python-ibis-015", "document_id": "guides-python-ibis", "content": "```\n\nOr you can use column objects directly (this can be convenient when paired with tab-completion):\n\n```python\npenguins.select(penguins.species, penguins.island, penguins.year).limit(3)\n```\n\n```text\n┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━┓\n┃ species ┃ island ┃ year ┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━┩\n│ string │ string │ int64 │\n├─────────┼───────────┼───────┤\n│ Adelie │ Torgersen │ 2007 │\n│ Adelie │ Torgersen │ 2007 │\n│ Adelie │ Torgersen │ 2007 │\n│ … │ … │ … │\n└─────────┴───────────┴───────┘\n```\n\nOr you can mix-and-match:\n\n```python\npenguins.select(\"species\", \"island\", penguins.year).limit(3)\n```\n\n```text\n┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━┓\n┃ species ┃ island ┃ year ┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━┩\n│ string │ string │ int64 │\n├─────────┼───────────┼───────┤\n│ Adelie │ Torgersen │ 2007 │\n│ Adelie │ Torgersen │ 2007 │\n│ Adelie │ Torgersen │ 2007 │\n│ … │ … │ … │\n└─────────┴───────────┴───────┘\n```", "position": 15, "token_count": 222, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-015", "document_id": "guides-python-ibis", "position": 15, "token_count": 222, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-016", "document_id": "guides-python-ibis", "content": "### mutate\n\n`mutate` lets you add new columns to your table, derived from the values of existing columns.\n\n```python\npenguins.mutate(bill_length_cm=penguins.bill_length_mm / 10)", "position": 16, "token_count": 53, "has_code": true, "section_hierarchy": ["mutate"], "metadata": {"chunk_id": "guides-python-ibis-016", "document_id": "guides-python-ibis", "position": 16, "token_count": 53, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["mutate"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#mutate"}}
{"chunk_id": "guides-python-ibis-017", "document_id": "guides-python-ibis", "content": "```", "position": 17, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-017", "document_id": "guides-python-ibis", "position": 17, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-018", "document_id": "guides-python-ibis", "content": "```text\n┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━┓\n┃ species ┃ island ┃ bill_length_mm ┃ bill_depth_mm ┃ flipper_length_mm ┃ body_mass_g ┃ sex ┃ year ┃ bill_length_cm ┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━┩\n│ string │ string │ float64 │ float64 │ int64 │ int64 │ string │ int64 │ float64 │\n├─────────┼───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┼────────────────┤\n│ Adelie │ Torgersen │ 39.1 │ 18.7 │ 181 │ 3750 │ male │ 2007 │ 3.91 │\n│ Adelie │ Torgersen │ 39.5 │ 17.4 │ 186 │ 3800 │ female │ 2007 │ 3.95 │\n│ Adelie │ Torgersen │ 40.3 │ 18.0 │ 195 │ 3250 │ female │ 2007 │ 4.03 │\n│ Adelie │ Torgersen │ nan │ nan │ NULL │ NULL │ NULL │ 2007 │ nan │", "position": 18, "token_count": 187, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-018", "document_id": "guides-python-ibis", "position": 18, "token_count": 187, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-019", "document_id": "guides-python-ibis", "content": "│ Adelie │ Torgersen │ nan │ nan │ NULL │ NULL │ NULL │ 2007 │ nan │\n│ Adelie │ Torgersen │ 36.7 │ 19.3 │ 193 │ 3450 │ female │ 2007 │ 3.67 │\n│ Adelie │ Torgersen │ 39.3 │ 20.6 │ 190 │ 3650 │ male │ 2007 │ 3.93 │\n│ Adelie │ Torgersen │ 38.9 │ 17.8 │ 181 │ 3625 │ female │ 2007 │ 3.89 │\n│ Adelie │ Torgersen │ 39.2 │ 19.6 │ 195 │ 4675 │ male │ 2007 │ 3.92 │\n│ Adelie │ Torgersen │ 34.1 │ 18.1 │ 193 │ 3475 │ NULL │ 2007 │ 3.41 │\n│ Adelie │ Torgersen │ 42.0 │ 20.2 │ 190 │ 4250 │ NULL │ 2007 │ 4.20 │\n│ … │ … │ … │ … │ … │ … │ … │ … │ … │", "position": 19, "token_count": 224, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-019", "document_id": "guides-python-ibis", "position": 19, "token_count": 224, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-020", "document_id": "guides-python-ibis", "content": "│ … │ … │ … │ … │ … │ … │ … │ … │ … │\n└─────────┴───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┴────────────────┘", "position": 20, "token_count": 22, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-020", "document_id": "guides-python-ibis", "position": 20, "token_count": 22, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-021", "document_id": "guides-python-ibis", "content": "```\n\nNotice that the table is a little too wide to display all the columns now (depending on your screen-size). `bill_length` is now present in millimeters _and_ centimeters. Use a `select` to trim down the number of columns we're looking at.\n\n```python\npenguins.mutate(bill_length_cm=penguins.bill_length_mm / 10).select(\n \"species\",\n \"island\",\n \"bill_depth_mm\",\n \"flipper_length_mm\",\n \"body_mass_g\",\n \"sex\",\n \"year\",\n \"bill_length_cm\",\n)", "position": 21, "token_count": 141, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-021", "document_id": "guides-python-ibis", "position": 21, "token_count": 141, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-022", "document_id": "guides-python-ibis", "content": "```", "position": 22, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-022", "document_id": "guides-python-ibis", "position": 22, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-023", "document_id": "guides-python-ibis", "content": "```text\n┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━┓\n┃ species ┃ island ┃ bill_depth_mm ┃ flipper_length_mm ┃ body_mass_g ┃ sex ┃ year ┃ bill_length_cm ┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━┩\n│ string │ string │ float64 │ int64 │ int64 │ string │ int64 │ float64 │\n├─────────┼───────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┼────────────────┤\n│ Adelie │ Torgersen │ 18.7 │ 181 │ 3750 │ male │ 2007 │ 3.91 │\n│ Adelie │ Torgersen │ 17.4 │ 186 │ 3800 │ female │ 2007 │ 3.95 │\n│ Adelie │ Torgersen │ 18.0 │ 195 │ 3250 │ female │ 2007 │ 4.03 │\n│ Adelie │ Torgersen │ nan │ NULL │ NULL │ NULL │ 2007 │ nan │\n│ Adelie │ Torgersen │ 19.3 │ 193 │ 3450 │ female │ 2007 │ 3.67 │", "position": 23, "token_count": 190, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-023", "document_id": "guides-python-ibis", "position": 23, "token_count": 190, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-024", "document_id": "guides-python-ibis", "content": "│ Adelie │ Torgersen │ 19.3 │ 193 │ 3450 │ female │ 2007 │ 3.67 │\n│ Adelie │ Torgersen │ 20.6 │ 190 │ 3650 │ male │ 2007 │ 3.93 │\n│ Adelie │ Torgersen │ 17.8 │ 181 │ 3625 │ female │ 2007 │ 3.89 │\n│ Adelie │ Torgersen │ 19.6 │ 195 │ 4675 │ male │ 2007 │ 3.92 │\n│ Adelie │ Torgersen │ 18.1 │ 193 │ 3475 │ NULL │ 2007 │ 3.41 │\n│ Adelie │ Torgersen │ 20.2 │ 190 │ 4250 │ NULL │ 2007 │ 4.20 │\n│ … │ … │ … │ … │ … │ … │ … │ … │\n└─────────┴───────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┴────────────────┘", "position": 24, "token_count": 176, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-024", "document_id": "guides-python-ibis", "position": 24, "token_count": 176, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-025", "document_id": "guides-python-ibis", "content": "```", "position": 25, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-025", "document_id": "guides-python-ibis", "position": 25, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-026", "document_id": "guides-python-ibis", "content": "### selectors\n\nTyping out _all_ of the column names _except_ one is a little annoying. Instead of doing that again, we can use a `selector` to quickly select or deselect groups of columns.\n\n```python\nimport ibis.selectors as s\n\npenguins.mutate(bill_length_cm=penguins.bill_length_mm / 10).select(\n ~s.matches(\"bill_length_mm\")\n # match every column except `bill_length_mm`\n)", "position": 26, "token_count": 111, "has_code": true, "section_hierarchy": ["selectors"], "metadata": {"chunk_id": "guides-python-ibis-026", "document_id": "guides-python-ibis", "position": 26, "token_count": 111, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["selectors"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#selectors"}}
{"chunk_id": "guides-python-ibis-027", "document_id": "guides-python-ibis", "content": "```", "position": 27, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-027", "document_id": "guides-python-ibis", "position": 27, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-028", "document_id": "guides-python-ibis", "content": "```text\n┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━┓\n┃ species ┃ island ┃ bill_depth_mm ┃ flipper_length_mm ┃ body_mass_g ┃ sex ┃ year ┃ bill_length_cm ┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━┩\n│ string │ string │ float64 │ int64 │ int64 │ string │ int64 │ float64 │\n├─────────┼───────────┼───────────────┼───────────────────┼─────────────┼────────┼───────┼────────────────┤\n│ Adelie │ Torgersen │ 18.7 │ 181 │ 3750 │ male │ 2007 │ 3.91 │\n│ Adelie │ Torgersen │ 17.4 │ 186 │ 3800 │ female │ 2007 │ 3.95 │\n│ Adelie │ Torgersen │ 18.0 │ 195 │ 3250 │ female │ 2007 │ 4.03 │\n│ Adelie │ Torgersen │ nan │ NULL │ NULL │ NULL │ 2007 │ nan │\n│ Adelie │ Torgersen │ 19.3 │ 193 │ 3450 │ female │ 2007 │ 3.67 │", "position": 28, "token_count": 190, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-028", "document_id": "guides-python-ibis", "position": 28, "token_count": 190, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-029", "document_id": "guides-python-ibis", "content": "│ Adelie │ Torgersen │ 19.3 │ 193 │ 3450 │ female │ 2007 │ 3.67 │\n│ Adelie │ Torgersen │ 20.6 │ 190 │ 3650 │ male │ 2007 │ 3.93 │\n│ Adelie │ Torgersen │ 17.8 │ 181 │ 3625 │ female │ 2007 │ 3.89 │\n│ Adelie │ Torgersen │ 19.6 │ 195 │ 4675 │ male │ 2007 │ 3.92 │\n│ Adelie │ Torgersen │ 18.1 │ 193 │ 3475 │ NULL │ 2007 │ 3.41 │\n│ Adelie │ Torgersen │ 20.2 │ 190 │ 4250 │ NULL │ 2007 │ 4.20 │\n│ … │ … │ … │ … │ … │ … │ … │ … │\n└─────────┴───────────┴───────────────┴───────────────────┴─────────────┴────────┴───────┴────────────────┘", "position": 29, "token_count": 176, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-029", "document_id": "guides-python-ibis", "position": 29, "token_count": 176, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-030", "document_id": "guides-python-ibis", "content": "```\n\nYou can also use a `selector` alongside a column name.\n\n```python\npenguins.select(\"island\", s.numeric())", "position": 30, "token_count": 37, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-030", "document_id": "guides-python-ibis", "position": 30, "token_count": 37, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-031", "document_id": "guides-python-ibis", "content": "```", "position": 31, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-031", "document_id": "guides-python-ibis", "position": 31, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-032", "document_id": "guides-python-ibis", "content": "```text\n┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━┓\n┃ island ┃ bill_length_mm ┃ bill_depth_mm ┃ flipper_length_mm ┃ body_mass_g ┃ year ┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━┩\n│ string │ float64 │ float64 │ int64 │ int64 │ int64 │\n├───────────┼────────────────┼───────────────┼───────────────────┼─────────────┼───────┤\n│ Torgersen │ 39.1 │ 18.7 │ 181 │ 3750 │ 2007 │\n│ Torgersen │ 39.5 │ 17.4 │ 186 │ 3800 │ 2007 │\n│ Torgersen │ 40.3 │ 18.0 │ 195 │ 3250 │ 2007 │\n│ Torgersen │ nan │ nan │ NULL │ NULL │ 2007 │\n│ Torgersen │ 36.7 │ 19.3 │ 193 │ 3450 │ 2007 │\n│ Torgersen │ 39.3 │ 20.6 │ 190 │ 3650 │ 2007 │\n│ Torgersen │ 38.9 │ 17.8 │ 181 │ 3625 │ 2007 │", "position": 32, "token_count": 192, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-032", "document_id": "guides-python-ibis", "position": 32, "token_count": 192, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-033", "document_id": "guides-python-ibis", "content": "│ Torgersen │ 39.3 │ 20.6 │ 190 │ 3650 │ 2007 │\n│ Torgersen │ 38.9 │ 17.8 │ 181 │ 3625 │ 2007 │\n│ Torgersen │ 39.2 │ 19.6 │ 195 │ 4675 │ 2007 │\n│ Torgersen │ 34.1 │ 18.1 │ 193 │ 3475 │ 2007 │\n│ Torgersen │ 42.0 │ 20.2 │ 190 │ 4250 │ 2007 │\n│ … │ … │ … │ … │ … │ … │\n└───────────┴────────────────┴───────────────┴───────────────────┴─────────────┴───────┘", "position": 33, "token_count": 116, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-033", "document_id": "guides-python-ibis", "position": 33, "token_count": 116, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-034", "document_id": "guides-python-ibis", "content": "```\n\nYou can read more about [`selectors`](https://ibis-project.org/reference/selectors/) in the docs!", "position": 34, "token_count": 39, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-034", "document_id": "guides-python-ibis", "position": 34, "token_count": 39, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-035", "document_id": "guides-python-ibis", "content": "### `order_by`\n\n`order_by` arranges the values of one or more columns in ascending or descending order.\n\nBy default, `ibis` sorts in ascending order:\n\n```python\npenguins.order_by(penguins.flipper_length_mm).select(\n \"species\", \"island\", \"flipper_length_mm\"\n)\n```\n\n```text\n┏━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓\n┃ species ┃ island ┃ flipper_length_mm ┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩\n│ string │ string │ int64 │\n├───────────┼───────────┼───────────────────┤\n│ Adelie │ Biscoe │ 172 │\n│ Adelie │ Biscoe │ 174 │\n│ Adelie │ Torgersen │ 176 │\n│ Adelie │ Dream │ 178 │\n│ Adelie │ Dream │ 178 │\n│ Adelie │ Dream │ 178 │\n│ Chinstrap │ Dream │ 178 │\n│ Adelie │ Dream │ 179 │\n│ Adelie │ Torgersen │ 180 │\n│ Adelie │ Biscoe │ 180 │\n│ … │ … │ … │\n└───────────┴───────────┴───────────────────┘", "position": 35, "token_count": 216, "has_code": true, "section_hierarchy": ["`order_by`"], "metadata": {"chunk_id": "guides-python-ibis-035", "document_id": "guides-python-ibis", "position": 35, "token_count": 216, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`order_by`"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#orderby"}}
{"chunk_id": "guides-python-ibis-036", "document_id": "guides-python-ibis", "content": "```\n\nYou can sort in descending order using the `desc` method of a column:\n\n```python\npenguins.order_by(penguins.flipper_length_mm.desc()).select(\n \"species\", \"island\", \"flipper_length_mm\"\n)\n```\n\n```text\n┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓\n┃ species ┃ island ┃ flipper_length_mm ┃\n┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩\n│ string │ string │ int64 │\n├─────────┼────────┼───────────────────┤\n│ Gentoo │ Biscoe │ 231 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 229 │\n│ Gentoo │ Biscoe │ 229 │\n│ … │ … │ … │\n└─────────┴────────┴───────────────────┘", "position": 36, "token_count": 204, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-036", "document_id": "guides-python-ibis", "position": 36, "token_count": 204, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-037", "document_id": "guides-python-ibis", "content": "```\n\nOr you can use `ibis.desc`\n\n```python\npenguins.order_by(ibis.desc(\"flipper_length_mm\")).select(\n \"species\", \"island\", \"flipper_length_mm\"\n)\n```\n\n```text\n┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓\n┃ species ┃ island ┃ flipper_length_mm ┃\n┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩\n│ string │ string │ int64 │\n├─────────┼────────┼───────────────────┤\n│ Gentoo │ Biscoe │ 231 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 230 │\n│ Gentoo │ Biscoe │ 229 │\n│ Gentoo │ Biscoe │ 229 │\n│ … │ … │ … │\n└─────────┴────────┴───────────────────┘\n```", "position": 37, "token_count": 203, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-037", "document_id": "guides-python-ibis", "position": 37, "token_count": 203, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-038", "document_id": "guides-python-ibis", "content": "### aggregate\n\nIbis has several aggregate functions available to help summarize data.\n\n`mean`, `max`, `min`, `count`, `sum` (the list goes on).\n\nTo aggregate an entire column, call the corresponding method on that column.\n\n```python\npenguins.flipper_length_mm.mean()\n```\n\n```python", "position": 38, "token_count": 83, "has_code": true, "section_hierarchy": ["aggregate"], "metadata": {"chunk_id": "guides-python-ibis-038", "document_id": "guides-python-ibis", "position": 38, "token_count": 83, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["aggregate"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#aggregate"}}
{"chunk_id": "guides-python-ibis-039", "document_id": "guides-python-ibis", "content": "# Output:\n200.91520467836258\n```\n\nYou can compute multiple aggregates at once using the `aggregate` method:\n\n```python\npenguins.aggregate([penguins.flipper_length_mm.mean(), penguins.bill_depth_mm.max()])\n```\n\n```text\n┏━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓\n┃ Mean(flipper_length_mm) ┃ Max(bill_depth_mm) ┃\n┡━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩\n│ float64 │ float64 │\n├─────────────────────────┼────────────────────┤\n│ 200.915205 │ 21.5 │\n└─────────────────────────┴────────────────────┘\n```\n\nBut `aggregate` _really_ shines when it's paired with `group_by`.", "position": 39, "token_count": 143, "has_code": true, "section_hierarchy": ["Output:"], "metadata": {"chunk_id": "guides-python-ibis-039", "document_id": "guides-python-ibis", "position": 39, "token_count": 143, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Output:"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#output"}}
{"chunk_id": "guides-python-ibis-040", "document_id": "guides-python-ibis", "content": "### `group_by`\n\n`group_by` creates groupings of rows that have the same value for one or more columns.\n\nBut it doesn't do much on its own -- you can pair it with `aggregate` to get a result.\n\n```python\npenguins.group_by(\"species\").aggregate()\n```\n\n```text\n┏━━━━━━━━━━━┓\n┃ species ┃\n┡━━━━━━━━━━━┩\n│ string │\n├───────────┤\n│ Adelie │\n│ Gentoo │\n│ Chinstrap │\n└───────────┘\n```\n\nWe grouped by the `species` column and handed it an “empty” aggregate command. The result of that is a column of the unique values in the `species` column.\n\nIf we add a second column to the `group_by`, we'll get each unique pairing of the values in those columns.\n\n```python\npenguins.group_by([\"species\", \"island\"]).aggregate()", "position": 40, "token_count": 197, "has_code": true, "section_hierarchy": ["`group_by`"], "metadata": {"chunk_id": "guides-python-ibis-040", "document_id": "guides-python-ibis", "position": 40, "token_count": 197, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`group_by`"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#groupby"}}
{"chunk_id": "guides-python-ibis-041", "document_id": "guides-python-ibis", "content": "```\n\n```text\n┏━━━━━━━━━━━┳━━━━━━━━━━━┓\n┃ species ┃ island ┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━┩\n│ string │ string │\n├───────────┼───────────┤\n│ Adelie │ Torgersen │\n│ Adelie │ Biscoe │\n│ Adelie │ Dream │\n│ Gentoo │ Biscoe │\n│ Chinstrap │ Dream │\n└───────────┴───────────┘\n```\n\nNow, if we add an aggregation function to that, we start to really open things up.\n\n```python\npenguins.group_by([\"species\", \"island\"]).aggregate(penguins.bill_length_mm.mean())\n```\n\n```text\n┏━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┓\n┃ species ┃ island ┃ Mean(bill_length_mm) ┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━┩\n│ string │ string │ float64 │\n├───────────┼───────────┼──────────────────────┤\n│ Adelie │ Torgersen │ 38.950980 │\n│ Adelie │ Biscoe │ 38.975000 │\n│ Adelie │ Dream │ 38.501786 │\n│ Gentoo │ Biscoe │ 47.504878 │\n│ Chinstrap │ Dream │ 48.833824 │\n└───────────┴───────────┴──────────────────────┘", "position": 41, "token_count": 222, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-041", "document_id": "guides-python-ibis", "position": 41, "token_count": 222, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-042", "document_id": "guides-python-ibis", "content": "```\n\nBy adding that `mean` to the `aggregate`, we now have a concise way to calculate aggregates over each of the distinct groups in the `group_by`. And we can calculate as many aggregates as we need.\n\n```python\npenguins.group_by([\"species\", \"island\"]).aggregate(\n [penguins.bill_length_mm.mean(), penguins.flipper_length_mm.max()]\n)\n```\n\n```text\n┏━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃ species ┃ island ┃ Mean(bill_length_mm) ┃ Max(flipper_length_mm) ┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ string │ string │ float64 │ int64 │\n├───────────┼───────────┼──────────────────────┼────────────────────────┤\n│ Adelie │ Torgersen │ 38.950980 │ 210 │\n│ Adelie │ Biscoe │ 38.975000 │ 203 │\n│ Adelie │ Dream │ 38.501786 │ 208 │\n│ Gentoo │ Biscoe │ 47.504878 │ 231 │\n│ Chinstrap │ Dream │ 48.833824 │ 212 │\n└───────────┴───────────┴──────────────────────┴────────────────────────┘", "position": 42, "token_count": 230, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-042", "document_id": "guides-python-ibis", "position": 42, "token_count": 230, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-043", "document_id": "guides-python-ibis", "content": "```\n\nIf we need more specific groups, we can add to the `group_by`.\n\n```python\npenguins.group_by([\"species\", \"island\", \"sex\"]).aggregate(\n [penguins.bill_length_mm.mean(), penguins.flipper_length_mm.max()]\n)", "position": 43, "token_count": 77, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-043", "document_id": "guides-python-ibis", "position": 43, "token_count": 77, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-044", "document_id": "guides-python-ibis", "content": "```\n\n```text\n┏━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃ species ┃ island ┃ sex ┃ Mean(bill_length_mm) ┃ Max(flipper_length_mm) ┃\n┡━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ string │ string │ string │ float64 │ int64 │\n├─────────┼───────────┼────────┼──────────────────────┼────────────────────────┤\n│ Adelie │ Torgersen │ male │ 40.586957 │ 210 │\n│ Adelie │ Torgersen │ female │ 37.554167 │ 196 │\n│ Adelie │ Torgersen │ NULL │ 37.925000 │ 193 │\n│ Adelie │ Biscoe │ female │ 37.359091 │ 199 │\n│ Adelie │ Biscoe │ male │ 40.590909 │ 203 │\n│ Adelie │ Dream │ female │ 36.911111 │ 202 │\n│ Adelie │ Dream │ male │ 40.071429 │ 208 │\n│ Adelie │ Dream │ NULL │ 37.500000 │ 179 │\n│ Gentoo │ Biscoe │ female │ 45.563793 │ 222 │\n│ Gentoo │ Biscoe │ male │ 49.473770 │ 231 │\n│ … │ … │ … │ … │ … │\n└─────────┴───────────┴────────┴──────────────────────┴────────────────────────┘\n```", "position": 44, "token_count": 249, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-044", "document_id": "guides-python-ibis", "position": 44, "token_count": 249, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-045", "document_id": "guides-python-ibis", "content": "## Chaining It All Together\n\nWe've already chained some Ibis calls together. We used `mutate` to create a new column and then `select` to only view a subset of the new table. We were just chaining `group_by` with `aggregate`.\n\nThere's nothing stopping us from putting all of these concepts together to ask questions of the data.\n\nHow about:\n\n* What was the largest female penguin (by body mass) on each island in the year 2008?\n\n```python\npenguins.filter((penguins.sex == \"female\") & (penguins.year == 2008)).group_by(\n [\"island\"]\n).aggregate(penguins.body_mass_g.max())\n```\n\n```text\n┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓\n┃ island ┃ Max(body_mass_g) ┃\n┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩\n│ string │ int64 │\n├───────────┼──────────────────┤\n│ Biscoe │ 5200 │\n│ Torgersen │ 3800 │\n│ Dream │ 3900 │\n└───────────┴──────────────────┘", "position": 45, "token_count": 208, "has_code": true, "section_hierarchy": ["Chaining It All Together"], "metadata": {"chunk_id": "guides-python-ibis-045", "document_id": "guides-python-ibis", "position": 45, "token_count": 208, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Chaining It All Together"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#chaining-it-all-together"}}
{"chunk_id": "guides-python-ibis-046", "document_id": "guides-python-ibis", "content": "```\n\n* What about the largest male penguin (by body mass) on each island for each year of data collection?\n\n```python\npenguins.filter(penguins.sex == \"male\").group_by([\"island\", \"year\"]).aggregate(\n penguins.body_mass_g.max().name(\"max_body_mass\")\n).order_by([\"year\", \"max_body_mass\"])\n```\n\n```text\n┏━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━┓\n┃ island ┃ year ┃ max_body_mass ┃\n┡━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━┩\n│ string │ int64 │ int64 │\n├───────────┼───────┼───────────────┤\n│ Dream │ 2007 │ 4650 │\n│ Torgersen │ 2007 │ 4675 │\n│ Biscoe │ 2007 │ 6300 │\n│ Torgersen │ 2008 │ 4700 │\n│ Dream │ 2008 │ 4800 │\n│ Biscoe │ 2008 │ 6000 │\n│ Torgersen │ 2009 │ 4300 │\n│ Dream │ 2009 │ 4475 │\n│ Biscoe │ 2009 │ 6000 │\n└───────────┴───────┴───────────────┘\n```", "position": 46, "token_count": 217, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-ibis-046", "document_id": "guides-python-ibis", "position": 46, "token_count": 217, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis"}}
{"chunk_id": "guides-python-ibis-047", "document_id": "guides-python-ibis", "content": "## Learn More\n\nThat's all for this quick-start guide. If you want to learn more, check out the [Ibis documentation](https://ibis-project.org).", "position": 47, "token_count": 45, "has_code": false, "section_hierarchy": ["Learn More"], "metadata": {"chunk_id": "guides-python-ibis-047", "document_id": "guides-python-ibis", "position": 47, "token_count": 45, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Learn More"], "file_path": "guides/python/ibis.md", "url": "/guides/python/ibis", "title": "Integration with Ibis", "category": null, "tags": [], "section_url": "/guides/python/ibis#learn-more"}}

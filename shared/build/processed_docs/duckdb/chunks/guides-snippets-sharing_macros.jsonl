{"chunk_id": "guides-snippets-sharing_macros-000", "document_id": "guides-snippets-sharing_macros", "content": "DuckDB has a powerful [macro mechanism]({% link docs/stable/sql/statements/create_macro.md %}) that allows creating shorthands for common tasks.", "position": 0, "token_count": 42, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-sharing_macros-000", "document_id": "guides-snippets-sharing_macros", "position": 0, "token_count": 42, "has_code": false, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "guides/snippets/sharing_macros.md", "url": "/guides/snippets/sharing_macros", "title": "Sharing Macros", "category": null, "tags": [], "section_url": "/guides/snippets/sharing_macros"}}
{"chunk_id": "guides-snippets-sharing_macros-001", "document_id": "guides-snippets-sharing_macros", "content": "## Sharing a Scalar Macro\n\nFirst, we defined a macro that pretty-prints a non-negative integer as a short string with thousands, millions, and billions (without rounding) as follows:\n\n```batch\nduckdb pretty_print_integer_macro.duckdb\n```\n\n```sql\nCREATE MACRO pretty_print_integer(n) AS\n CASE\n WHEN n >= 1_000_000_000 THEN printf('%dB', n // 1_000_000_000)\n WHEN n >= 1_000_000 THEN printf('%dM', n // 1_000_000)\n WHEN n >= 1_000 THEN printf('%dk', n // 1_000)\n ELSE printf('%d', n)\n END;\n\nSELECT pretty_print_integer(25_500_000) AS x;\n```\n\n```text\n┌─────────┐\n│ x │\n│ varchar │\n├─────────┤\n│ 25M │\n└─────────┘", "position": 1, "token_count": 211, "has_code": true, "section_hierarchy": ["Sharing a Scalar Macro"], "metadata": {"chunk_id": "guides-snippets-sharing_macros-001", "document_id": "guides-snippets-sharing_macros", "position": 1, "token_count": 211, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Sharing a Scalar Macro"], "file_path": "guides/snippets/sharing_macros.md", "url": "/guides/snippets/sharing_macros", "title": "Sharing Macros", "category": null, "tags": [], "section_url": "/guides/snippets/sharing_macros#sharing-a-scalar-macro"}}
{"chunk_id": "guides-snippets-sharing_macros-002", "document_id": "guides-snippets-sharing_macros", "content": "```\n\n```text\n┌─────────┐\n│ x │\n│ varchar │\n├─────────┤\n│ 25M │\n└─────────┘\n```\n\nAs one would expect, the macro gets persisted in the database.\nBut this also means that we can host it on an HTTPS endpoint and share it with anyone!\nWe have published this macro on `blobs.duckdb.org`.\n\nYou can try it from DuckDB:\n\n```batch\nduckdb\n```\n\nMake sure that the [`httpfs` extension]({% link docs/stable/core_extensions/httpfs/overview.md %}) is installed:\n\n```sql\nINSTALL httpfs;\n```\n\nYou can now attach to the remote endpoint and use the macro:\n\n```sql\nATTACH 'https://blobs.duckdb.org/data/pretty_print_integer_macro.duckdb'\n AS pretty_print_macro_db;\n\nSELECT pretty_print_macro_db.pretty_print_integer(42_123) AS x;\n```\n\n```text\n┌─────────┐\n│ x │\n│ varchar │\n├─────────┤\n│ 42k │\n└─────────┘", "position": 2, "token_count": 240, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-sharing_macros-002", "document_id": "guides-snippets-sharing_macros", "position": 2, "token_count": 240, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/sharing_macros.md", "url": "/guides/snippets/sharing_macros", "title": "Sharing Macros", "category": null, "tags": [], "section_url": "/guides/snippets/sharing_macros"}}
{"chunk_id": "guides-snippets-sharing_macros-003", "document_id": "guides-snippets-sharing_macros", "content": "```\n\n```text\n┌─────────┐\n│ x │\n│ varchar │\n├─────────┤\n│ 42k │\n└─────────┘\n```", "position": 3, "token_count": 27, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-sharing_macros-003", "document_id": "guides-snippets-sharing_macros", "position": 3, "token_count": 27, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/sharing_macros.md", "url": "/guides/snippets/sharing_macros", "title": "Sharing Macros", "category": null, "tags": [], "section_url": "/guides/snippets/sharing_macros"}}
{"chunk_id": "guides-snippets-sharing_macros-004", "document_id": "guides-snippets-sharing_macros", "content": "## Sharing a Table Macro\n\nIt's also possible to share table macros. For example, we created the [`checksum` macro]({% post_url 2024-10-11-duckdb-tricks-part-2 %}#computing-checksums-for-columns) as follows:\n\n```batch\nduckdb compute_table_checksum.duckdb\n```\n\n```sql\nCREATE MACRO checksum(table_name) AS TABLE\n SELECT bit_xor(md5_number(COLUMNS(*)::VARCHAR))\n FROM query_table(table_name);\n```\n\nTo use it, make sure that the [`httpfs` extension]({% link docs/stable/core_extensions/httpfs/overview.md %}) is installed:\n\n```sql\nINSTALL httpfs;", "position": 4, "token_count": 185, "has_code": true, "section_hierarchy": ["Sharing a Table Macro"], "metadata": {"chunk_id": "guides-snippets-sharing_macros-004", "document_id": "guides-snippets-sharing_macros", "position": 4, "token_count": 185, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Sharing a Table Macro"], "file_path": "guides/snippets/sharing_macros.md", "url": "/guides/snippets/sharing_macros", "title": "Sharing Macros", "category": null, "tags": [], "section_url": "/guides/snippets/sharing_macros#sharing-a-table-macro"}}
{"chunk_id": "guides-snippets-sharing_macros-005", "document_id": "guides-snippets-sharing_macros", "content": "```\n\nYou can attach to the remote endpoint and use the macro:\n\n```sql\nATTACH 'https://blobs.duckdb.org/data/compute_table_checksum.duckdb'\n AS compute_table_checksum_db;\n\nCREATE TABLE stations AS\n FROM 'https://blobs.duckdb.org/stations.parquet';\n\n.mode line\nFROM compute_table_checksum_db.checksum('stations');", "position": 5, "token_count": 105, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-sharing_macros-005", "document_id": "guides-snippets-sharing_macros", "position": 5, "token_count": 105, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/sharing_macros.md", "url": "/guides/snippets/sharing_macros", "title": "Sharing Macros", "category": null, "tags": [], "section_url": "/guides/snippets/sharing_macros"}}
{"chunk_id": "guides-snippets-sharing_macros-006", "document_id": "guides-snippets-sharing_macros", "content": "```", "position": 6, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-sharing_macros-006", "document_id": "guides-snippets-sharing_macros", "position": 6, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/sharing_macros.md", "url": "/guides/snippets/sharing_macros", "title": "Sharing Macros", "category": null, "tags": [], "section_url": "/guides/snippets/sharing_macros"}}
{"chunk_id": "guides-snippets-sharing_macros-007", "document_id": "guides-snippets-sharing_macros", "content": "```text\n id = -132780776949939723506211681506129908318\n code = 126327004005066229305810236187733612209\n uic = -145623335062491121476006068124745817380\n name_short = -114540917565721687000878144381189869683\nname_medium = -568264780518431562127359918655305384\n name_long = 126079956280724674884063510870679874110\n slug = -53458800462031706622213217090663245511", "position": 7, "token_count": 199, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-sharing_macros-007", "document_id": "guides-snippets-sharing_macros", "position": 7, "token_count": 199, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/sharing_macros.md", "url": "/guides/snippets/sharing_macros", "title": "Sharing Macros", "category": null, "tags": [], "section_url": "/guides/snippets/sharing_macros"}}
{"chunk_id": "guides-snippets-sharing_macros-008", "document_id": "guides-snippets-sharing_macros", "content": "slug = -53458800462031706622213217090663245511\n country = 143068442936912051858689770843609587944\n type = 5665662315470785456147400604088879751\n geo_lat = 160608116135251821259126521573759502306\n geo_lng = -138297281072655463682926723171691547732\n```", "position": 8, "token_count": 136, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-sharing_macros-008", "document_id": "guides-snippets-sharing_macros", "position": 8, "token_count": 136, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/sharing_macros.md", "url": "/guides/snippets/sharing_macros", "title": "Sharing Macros", "category": null, "tags": [], "section_url": "/guides/snippets/sharing_macros"}}

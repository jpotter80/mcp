{"chunk_id": "sql-statements-alter_table-000", "document_id": "sql-statements-alter_table", "content": "The `ALTER TABLE` statement changes the schema of an existing table in the catalog.", "position": 0, "token_count": 20, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-statements-alter_table-000", "document_id": "sql-statements-alter_table", "position": 0, "token_count": 20, "has_code": false, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table"}}
{"chunk_id": "sql-statements-alter_table-001", "document_id": "sql-statements-alter_table", "content": "## Examples\n\n```sql\nCREATE TABLE integers (i INTEGER, j INTEGER);\n```\n\nAdd a new column with name `k` to the table `integers`, it will be filled with the default value `NULL`:\n\n```sql\nALTER TABLE integers\nADD COLUMN k INTEGER;\n```\n\nAdd a new column with name `l` to the table integers, it will be filled with the default value 10:\n\n```sql\nALTER TABLE integers\nADD COLUMN l INTEGER DEFAULT 10;\n```\n\nDrop the column `k` from the table integers:\n\n```sql\nALTER TABLE integers\nDROP k;\n```\n\nChange the type of the column `i` to the type `VARCHAR` using a standard cast:\n\n```sql\nALTER TABLE integers\nALTER i TYPE VARCHAR;\n```\n\nChange the type of the column `i` to the type `VARCHAR`, using the specified expression to convert the data for each row:\n\n```sql\nALTER TABLE integers\nALTER i SET DATA TYPE VARCHAR USING concat(i, '_', j);", "position": 1, "token_count": 228, "has_code": true, "section_hierarchy": ["Examples"], "metadata": {"chunk_id": "sql-statements-alter_table-001", "document_id": "sql-statements-alter_table", "position": 1, "token_count": 228, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Examples"], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table#examples"}}
{"chunk_id": "sql-statements-alter_table-002", "document_id": "sql-statements-alter_table", "content": "```\n\nSet the default value of a column:\n\n```sql\nALTER TABLE integers\nALTER COLUMN i SET DEFAULT 10;\n```\n\nDrop the default value of a column:\n\n```sql\nALTER TABLE integers\nALTER COLUMN i DROP DEFAULT;\n```\n\nMake a column not nullable:\n\n```sql\nALTER TABLE integers\nALTER COLUMN i SET NOT NULL;\n```\n\nDrop the not-`NULL` constraint:\n\n```sql\nALTER TABLE integers\nALTER COLUMN i DROP NOT NULL;\n```\n\nRename a table:\n\n```sql\nALTER TABLE integers\nRENAME TO integers_old;\n```\n\nRename a column of a table:\n\n```sql\nALTER TABLE integers\nRENAME i TO ii;\n```\n\nAdd a primary key to a column of a table:\n\n```sql\nALTER TABLE integers\nADD PRIMARY KEY (i);\n```", "position": 2, "token_count": 178, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-statements-alter_table-002", "document_id": "sql-statements-alter_table", "position": 2, "token_count": 178, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table"}}
{"chunk_id": "sql-statements-alter_table-003", "document_id": "sql-statements-alter_table", "content": "## Syntax\n\n`ALTER TABLE` changes the schema of an existing table.\nAll the changes made by `ALTER TABLE` fully respect the transactional semantics, i.e., they will not be visible to other transactions until committed, and can be fully reverted through a rollback.\n\n## `RENAME TABLE`\n\nRename a table:\n\n```sql\nALTER TABLE integers\nRENAME TO integers_old;\n```\n\nThe `RENAME TO` clause renames an entire table, changing its name in the schema. Note that any views that rely on the table are **not** automatically updated.", "position": 3, "token_count": 129, "has_code": true, "section_hierarchy": ["`RENAME TABLE`"], "metadata": {"chunk_id": "sql-statements-alter_table-003", "document_id": "sql-statements-alter_table", "position": 3, "token_count": 129, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`RENAME TABLE`"], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table#rename-table"}}
{"chunk_id": "sql-statements-alter_table-004", "document_id": "sql-statements-alter_table", "content": "## `RENAME COLUMN`\n\nTo rename a column of a table, use the `RENAME` or `RENAME COLUMN` clauses:\n\n```sql\nALTER TABLE integers\nRENAME COLUMN i TO j;\n```\n\n```sql\nALTER TABLE integers\nRENAME i TO j;\n```\n\nThe `RENAME [COLUMN]` clause renames a single column within a table. Any constraints that rely on this name (e.g., `CHECK` constraints) are automatically updated. However, note that any views that rely on this column name are **not** automatically updated.", "position": 4, "token_count": 127, "has_code": true, "section_hierarchy": ["`RENAME COLUMN`"], "metadata": {"chunk_id": "sql-statements-alter_table-004", "document_id": "sql-statements-alter_table", "position": 4, "token_count": 127, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`RENAME COLUMN`"], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table#rename-column"}}
{"chunk_id": "sql-statements-alter_table-005", "document_id": "sql-statements-alter_table", "content": "## `ADD COLUMN`\n\nTo add a column of a table, use the `ADD` or `ADD COLUMN` clauses.\n\nE.g., to add a new column with name `k` to the table `integers`, it will be filled with the default value `NULL`:\n\n```sql\nALTER TABLE integers\nADD COLUMN k INTEGER;\n```\n\nOr:\n\n```sql\nALTER TABLE integers\nADD k INTEGER;\n```\n\nAdd a new column with name `l` to the table integers, it will be filled with the default value 10:\n\n```sql\nALTER TABLE integers\nADD COLUMN l INTEGER DEFAULT 10;\n```\n\nThe `ADD [COLUMN]` clause can be used to add a new column of a specified type to a table. The new column will be filled with the specified default value, or `NULL` if none is specified.", "position": 5, "token_count": 179, "has_code": true, "section_hierarchy": ["`ADD COLUMN`"], "metadata": {"chunk_id": "sql-statements-alter_table-005", "document_id": "sql-statements-alter_table", "position": 5, "token_count": 179, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`ADD COLUMN`"], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table#add-column"}}
{"chunk_id": "sql-statements-alter_table-006", "document_id": "sql-statements-alter_table", "content": "## `DROP COLUMN`\n\nTo drop a column of a table, use the `DROP` or `DROP COLUMN` clause:\n\nE.g., to drop the column `k` from the table `integers`:\n\n```sql\nALTER TABLE integers\nDROP COLUMN k;\n```\n\nOr:\n\n```sql\nALTER TABLE integers\nDROP k;\n```\n\nThe `DROP [COLUMN]` clause can be used to remove a column from a table. Note that columns can only be removed if they do not have any indexes that rely on them. This includes any indexes created as part of a `PRIMARY KEY` or `UNIQUE` constraint. Columns that are part of multi-column check constraints cannot be dropped either.\nIf you attempt to drop a column with an index on it, DuckDB will return the following error message:\n\n```console\nDependency Error:\nCannot alter entry \"...\" because there are entries that depend on it.\n```", "position": 6, "token_count": 199, "has_code": true, "section_hierarchy": ["`DROP COLUMN`"], "metadata": {"chunk_id": "sql-statements-alter_table-006", "document_id": "sql-statements-alter_table", "position": 6, "token_count": 199, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`DROP COLUMN`"], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table#drop-column"}}
{"chunk_id": "sql-statements-alter_table-007", "document_id": "sql-statements-alter_table", "content": "## `[SET [DATA]] TYPE`\n\nChange the type of the column `i` to the type `VARCHAR` using a standard cast:\n\n```sql\nALTER TABLE integers\nALTER i TYPE VARCHAR;\n```\n\n> Instead of\n> `ALTER ⟨column_name⟩ TYPE ⟨type⟩`{:.language-sql .highlight}, you can also use the equivalent\n> `ALTER ⟨column_name⟩ SET TYPE ⟨type⟩`{:.language-sql .highlight} and the\n> `ALTER ⟨column_name⟩ SET DATA TYPE ⟨type⟩`{:.language-sql .highlight} clauses.\n\nChange the type of the column `i` to the type `VARCHAR`, using the specified expression to convert the data for each row:\n\n```sql\nALTER TABLE integers\nALTER i SET DATA TYPE VARCHAR USING concat(i, '_', j);", "position": 7, "token_count": 193, "has_code": true, "section_hierarchy": ["`[SET [DATA]] TYPE`"], "metadata": {"chunk_id": "sql-statements-alter_table-007", "document_id": "sql-statements-alter_table", "position": 7, "token_count": 193, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`[SET [DATA]] TYPE`"], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table#set-data-type"}}
{"chunk_id": "sql-statements-alter_table-008", "document_id": "sql-statements-alter_table", "content": "```\n\nThe `[SET [DATA]] TYPE` clause changes the type of a column in a table. Any data present in the column is converted according to the provided expression in the `USING` clause, or, if the `USING` clause is absent, cast to the new data type. Note that columns can only have their type changed if they do not have any indexes that rely on them and are not part of any `CHECK` constraints.", "position": 8, "token_count": 96, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-statements-alter_table-008", "document_id": "sql-statements-alter_table", "position": 8, "token_count": 96, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table"}}
{"chunk_id": "sql-statements-alter_table-009", "document_id": "sql-statements-alter_table", "content": "### Handling Structs\n\nThere are two options to change the sub-schema of a [`STRUCT`]({% link docs/stable/sql/data_types/struct.md %})-typed column.\n\n#### `ALTER TABLE` with `struct_insert`\n\nYou can use `ALTER TABLE` with the `struct_insert` function.\nFor example:\n\n```sql\nCREATE TABLE tbl (col STRUCT(i INTEGER));\nALTER TABLE tbl\nALTER col TYPE USING struct_insert(col, a := 42, b := NULL::VARCHAR);\n```\n\n#### `ALTER TABLE` with `ADD COLUMN` / `DROP COLUMN` / `RENAME COLUMN`\n\nStarting with DuckDB v1.3.0, `ALTER TABLE` supports the\n[`ADD COLUMN`, `DROP COLUMN` and `RENAME COLUMN` clauses]({% link docs/stable/sql/data_types/struct.md %}#updating-the-schema)\nto update the sub-schema of a `STRUCT`.", "position": 9, "token_count": 252, "has_code": true, "section_hierarchy": ["`ALTER TABLE` with `ADD COLUMN` / `DROP COLUMN` / `RENAME COLUMN`"], "metadata": {"chunk_id": "sql-statements-alter_table-009", "document_id": "sql-statements-alter_table", "position": 9, "token_count": 252, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`ALTER TABLE` with `ADD COLUMN` / `DROP COLUMN` / `RENAME COLUMN`"], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table#alter-table-with-add-column--drop-column--rename-column"}}
{"chunk_id": "sql-statements-alter_table-010", "document_id": "sql-statements-alter_table", "content": "## `SET` / `DROP DEFAULT`\n\nSet the default value of a column:\n\n```sql\nALTER TABLE integers\nALTER COLUMN i SET DEFAULT 10;\n```\n\nDrop the default value of a column:\n\n```sql\nALTER TABLE integers\nALTER COLUMN i DROP DEFAULT;\n```\n\nThe `SET/DROP DEFAULT` clause modifies the `DEFAULT` value of an existing column. Note that this does not modify any existing data in the column. Dropping the default is equivalent to setting the default value to NULL.\n\n> Warning At the moment DuckDB will not allow you to alter a table if there are any dependencies. That means that if you have an index on a column you will first need to drop the index, alter the table, and then recreate the index. Otherwise, you will get a `Dependency Error`.\n\n## `ADD PRIMARY KEY`\n\nAdd a primary key to a column of a table:\n\n```sql\nALTER TABLE integers\nADD PRIMARY KEY (i);\n```\n\nAdd a primary key to multiple columns of a table:\n\n```sql\nALTER TABLE integers\nADD PRIMARY KEY (i, j);\n```", "position": 10, "token_count": 236, "has_code": true, "section_hierarchy": ["`ADD PRIMARY KEY`"], "metadata": {"chunk_id": "sql-statements-alter_table-010", "document_id": "sql-statements-alter_table", "position": 10, "token_count": 236, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`ADD PRIMARY KEY`"], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table#add-primary-key"}}
{"chunk_id": "sql-statements-alter_table-011", "document_id": "sql-statements-alter_table", "content": "## `ADD` / `DROP CONSTRAINT`\n\n> `ADD CONSTRAINT` and `DROP CONSTRAINT` clauses are not yet supported in DuckDB.\n\n## Limitations\n\n`ALTER COLUMN` fails if values of conflicting types have occurred in the table at any point, even if they have been deleted:\n\n```sql\nCREATE TABLE tbl (col VARCHAR);\n\nINSERT INTO tbl\nVALUES ('asdf'), ('42');\n\nDELETE FROM tbl\nWHERE col = 'asdf';\n\nALTER TABLE tbl\nALTER COLUMN col TYPE INTEGER;\n```\n\n```console\nConversion Error:\nCould not convert string 'asdf' to INT32\n```\n\nCurrently, this is expected behavior.\nAs a workaround, you can create a copy of the table:\n\n```sql\nCREATE OR REPLACE TABLE tbl AS FROM tbl;\n```", "position": 11, "token_count": 179, "has_code": true, "section_hierarchy": ["Limitations"], "metadata": {"chunk_id": "sql-statements-alter_table-011", "document_id": "sql-statements-alter_table", "position": 11, "token_count": 179, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Limitations"], "file_path": "sql/statements/alter_table.md", "url": "/sql/statements/alter_table", "title": "ALTER TABLE Statement", "category": null, "tags": [], "section_url": "/sql/statements/alter_table#limitations"}}

{"chunk_id": "guides-file_formats-parquet_import-000", "document_id": "guides-file_formats-parquet_import", "content": "To read data from a Parquet file, use the `read_parquet` function in the `FROM` clause of a query:\n\n```sql\nSELECT * FROM read_parquet('input.parquet');\n```\n\nAlternatively, you can omit the `read_parquet` function and let DuckDB infer it from the extension:\n\n```sql\nSELECT * FROM 'input.parquet';\n```\n\nTo create a new table using the result from a query, use [`CREATE TABLE ... AS SELECT` statement]({% link docs/stable/sql/statements/create_table.md %}#create-table--as-select-ctas):\n\n```sql\nCREATE TABLE new_tbl AS\n SELECT * FROM read_parquet('input.parquet');\n```\n\nTo load data into an existing table from a query, use `INSERT INTO` from a `SELECT` statement:\n\n```sql\nINSERT INTO tbl\n SELECT * FROM read_parquet('input.parquet');", "position": 0, "token_count": 231, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-file_formats-parquet_import-000", "document_id": "guides-file_formats-parquet_import", "position": 0, "token_count": 231, "has_code": true, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "guides/file_formats/parquet_import.md", "url": "/guides/file_formats/parquet_import", "title": "Parquet Import", "category": null, "tags": [], "section_url": "/guides/file_formats/parquet_import"}}
{"chunk_id": "guides-file_formats-parquet_import-001", "document_id": "guides-file_formats-parquet_import", "content": "```\n\nAlternatively, the `COPY` statement can also be used to load data from a Parquet file into an existing table:\n\n```sql\nCOPY tbl FROM 'input.parquet' (FORMAT parquet);\n```", "position": 1, "token_count": 52, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-file_formats-parquet_import-001", "document_id": "guides-file_formats-parquet_import", "position": 1, "token_count": 52, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/file_formats/parquet_import.md", "url": "/guides/file_formats/parquet_import", "title": "Parquet Import", "category": null, "tags": [], "section_url": "/guides/file_formats/parquet_import"}}
{"chunk_id": "guides-file_formats-parquet_import-002", "document_id": "guides-file_formats-parquet_import", "content": "## Adjusting the Schema on the Fly\n\nYou can load a Parquet file into a slightly different schema (e.g., different number of columns, more relaxed types) using the following trick.\n\nSuppose we have a Parquet file with two columns, `c1` and `c2`:\n\n```sql\nCOPY (FROM (VALUES (42, 43)) t(c1, c2))\nTO 'f.parquet';\n```\n\nIf we want to add another column `c3` that is not present in the file, we can run:\n\n```sql\nFROM (VALUES(NULL::VARCHAR, NULL, NULL)) t(c1, c2, c3)\nWHERE false\nUNION ALL BY NAME\nFROM 'f.parquet';\n```\n\nThe first `FROM` clause generates an empty tables with *three* columns where `c1` is a `VARCHAR`.\nThen, we use `UNION ALL BY NAME` to union the Parquet file. The result here is:\n\n```text\n┌─────────┬───────┬───────┐\n│ c1 │ c2 │ c3 │\n│ varchar │ int32 │ int32 │\n├─────────┼───────┼───────┤\n│ 42 │ 43 │ NULL │\n└─────────┴───────┴───────┘", "position": 2, "token_count": 247, "has_code": true, "section_hierarchy": ["Adjusting the Schema on the Fly"], "metadata": {"chunk_id": "guides-file_formats-parquet_import-002", "document_id": "guides-file_formats-parquet_import", "position": 2, "token_count": 247, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Adjusting the Schema on the Fly"], "file_path": "guides/file_formats/parquet_import.md", "url": "/guides/file_formats/parquet_import", "title": "Parquet Import", "category": null, "tags": [], "section_url": "/guides/file_formats/parquet_import#adjusting-the-schema-on-the-fly"}}
{"chunk_id": "guides-file_formats-parquet_import-003", "document_id": "guides-file_formats-parquet_import", "content": "```\n\nFor additional options, see the [Parquet loading reference]({% link docs/stable/data/parquet/overview.md %}).", "position": 3, "token_count": 38, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-file_formats-parquet_import-003", "document_id": "guides-file_formats-parquet_import", "position": 3, "token_count": 38, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/file_formats/parquet_import.md", "url": "/guides/file_formats/parquet_import", "title": "Parquet Import", "category": null, "tags": [], "section_url": "/guides/file_formats/parquet_import"}}

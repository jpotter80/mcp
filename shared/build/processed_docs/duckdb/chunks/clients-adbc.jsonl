{"chunk_id": "clients-adbc-000", "document_id": "clients-adbc", "content": "> The latest stable version of the DuckDB ADBC client is {{ site.current_duckdb_version }}.\n\n[Arrow Database Connectivity (ADBC)](https://arrow.apache.org/adbc/), similarly to ODBC and JDBC, is a C-style API that enables code portability between different database systems. This allows developers to effortlessly build applications that communicate with database systems without using code specific to that system. The main difference between ADBC and ODBC/JDBC is that ADBC uses [Arrow](https://arrow.apache.org/) to transfer data between the database system and the application. DuckDB has an ADBC driver, which takes advantage of the [zero-copy integration between DuckDB and Arrow]({% post_url 2021-12-03-duck-arrow %}) to efficiently transfer data.\n\nPlease refer to the [ADBC documentation page](https://arrow.apache.org/adbc/current/) for a more extensive discussion on ADBC and a detailed API explanation.", "position": 0, "token_count": 231, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-000", "document_id": "clients-adbc", "position": 0, "token_count": 231, "has_code": false, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-001", "document_id": "clients-adbc", "content": "## Implemented Functionality\n\nThe DuckDB-ADBC driver implements the full ADBC specification, with the exception of the `ConnectionReadPartition` and `StatementExecutePartitions` functions. Both of these functions exist to support systems that internally partition the query results, which does not apply to DuckDB.\nIn this section, we will describe the main functions that exist in ADBC, along with the arguments they take and provide examples for each function.", "position": 1, "token_count": 96, "has_code": false, "section_hierarchy": ["Implemented Functionality"], "metadata": {"chunk_id": "clients-adbc-001", "document_id": "clients-adbc", "position": 1, "token_count": 96, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Implemented Functionality"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#implemented-functionality"}}
{"chunk_id": "clients-adbc-002", "document_id": "clients-adbc", "content": "### Database\n\nSet of functions that operate on a database.", "position": 2, "token_count": 15, "has_code": false, "section_hierarchy": ["Database"], "metadata": {"chunk_id": "clients-adbc-002", "document_id": "clients-adbc", "position": 2, "token_count": 15, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Database"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#database"}}
{"chunk_id": "clients-adbc-003", "document_id": "clients-adbc", "content": "| Function name | Description | Arguments | Example |\n|:---|:-|:---|:----|\n| `DatabaseNew` | Allocate a new (but uninitialized) database. | `(AdbcDatabase *database, AdbcError *error)` | `AdbcDatabaseNew(&adbc_database, &adbc_error)` |\n| `DatabaseSetOption` | Set a char* option. | `(AdbcDatabase *database, const char *key, const char *value, AdbcError *error)` | `AdbcDatabaseSetOption(&adbc_database, \"path\", \"test.db\", &adbc_error)` |\n| `DatabaseInit` | Finish setting options and initialize the database. | `(AdbcDatabase *database, AdbcError *error)` | `AdbcDatabaseInit(&adbc_database, &adbc_error)` |", "position": 3, "token_count": 234, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-003", "document_id": "clients-adbc", "position": 3, "token_count": 234, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-004", "document_id": "clients-adbc", "content": "| `DatabaseRelease` | Destroy the database. | `(AdbcDatabase *database, AdbcError *error)` | `AdbcDatabaseRelease(&adbc_database, &adbc_error)` |", "position": 4, "token_count": 56, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-004", "document_id": "clients-adbc", "position": 4, "token_count": 56, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-005", "document_id": "clients-adbc", "content": "### Connection\n\nA set of functions that create and destroy a connection to interact with a database.", "position": 5, "token_count": 22, "has_code": false, "section_hierarchy": ["Connection"], "metadata": {"chunk_id": "clients-adbc-005", "document_id": "clients-adbc", "position": 5, "token_count": 22, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Connection"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#connection"}}
{"chunk_id": "clients-adbc-006", "document_id": "clients-adbc", "content": "| Function name | Description | Arguments | Example |\n|:---|:-|:---|:----|\n| `ConnectionNew` | Allocate a new (but uninitialized) connection. | `(AdbcConnection*, AdbcError*)` | `AdbcConnectionNew(&adbc_connection, &adbc_error)` |\n| `ConnectionSetOption` | Options may be set before ConnectionInit. | `(AdbcConnection*, const char*, const char*, AdbcError*)` | `AdbcConnectionSetOption(&adbc_connection, ADBC_CONNECTION_OPTION_AUTOCOMMIT, ADBC_OPTION_VALUE_DISABLED, &adbc_error)` |", "position": 6, "token_count": 181, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-006", "document_id": "clients-adbc", "position": 6, "token_count": 181, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-007", "document_id": "clients-adbc", "content": "| `ConnectionInit` | Finish setting options and initialize the connection. | `(AdbcConnection*, AdbcDatabase*, AdbcError*)` | `AdbcConnectionInit(&adbc_connection, &adbc_database, &adbc_error)` |\n| `ConnectionRelease` | Destroy this connection. | `(AdbcConnection*, AdbcError*)` | `AdbcConnectionRelease(&adbc_connection, &adbc_error)` |", "position": 7, "token_count": 124, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-007", "document_id": "clients-adbc", "position": 7, "token_count": 124, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-008", "document_id": "clients-adbc", "content": "A set of functions that retrieve metadata about the database. In general, these functions will return Arrow objects, specifically an ArrowArrayStream.", "position": 8, "token_count": 30, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-008", "document_id": "clients-adbc", "position": 8, "token_count": 30, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-009", "document_id": "clients-adbc", "content": "| Function name | Description | Arguments | Example |\n|:---|:-|:---|:----|\n| `ConnectionGetObjects` | Get a hierarchical view of all catalogs, database schemas, tables, and columns. | `(AdbcConnection*, int, const char*, const char*, const char*, const char**, const char*, ArrowArrayStream*, AdbcError*)` | `AdbcDatabaseInit(&adbc_database, &adbc_error)` |\n| `ConnectionGetTableSchema` | Get the Arrow schema of a table. | `(AdbcConnection*, const char*, const char*, const char*, ArrowSchema*, AdbcError*)` | `AdbcDatabaseRelease(&adbc_database, &adbc_error)` |", "position": 9, "token_count": 214, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-009", "document_id": "clients-adbc", "position": 9, "token_count": 214, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-010", "document_id": "clients-adbc", "content": "| `ConnectionGetTableTypes` | Get a list of table types in the database. | `(AdbcConnection*, ArrowArrayStream*, AdbcError*)` | `AdbcDatabaseNew(&adbc_database, &adbc_error)` |", "position": 10, "token_count": 68, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-010", "document_id": "clients-adbc", "position": 10, "token_count": 68, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-011", "document_id": "clients-adbc", "content": "A set of functions with transaction semantics for the connection. By default, all connections start with auto-commit mode on, but this can be turned off via the ConnectionSetOption function.\n\n| Function name | Description | Arguments | Example |\n|:---|:-|:---|:----|\n| `ConnectionCommit` | Commit any pending transactions. | `(AdbcConnection*, AdbcError*)` | `AdbcConnectionCommit(&adbc_connection, &adbc_error)` |\n| `ConnectionRollback` | Rollback any pending transactions. | `(AdbcConnection*, AdbcError*)` | `AdbcConnectionRollback(&adbc_connection, &adbc_error)` |", "position": 11, "token_count": 176, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-011", "document_id": "clients-adbc", "position": 11, "token_count": 176, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-012", "document_id": "clients-adbc", "content": "### Statement\n\nStatements hold state related to query execution. They represent both one-off queries and prepared statements. They can be reused; however, doing so will invalidate prior result sets from that statement.\n\nThe functions used to create, destroy, and set options for a statement:", "position": 12, "token_count": 60, "has_code": false, "section_hierarchy": ["Statement"], "metadata": {"chunk_id": "clients-adbc-012", "document_id": "clients-adbc", "position": 12, "token_count": 60, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Statement"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#statement"}}
{"chunk_id": "clients-adbc-013", "document_id": "clients-adbc", "content": "The functions used to create, destroy, and set options for a statement:\n\n| Function name | Description | Arguments | Example |\n|:---|:-|:---|:----|\n| `StatementNew` | Create a new statement for a given connection. | `(AdbcConnection*, AdbcStatement*, AdbcError*)` | `AdbcStatementNew(&adbc_connection, &adbc_statement, &adbc_error)` |\n| `StatementRelease` | Destroy a statement. | `(AdbcStatement*, AdbcError*)` | `AdbcStatementRelease(&adbc_statement, &adbc_error)` |\n| `StatementSetOption` | Set a string option on a statement. | `(AdbcStatement*, const char*, const char*, AdbcError*)` | `StatementSetOption(&adbc_statement, ADBC_INGEST_OPTION_TARGET_TABLE, \"TABLE_NAME\", &adbc_error)` |", "position": 13, "token_count": 249, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-013", "document_id": "clients-adbc", "position": 13, "token_count": 249, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-014", "document_id": "clients-adbc", "content": "Functions related to query execution:", "position": 14, "token_count": 8, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-014", "document_id": "clients-adbc", "position": 14, "token_count": 8, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-015", "document_id": "clients-adbc", "content": "| Function name | Description | Arguments | Example |\n|:---|:-|:---|:----|\n| `StatementSetSqlQuery` | Set the SQL query to execute. The query can then be executed with StatementExecuteQuery. | `(AdbcStatement*, const char*, AdbcError*)` | `AdbcStatementSetSqlQuery(&adbc_statement, \"SELECT * FROM TABLE\", &adbc_error)` |\n| `StatementSetSubstraitPlan` | Set a substrait plan to execute. The query can then be executed with StatementExecuteQuery. | `(AdbcStatement*, const uint8_t*, size_t, AdbcError*)` | `AdbcStatementSetSubstraitPlan(&adbc_statement, substrait_plan, length, &adbc_error)` |", "position": 15, "token_count": 219, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-015", "document_id": "clients-adbc", "position": 15, "token_count": 219, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-016", "document_id": "clients-adbc", "content": "| `StatementExecuteQuery` | Execute a statement and get the results. | `(AdbcStatement*, ArrowArrayStream*, int64_t*, AdbcError*)` | `AdbcStatementExecuteQuery(&adbc_statement, &arrow_stream, &rows_affected, &adbc_error)` |\n| `StatementPrepare` | Turn this statement into a prepared statement to be executed multiple times. | `(AdbcStatement*, AdbcError*)` | `AdbcStatementPrepare(&adbc_statement, &adbc_error)` |", "position": 16, "token_count": 149, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-016", "document_id": "clients-adbc", "position": 16, "token_count": 149, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-017", "document_id": "clients-adbc", "content": "Functions related to binding, used for bulk insertion or in prepared statements.\n\n| Function name | Description | Arguments | Example |\n|:---|:-|:---|:----|\n| `StatementBindStream` | Bind Arrow Stream. This can be used for bulk inserts or prepared statements. | `(AdbcStatement*, ArrowArrayStream*, AdbcError*)` | `StatementBindStream(&adbc_statement, &input_data, &adbc_error)` |", "position": 17, "token_count": 119, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-017", "document_id": "clients-adbc", "position": 17, "token_count": 119, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-018", "document_id": "clients-adbc", "content": "## Setting Up the DuckDB ADBC Driver\n\nBefore using DuckDB as an ADBC driver, you must install the `libduckdb` shared library on your system and make it available to your application. This library contains the core DuckDB engine that the ADBC driver interfaces with.\n\n### Downloading libduckdb\n\nDownload the appropriate `libduckdb` library for your platform from the [DuckDB releases page](https://github.com/duckdb/duckdb/releases):\n\n- **Linux**: `libduckdb-linux-amd64.zip` (contains `libduckdb.so`)\n- **macOS**: `libduckdb-osx-universal.zip` (contains `libduckdb.dylib`)\n- **Windows**: `libduckdb-windows-amd64.zip` (contains `duckdb.dll`)\n\nExtract the archive to obtain the shared library file.", "position": 18, "token_count": 226, "has_code": false, "section_hierarchy": ["Downloading libduckdb"], "metadata": {"chunk_id": "clients-adbc-018", "document_id": "clients-adbc", "position": 18, "token_count": 226, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Downloading libduckdb"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#downloading-libduckdb"}}
{"chunk_id": "clients-adbc-019", "document_id": "clients-adbc", "content": "### Installing the Library\n\n#### Linux\n\n1. Extract the `libduckdb.so` file from the downloaded archive\n2. Make sure your code can use the library. You can:\n\n - Either copy it to a system library directory (requires root access):\n\n ```bash\n sudo cp libduckdb.so /usr/local/lib/\n sudo ldconfig\n ```\n\n - Or place it in a custom directory and add that directory to your `LD_LIBRARY_PATH`:\n\n ```bash\n mkdir -p ~/lib\n cp libduckdb.so ~/lib/\n export LD_LIBRARY_PATH=~/lib:$LD_LIBRARY_PATH\n ```", "position": 19, "token_count": 161, "has_code": true, "section_hierarchy": ["Linux"], "metadata": {"chunk_id": "clients-adbc-019", "document_id": "clients-adbc", "position": 19, "token_count": 161, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Linux"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#linux"}}
{"chunk_id": "clients-adbc-020", "document_id": "clients-adbc", "content": "#### macOS\n\n1. Extract the `libduckdb.dylib` file from the downloaded archive\n2. Make sure your code can use the library. You can:\n\n - Either copy it to a system library directory:\n\n ```bash\n sudo cp libduckdb.dylib /usr/local/lib/\n ```\n\n - Or place it in a custom directory and add that directory to your `DYLD_LIBRARY_PATH`:\n\n ```bash\n mkdir -p ~/lib\n cp libduckdb.dylib ~/lib/\n export DYLD_LIBRARY_PATH=~/lib:$DYLD_LIBRARY_PATH\n ```\n\n#### Windows\n\n1. Extract the `duckdb.dll` file from the downloaded archive\n2. Place it in one of the following locations:\n - The same directory as your application executable\n - A directory listed in your `PATH` environment variable\n - The Windows system directory (e.g., `C:\\Windows\\System32`)", "position": 20, "token_count": 231, "has_code": true, "section_hierarchy": ["Windows"], "metadata": {"chunk_id": "clients-adbc-020", "document_id": "clients-adbc", "position": 20, "token_count": 231, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Windows"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#windows"}}
{"chunk_id": "clients-adbc-021", "document_id": "clients-adbc", "content": "### Understanding Library Paths\n\nThe `LD_LIBRARY_PATH` (Linux) and `DYLD_LIBRARY_PATH` (macOS) are environment variables that tell the system where to look for shared libraries at runtime. When your application tries to load `libduckdb`, the system searches these paths to locate the library file.\n\n### Verifying Installation\n\nYou can verify that the library is properly installed and accessible:\n\n**Linux/macOS:**\n```bash\nldd path/to/your/application # Linux\notool -L path/to/your/application # macOS\n```", "position": 21, "token_count": 134, "has_code": true, "section_hierarchy": ["Verifying Installation"], "metadata": {"chunk_id": "clients-adbc-021", "document_id": "clients-adbc", "position": 21, "token_count": 134, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Verifying Installation"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#verifying-installation"}}
{"chunk_id": "clients-adbc-022", "document_id": "clients-adbc", "content": "## Examples\n\nRegardless of the programming language being used, there are two database options which will be required to utilize ADBC with DuckDB. The first one is the `driver`, which takes a path to the DuckDB library (see [Setting Up the DuckDB ADBC Driver](#setting-up-the-duckdb-adbc-driver) above for installation instructions). The second option is the `entrypoint`, which is an exported function from the DuckDB-ADBC driver that initializes all the ADBC functions. Once we have configured these two options, we can optionally set the `path` option, providing a path on disk to store our DuckDB database. If not set, an in-memory database is created. After configuring all the necessary options, we can proceed to initialize our database. Below is how you can do so with various different language environments.", "position": 22, "token_count": 189, "has_code": false, "section_hierarchy": ["Examples"], "metadata": {"chunk_id": "clients-adbc-022", "document_id": "clients-adbc", "position": 22, "token_count": 189, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Examples"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#examples"}}
{"chunk_id": "clients-adbc-023", "document_id": "clients-adbc", "content": "### C++\n\nWe begin our C++ example by declaring the essential variables for querying data through ADBC. These variables include Error, Database, Connection, Statement handling, and an Arrow Stream to transfer data between DuckDB and the application.\n\n```cpp\nAdbcError adbc_error;\nAdbcDatabase adbc_database;\nAdbcConnection adbc_connection;\nAdbcStatement adbc_statement;\nArrowArrayStream arrow_stream;", "position": 23, "token_count": 106, "has_code": true, "section_hierarchy": ["C++"], "metadata": {"chunk_id": "clients-adbc-023", "document_id": "clients-adbc", "position": 23, "token_count": 106, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["C++"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#c"}}
{"chunk_id": "clients-adbc-024", "document_id": "clients-adbc", "content": "```\n\nWe can then initialize our database variable. Before initializing the database, we need to set the `driver` and `entrypoint` options as mentioned above. Then we set the `path` option and initialize the database. The `driver` option should point to your installed `libduckdb` library – see [Setting Up the DuckDB ADBC Driver](#setting-up-the-duckdb-adbc-driver) for installation instructions.", "position": 24, "token_count": 102, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-024", "document_id": "clients-adbc", "position": 24, "token_count": 102, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-025", "document_id": "clients-adbc", "content": "```cpp\nAdbcDatabaseNew(&adbc_database, &adbc_error);\nAdbcDatabaseSetOption(&adbc_database, \"driver\", \"path/to/libduckdb.dylib\", &adbc_error);\nAdbcDatabaseSetOption(&adbc_database, \"entrypoint\", \"duckdb_adbc_init\", &adbc_error);\n// By default, we start an in-memory database, but you can optionally define a path to store it on disk.\nAdbcDatabaseSetOption(&adbc_database, \"path\", \"test.db\", &adbc_error);\nAdbcDatabaseInit(&adbc_database, &adbc_error);", "position": 25, "token_count": 188, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-025", "document_id": "clients-adbc", "position": 25, "token_count": 188, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-026", "document_id": "clients-adbc", "content": "```\n\nAfter initializing the database, we must create and initialize a connection to it.\n\n```cpp\nAdbcConnectionNew(&adbc_connection, &adbc_error);\nAdbcConnectionInit(&adbc_connection, &adbc_database, &adbc_error);\n```\n\nWe can now initialize our statement and run queries through our connection. After the `AdbcStatementExecuteQuery` the `arrow_stream` is populated with the result.\n\n```cpp\nAdbcStatementNew(&adbc_connection, &adbc_statement, &adbc_error);\nAdbcStatementSetSqlQuery(&adbc_statement, \"SELECT 42\", &adbc_error);\nint64_t rows_affected;\nAdbcStatementExecuteQuery(&adbc_statement, &arrow_stream, &rows_affected, &adbc_error);\narrow_stream.release(arrow_stream)", "position": 26, "token_count": 232, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-026", "document_id": "clients-adbc", "position": 26, "token_count": 232, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-027", "document_id": "clients-adbc", "content": "```\n\nBesides running queries, we can also ingest data via `arrow_streams`. For this we need to set an option with the table name we want to insert to, bind the stream and then execute the query.\n\n```cpp\nStatementSetOption(&adbc_statement, ADBC_INGEST_OPTION_TARGET_TABLE, \"AnswerToEverything\", &adbc_error);\nStatementBindStream(&adbc_statement, &arrow_stream, &adbc_error);\nStatementExecuteQuery(&adbc_statement, nullptr, nullptr, &adbc_error);\n```", "position": 27, "token_count": 146, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-027", "document_id": "clients-adbc", "position": 27, "token_count": 146, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-028", "document_id": "clients-adbc", "content": "### Python\n\nThe first thing to do is to use `pip` and install the ADBC Driver manager. You will also need to install the `pyarrow` to directly access Apache Arrow formatted result sets (such as using `fetch_arrow_table`).\n\n```bash\npip install adbc_driver_manager pyarrow", "position": 28, "token_count": 74, "has_code": true, "section_hierarchy": ["Python"], "metadata": {"chunk_id": "clients-adbc-028", "document_id": "clients-adbc", "position": 28, "token_count": 74, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Python"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#python"}}
{"chunk_id": "clients-adbc-029", "document_id": "clients-adbc", "content": "```\n\n> For details on the `adbc_driver_manager` package, see the [`adbc_driver_manager` package documentation](https://arrow.apache.org/adbc/current/python/api/adbc_driver_manager.html).\n\nAs with C++, we need to provide initialization options consisting of the location of the libduckdb shared object and entrypoint function. Notice that the `path` argument for DuckDB is passed in through the `db_kwargs` dictionary.\n\n```python\nimport adbc_driver_duckdb.dbapi\n\nwith adbc_driver_duckdb.dbapi.connect(\"test.db\") as conn, conn.cursor() as cur:\n cur.execute(\"SELECT 42\")\n # fetch a pyarrow table\n tbl = cur.fetch_arrow_table()\n print(tbl)", "position": 29, "token_count": 207, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-029", "document_id": "clients-adbc", "position": 29, "token_count": 207, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-030", "document_id": "clients-adbc", "content": "```\n\nAlongside `fetch_arrow_table`, other methods from DBApi are also implemented on the cursor, such as `fetchone` and `fetchall`. Data can also be ingested via `arrow_streams`. We just need to set options on the statement to bind the stream of data and execute the query.\n\n```python\nimport adbc_driver_duckdb.dbapi\nimport pyarrow\n\ndata = pyarrow.record_batch(\n [[1, 2, 3, 4], [\"a\", \"b\", \"c\", \"d\"]],\n names = [\"ints\", \"strs\"],\n)\n\nwith adbc_driver_duckdb.dbapi.connect(\"test.db\") as conn, conn.cursor() as cur:\n cur.adbc_ingest(\"AnswerToEverything\", data)\n```", "position": 30, "token_count": 208, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-030", "document_id": "clients-adbc", "position": 30, "token_count": 208, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-031", "document_id": "clients-adbc", "content": "### Go\n\nMake sure to install the `libduckdb` library first – see [Setting Up the DuckDB ADBC Driver](#setting-up-the-duckdb-adbc-driver) for detailed installation instructions.\n\nThe following example uses an in-memory DuckDB database to modify in-memory Arrow RecordBatches via SQL queries:\n\n{% raw %}\n```go\npackage main\n\nimport (\n \"bytes\"\n \"context\"\n \"fmt\"\n \"io\"\n\n \"github.com/apache/arrow-adbc/go/adbc\"\n \"github.com/apache/arrow-adbc/go/adbc/drivermgr\"\n \"github.com/apache/arrow-go/v18/arrow\"\n \"github.com/apache/arrow-go/v18/arrow/array\"\n \"github.com/apache/arrow-go/v18/arrow/ipc\"\n \"github.com/apache/arrow-go/v18/arrow/memory\"\n)", "position": 31, "token_count": 226, "has_code": true, "section_hierarchy": ["Go"], "metadata": {"chunk_id": "clients-adbc-031", "document_id": "clients-adbc", "position": 31, "token_count": 226, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Go"], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc#go"}}
{"chunk_id": "clients-adbc-032", "document_id": "clients-adbc", "content": "func _makeSampleArrowRecord() arrow.Record {\n b := array.NewFloat64Builder(memory.DefaultAllocator)\n b.AppendValues([]float64{1, 2, 3}, nil)\n col := b.NewArray()\n\n defer col.Release()\n defer b.Release()\n\n schema := arrow.NewSchema([]arrow.Field{{Name: \"column1\", Type: arrow.PrimitiveTypes.Float64}}, nil)\n return array.NewRecord(schema, []arrow.Array{col}, int64(col.Len()))\n}\n\ntype DuckDBSQLRunner struct {\n ctx context.Context\n conn adbc.Connection\n db adbc.Database\n}", "position": 32, "token_count": 184, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-032", "document_id": "clients-adbc", "position": 32, "token_count": 184, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-033", "document_id": "clients-adbc", "content": "type DuckDBSQLRunner struct {\n ctx context.Context\n conn adbc.Connection\n db adbc.Database\n}\n\nfunc NewDuckDBSQLRunner(ctx context.Context) (*DuckDBSQLRunner, error) {\n var drv drivermgr.Driver\n db, err := drv.NewDatabase(map[string]string{\n \"driver\": \"duckdb\",\n \"entrypoint\": \"duckdb_adbc_init\",\n \"path\": \":memory:\",\n })\n if err != nil {\n return nil, fmt.Errorf(\"failed to create new in-memory DuckDB database: %w\", err)\n }\n conn, err := db.Open(ctx)\n if err != nil {\n return nil, fmt.Errorf(\"failed to open connection to new in-memory DuckDB database: %w\", err)\n }\n return &DuckDBSQLRunner{ctx: ctx, conn: conn, db: db}, nil\n}", "position": 33, "token_count": 249, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-033", "document_id": "clients-adbc", "position": 33, "token_count": 249, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-034", "document_id": "clients-adbc", "content": "func serializeRecord(record arrow.Record) (io.Reader, error) {\n buf := new(bytes.Buffer)\n wr := ipc.NewWriter(buf, ipc.WithSchema(record.Schema()))\n if err := wr.Write(record); err != nil {\n return nil, fmt.Errorf(\"failed to write record: %w\", err)\n }\n if err := wr.Close(); err != nil {\n return nil, fmt.Errorf(\"failed to close writer: %w\", err)\n }\n return buf, nil\n}\n\nfunc (r *DuckDBSQLRunner) importRecord(sr io.Reader) error {\n rdr, err := ipc.NewReader(sr)\n if err != nil {\n return fmt.Errorf(\"failed to create IPC reader: %w\", err)\n }\n defer rdr.Release()", "position": 34, "token_count": 231, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-034", "document_id": "clients-adbc", "position": 34, "token_count": 231, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-035", "document_id": "clients-adbc", "content": "_, err = adbc.IngestStream(r.ctx, r.conn, rdr, \"temp_table\", adbc.OptionValueIngestModeCreate, adbc.IngestStreamOptions{})\n\n return err\n}\n\nfunc (r *DuckDBSQLRunner) runSQL(sql string) ([]arrow.Record, error) {\n stmt, err := r.conn.NewStatement()\n if err != nil {\n return nil, fmt.Errorf(\"failed to create new statement: %w\", err)\n }\n defer stmt.Close()", "position": 35, "token_count": 150, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-035", "document_id": "clients-adbc", "position": 35, "token_count": 150, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-036", "document_id": "clients-adbc", "content": "if err := stmt.SetSqlQuery(sql); err != nil {\n return nil, fmt.Errorf(\"failed to set SQL query: %w\", err)\n }\n out, n, err := stmt.ExecuteQuery(r.ctx)\n if err != nil {\n return nil, fmt.Errorf(\"failed to execute query: %w\", err)\n }\n defer out.Release()\n\n result := make([]arrow.Record, 0, n)\n for out.Next() {\n rec := out.Record()\n rec.Retain() // .Next() will release the record, so we need to retain it\n result = append(result, rec)\n }\n if out.Err() != nil {\n return nil, out.Err()\n }\n return result, nil\n}", "position": 36, "token_count": 201, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-036", "document_id": "clients-adbc", "position": 36, "token_count": 201, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-037", "document_id": "clients-adbc", "content": "func (r *DuckDBSQLRunner) RunSQLOnRecord(record arrow.Record, sql string) ([]arrow.Record, error) {\n serializedRecord, err := serializeRecord(record)\n if err != nil {\n return nil, fmt.Errorf(\"failed to serialize record: %w\", err)\n }\n if err := r.importRecord(serializedRecord); err != nil {\n return nil, fmt.Errorf(\"failed to import record: %w\", err)\n }\n result, err := r.runSQL(sql)\n if err != nil {\n return nil, fmt.Errorf(\"failed to run SQL: %w\", err)\n }\n\n if _, err := r.runSQL(\"DROP TABLE temp_table\"); err != nil {\n return nil, fmt.Errorf(\"failed to drop temp table after running query: %w\", err)\n }\n return result, nil\n}", "position": 37, "token_count": 249, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-037", "document_id": "clients-adbc", "position": 37, "token_count": 249, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-038", "document_id": "clients-adbc", "content": "func (r *DuckDBSQLRunner) Close() {\n r.conn.Close()\n r.db.Close()\n}\n\nfunc main() {\n rec := _makeSampleArrowRecord()\n fmt.Println(rec)\n\n runner, err := NewDuckDBSQLRunner(context.Background())\n if err != nil {\n panic(err)\n }\n defer runner.Close()\n\n resultRecords, err := runner.RunSQLOnRecord(rec, \"SELECT column1+1 FROM temp_table\")\n if err != nil {\n panic(err)\n }\n\n for _, resultRecord := range resultRecords {\n fmt.Println(resultRecord)\n resultRecord.Release()\n }\n}", "position": 38, "token_count": 188, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-038", "document_id": "clients-adbc", "position": 38, "token_count": 188, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}
{"chunk_id": "clients-adbc-039", "document_id": "clients-adbc", "content": "```\n{% endraw %}\n\nRunning it produces the following output:\n\n```go\nrecord:\n schema:\n fields: 1\n - column1: type=float64\n rows: 3\n col[0][column1]: [1 2 3]\n\nrecord:\n schema:\n fields: 1\n - (column1 + 1): type=float64, nullable\n rows: 3\n col[0][(column1 + 1)]: [2 3 4]\n```", "position": 39, "token_count": 103, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-adbc-039", "document_id": "clients-adbc", "position": 39, "token_count": 103, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/adbc.md", "url": "/clients/adbc", "title": "ADBC Client", "category": null, "tags": [], "section_url": "/clients/adbc"}}

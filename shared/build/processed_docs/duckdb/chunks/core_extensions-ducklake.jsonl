{"chunk_id": "core_extensions-ducklake-000", "document_id": "core_extensions-ducklake", "content": "> DuckLake has been released in May 2025.\n> Read the [announcement blog post]({% post_url 2025-05-27-ducklake %}).\n\nThe `ducklake` extension add support for attaching to databases stored in the [DuckLake format](http://ducklake.select/).\nThe complete documentation of this extension is available at the [DuckLake website](https://ducklake.select/docs/stable/duckdb/introduction).\n\n## Installing and Loading\n\nTo install `ducklake`, run:\n\n```sql\nINSTALL ducklake;\n```\n\nThe `ducklake` extension will be transparently [autoloaded]({% link docs/stable/core_extensions/overview.md %}#autoloading-extensions) on first use in an `ATTACH` clause.\nIf you would like to load it manually, run:\n\n```sql\nLOAD ducklake;\n```\n\n## Usage\n\n```sql\nATTACH 'ducklake:metadata.ducklake' AS my_ducklake (DATA_PATH 'data_files');\nUSE my_ducklake;\n```", "position": 0, "token_count": 247, "has_code": true, "section_hierarchy": ["Usage"], "metadata": {"chunk_id": "core_extensions-ducklake-000", "document_id": "core_extensions-ducklake", "position": 0, "token_count": 247, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Usage"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#usage"}}
{"chunk_id": "core_extensions-ducklake-001", "document_id": "core_extensions-ducklake", "content": "## Usage\n\n```sql\nATTACH 'ducklake:metadata.ducklake' AS my_ducklake (DATA_PATH 'data_files');\nUSE my_ducklake;\n```\n\n## Tables\n\nIn DuckDB, the `ducklake` extension stores the [catalog tables](http://ducklake.select/docs/stable/specification/tables/overview) for a DuckLake named `my_ducklake` in the `__ducklake_metadata_⟨my_ducklake⟩`{:.language-sql .highlight} catalog.", "position": 1, "token_count": 123, "has_code": true, "section_hierarchy": ["Tables"], "metadata": {"chunk_id": "core_extensions-ducklake-001", "document_id": "core_extensions-ducklake", "position": 1, "token_count": 123, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Tables"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#tables"}}
{"chunk_id": "core_extensions-ducklake-002", "document_id": "core_extensions-ducklake", "content": "## Functions\n\nNote that DuckLake registers several functions.\nThese should be called with the catalog name as the first argument, e.g.:\n\n```sql\nFROM ducklake_snapshots('my_ducklake');\n```\n\n```text\n┌─────────────┬────────────────────────────┬────────────────┬──────────────────────────┐\n│ snapshot_id │ snapshot_time │ schema_version │ changes │\n│ int64 │ timestamp with time zone │ int64 │ map(varchar, varchar[]) │\n├─────────────┼────────────────────────────┼────────────────┼──────────────────────────┤\n│ 0 │ 2025-05-26 11:41:10.838+02 │ 0 │ {schemas_created=[main]} │\n└─────────────┴────────────────────────────┴────────────────┴──────────────────────────┘\n```", "position": 2, "token_count": 143, "has_code": true, "section_hierarchy": ["Functions"], "metadata": {"chunk_id": "core_extensions-ducklake-002", "document_id": "core_extensions-ducklake", "position": 2, "token_count": 143, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Functions"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#functions"}}
{"chunk_id": "core_extensions-ducklake-003", "document_id": "core_extensions-ducklake", "content": "### `ducklake_snapshots`\n\nReturns the snapshots stored in the DuckLake catalog name `catalog`.\n\n| Parameter name | Parameter type | Named parameter | Description |\n| -------------- | -------------- | --------------- | ----------- |\n| `catalog` | `VARCHAR` | no | |\n\nThe information is encoded into a table with the following schema:\n\n| Column name | Column type |\n| ---------------- | -------------------------- |\n| `snapshot_id` | `BIGINT` |\n| `snapshot_time` | `TIMESTAMP WITH TIME ZONE` |\n| `schema_version` | `BIGINT` |\n| `changes` | `MAP(VARCHAR, VARCHAR[])` |", "position": 3, "token_count": 242, "has_code": false, "section_hierarchy": ["`ducklake_snapshots`"], "metadata": {"chunk_id": "core_extensions-ducklake-003", "document_id": "core_extensions-ducklake", "position": 3, "token_count": 242, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`ducklake_snapshots`"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#ducklakesnapshots"}}
{"chunk_id": "core_extensions-ducklake-004", "document_id": "core_extensions-ducklake", "content": "### `ducklake_table_info`\n\nThe `ducklake_table_info` function returns information on the tables stored in the DuckLake catalog named `catalog`.\n\n| Parameter name | Parameter type | Named parameter | Description |\n| -------------- | -------------- | --------------- | ----------- |\n| `catalog` | `VARCHAR` | no | |\n\nThe information is encoded into a table with the following schema:", "position": 4, "token_count": 137, "has_code": false, "section_hierarchy": ["`ducklake_table_info`"], "metadata": {"chunk_id": "core_extensions-ducklake-004", "document_id": "core_extensions-ducklake", "position": 4, "token_count": 137, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`ducklake_table_info`"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#ducklaketableinfo"}}
{"chunk_id": "core_extensions-ducklake-005", "document_id": "core_extensions-ducklake", "content": "The information is encoded into a table with the following schema:\n\n| Column name | Column type |\n| ------------------------ | ----------- |\n| `table_name` | `VARCHAR` |\n| `schema_id` | `BIGINT` |\n| `table_id` | `BIGINT` |\n| `table_uuid` | `UUID` |\n| `file_count` | `BIGINT` |\n| `file_size_bytes` | `BIGINT` |\n| `delete_file_count` | `BIGINT` |\n| `delete_file_size_bytes` | `BIGINT` |", "position": 5, "token_count": 169, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-ducklake-005", "document_id": "core_extensions-ducklake", "position": 5, "token_count": 169, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake"}}
{"chunk_id": "core_extensions-ducklake-006", "document_id": "core_extensions-ducklake", "content": "### `ducklake_table_insertions`\n\nThe `ducklake_table_insertions` function returns the rows inserted in a given table between snapshots of given versions or timestamps.\nThe function has two variants, depending on whether `start_snapshot` and `end_snapshot` have types `BIGINT` or `TIMESTAMP WITH TIME ZONE`.", "position": 6, "token_count": 83, "has_code": false, "section_hierarchy": ["`ducklake_table_insertions`"], "metadata": {"chunk_id": "core_extensions-ducklake-006", "document_id": "core_extensions-ducklake", "position": 6, "token_count": 83, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`ducklake_table_insertions`"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#ducklaketableinsertions"}}
{"chunk_id": "core_extensions-ducklake-007", "document_id": "core_extensions-ducklake", "content": "| Parameter name | Parameter type | Named parameter | Description |\n| ---------------- | ------------------------------------- | --------------- | ----------- |\n| `catalog` | `VARCHAR` | no | |\n| `schema_name` | `VARCHAR` | no | |\n| `table_name` | `VARCHAR` | no | |\n| `start_snapshot` | `BIGINT` / `TIMESTAMP WITH TIME ZONE` | no | |\n| `end_snapshot` | `BIGINT` / `TIMESTAMP WITH TIME ZONE` | no | |\n\nThe schema of the table returned by the function is equivalent to that of the table `table_name`.", "position": 7, "token_count": 218, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-ducklake-007", "document_id": "core_extensions-ducklake", "position": 7, "token_count": 218, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake"}}
{"chunk_id": "core_extensions-ducklake-008", "document_id": "core_extensions-ducklake", "content": "### `ducklake_table_deletions`\n\nThe `ducklake_table_deletions` function returns the rows deleted from a given table between snapshots of given versions or timestamps.\nThe function has two variants, depending on whether `start_snapshot` and `end_snapshot` have types `BIGINT` or `TIMESTAMP WITH TIME ZONE`.", "position": 8, "token_count": 85, "has_code": false, "section_hierarchy": ["`ducklake_table_deletions`"], "metadata": {"chunk_id": "core_extensions-ducklake-008", "document_id": "core_extensions-ducklake", "position": 8, "token_count": 85, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`ducklake_table_deletions`"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#ducklaketabledeletions"}}
{"chunk_id": "core_extensions-ducklake-009", "document_id": "core_extensions-ducklake", "content": "| Parameter name | Parameter type | Named parameter | Description |\n| ---------------- | ------------------------------------- | --------------- | ----------- |\n| `catalog` | `VARCHAR` | no | |\n| `schema_name` | `VARCHAR` | no | |\n| `table_name` | `VARCHAR` | no | |\n| `start_snapshot` | `BIGINT` / `TIMESTAMP WITH TIME ZONE` | no | |\n| `end_snapshot` | `BIGINT` / `TIMESTAMP WITH TIME ZONE` | no | |\n\nThe schema of the table returned by the function is equivalent to that of the table `table_name`.", "position": 9, "token_count": 218, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-ducklake-009", "document_id": "core_extensions-ducklake", "position": 9, "token_count": 218, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake"}}
{"chunk_id": "core_extensions-ducklake-010", "document_id": "core_extensions-ducklake", "content": "### `ducklake_table_changes`\n\nThe `ducklake_table_changes` function returns the rows changed in a given table between snapshots of given versions or timestamps.\nThe function has two variants, depending on whether `start_snapshot` and `end_snapshot` have types `BIGINT` or `TIMESTAMP WITH TIME ZONE`.", "position": 10, "token_count": 81, "has_code": false, "section_hierarchy": ["`ducklake_table_changes`"], "metadata": {"chunk_id": "core_extensions-ducklake-010", "document_id": "core_extensions-ducklake", "position": 10, "token_count": 81, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`ducklake_table_changes`"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#ducklaketablechanges"}}
{"chunk_id": "core_extensions-ducklake-011", "document_id": "core_extensions-ducklake", "content": "| Parameter name | Parameter type | Named parameter | Description |\n| ---------------- | ------------------------------------- | --------------- | ----------- |\n| `catalog` | `VARCHAR` | no | |\n| `schema_name` | `VARCHAR` | no | |\n| `table_name` | `VARCHAR` | no | |\n| `start_snapshot` | `BIGINT` / `TIMESTAMP WITH TIME ZONE` | no | |\n| `end_snapshot` | `BIGINT` / `TIMESTAMP WITH TIME ZONE` | no | |\n\nThe schema of the table returned by the function contains the following three columns plus the schema of the table `table_name`.", "position": 11, "token_count": 223, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-ducklake-011", "document_id": "core_extensions-ducklake", "position": 11, "token_count": 223, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake"}}
{"chunk_id": "core_extensions-ducklake-012", "document_id": "core_extensions-ducklake", "content": "The schema of the table returned by the function contains the following three columns plus the schema of the table `table_name`.\n\n| Column name | Column type | Description |\n| ------------- | ----------- | ---------------------------------------- |\n| `snapshot_id` | `BIGINT` | |\n| `rowid` | `BIGINT` | |\n| `change_type` | `VARCHAR` | The type of change: `insert` or `delete` |", "position": 12, "token_count": 160, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-ducklake-012", "document_id": "core_extensions-ducklake", "position": 12, "token_count": 160, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake"}}
{"chunk_id": "core_extensions-ducklake-013", "document_id": "core_extensions-ducklake", "content": "## Commands\n\n### `ducklake_cleanup_old_files`\n\nThe `ducklake_cleanup_old_files` function cleans up old files in the DuckLake denoted by `catalog`.\nUpon success, it returns a table with a single column (`Success`) and 0 rows.\n\n| Parameter name | Parameter type | Named parameter | Description |\n| -------------- | -------------------------- | --------------- | ----------- |\n| `catalog` | `VARCHAR` | no | |\n| `cleanup_all` | `BOOLEAN` | yes | |\n| `dry_run` | `BOOLEAN` | yes | |\n| `older_than` | `TIMESTAMP WITH TIME ZONE` | yes | |", "position": 13, "token_count": 211, "has_code": false, "section_hierarchy": ["`ducklake_cleanup_old_files`"], "metadata": {"chunk_id": "core_extensions-ducklake-013", "document_id": "core_extensions-ducklake", "position": 13, "token_count": 211, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`ducklake_cleanup_old_files`"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#ducklakecleanupoldfiles"}}
{"chunk_id": "core_extensions-ducklake-014", "document_id": "core_extensions-ducklake", "content": "### `ducklake_expire_snapshots`\n\nThe `ducklake_expire_snapshots` function expires snapshots with the versions specified by the `versions` parameter or the ones older than the `older_than` parameter.\nUpon success, it returns a table with a single column (`Success`) and 0 rows.\n\n| Parameter name | Parameter type | Named parameter | Description |\n| -------------- | -------------------------- | --------------- | ----------- |\n| `catalog` | `VARCHAR` | no | |\n| `versions` | `UBIGINT[]` | yes | |\n| `older_than` | `TIMESTAMP WITH TIME ZONE` | yes | |", "position": 14, "token_count": 211, "has_code": false, "section_hierarchy": ["`ducklake_expire_snapshots`"], "metadata": {"chunk_id": "core_extensions-ducklake-014", "document_id": "core_extensions-ducklake", "position": 14, "token_count": 211, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`ducklake_expire_snapshots`"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#ducklakeexpiresnapshots"}}
{"chunk_id": "core_extensions-ducklake-015", "document_id": "core_extensions-ducklake", "content": "### `ducklake_merge_adjacent_files`\n\nThe `ducklake_merge_adjacent_files` function merges adjacent files in the storage.\nUpon success, it returns a table with a single column (`Success`) and 0 rows.\n\n| Parameter name | Parameter type | Named parameter | Description |\n| -------------- | -------------- | --------------- | ----------- |\n| `catalog` | `VARCHAR` | no | |", "position": 15, "token_count": 140, "has_code": false, "section_hierarchy": ["`ducklake_merge_adjacent_files`"], "metadata": {"chunk_id": "core_extensions-ducklake-015", "document_id": "core_extensions-ducklake", "position": 15, "token_count": 140, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`ducklake_merge_adjacent_files`"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#ducklakemergeadjacentfiles"}}
{"chunk_id": "core_extensions-ducklake-016", "document_id": "core_extensions-ducklake", "content": "## Compatibility Matrix\n\nThe DuckLake specification and the `ducklake` DuckDB extension are currently released together. This may not be the case in the future, where the specification and the extension may have different release cadences. It can also be the case that the extension needs a DuckDB core update, therefore DuckDB versions are also included in this compatibility matrix.\n\n| DuckDB | DuckLake Extension | DuckLake Spec |\n|--------|--------------------|---------------|\n| 1.4.x | 0.3 | 0.3 |\n| 1.3.x | 0.2 | 0.2 |\n| 1.3.x | 0.1 | 0.1 |", "position": 16, "token_count": 179, "has_code": false, "section_hierarchy": ["Compatibility Matrix"], "metadata": {"chunk_id": "core_extensions-ducklake-016", "document_id": "core_extensions-ducklake", "position": 16, "token_count": 179, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Compatibility Matrix"], "file_path": "core_extensions/ducklake.md", "url": "/core_extensions/ducklake", "title": "DuckLake", "category": null, "tags": [], "section_url": "/core_extensions/ducklake#compatibility-matrix"}}

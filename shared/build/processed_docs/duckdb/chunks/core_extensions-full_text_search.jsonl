{"chunk_id": "core_extensions-full_text_search-000", "document_id": "core_extensions-full_text_search", "content": "Full-Text Search is an extension to DuckDB that allows for search through strings, similar to [SQLite's FTS5 extension](https://www.sqlite.org/fts5.html).\n\n## Installing and Loading\n\nThe `fts` extension will be transparently [autoloaded]({% link docs/stable/extensions/overview.md %}#autoloading-extensions) on first use from the official extension repository.\nIf you would like to install and load it manually, run:\n\n```sql\nINSTALL fts;\nLOAD fts;\n```", "position": 0, "token_count": 128, "has_code": true, "section_hierarchy": ["Installing and Loading"], "metadata": {"chunk_id": "core_extensions-full_text_search-000", "document_id": "core_extensions-full_text_search", "position": 0, "token_count": 128, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Installing and Loading"], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search#installing-and-loading"}}
{"chunk_id": "core_extensions-full_text_search-001", "document_id": "core_extensions-full_text_search", "content": "## Usage\n\nThe extension adds two `PRAGMA` statements to DuckDB: one to create, and one to drop an index. Additionally, a scalar macro `stem` is added, which is used internally by the extension.", "position": 1, "token_count": 50, "has_code": false, "section_hierarchy": ["Usage"], "metadata": {"chunk_id": "core_extensions-full_text_search-001", "document_id": "core_extensions-full_text_search", "position": 1, "token_count": 50, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Usage"], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search#usage"}}
{"chunk_id": "core_extensions-full_text_search-002", "document_id": "core_extensions-full_text_search", "content": "### `PRAGMA create_fts_index`\n\n```python\ncreate_fts_index(input_table, input_id, *input_values, stemmer = 'porter',\n stopwords = 'english', ignore = '(\\\\.|[^a-z])+',\n strip_accents = 1, lower = 1, overwrite = 0)", "position": 2, "token_count": 87, "has_code": true, "section_hierarchy": ["`PRAGMA create_fts_index`"], "metadata": {"chunk_id": "core_extensions-full_text_search-002", "document_id": "core_extensions-full_text_search", "position": 2, "token_count": 87, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`PRAGMA create_fts_index`"], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search#pragma-createftsindex"}}
{"chunk_id": "core_extensions-full_text_search-003", "document_id": "core_extensions-full_text_search", "content": "```\n\n`PRAGMA` that creates a FTS index for the specified table.", "position": 3, "token_count": 21, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-003", "document_id": "core_extensions-full_text_search", "position": 3, "token_count": 21, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-004", "document_id": "core_extensions-full_text_search", "content": "| Name | Type | Description |\n|:--|:--|:----------|\n| `input_table` | `VARCHAR` | Qualified name of specified table, e.g., `'table_name'` or `'main.table_name'` |\n| `input_id` | `VARCHAR` | Column name of document identifier, e.g., `'document_identifier'` |\n| `input_values...` | `VARCHAR` | Column names of the text fields to be indexed (vararg), e.g., `'text_field_1'`, `'text_field_2'`, ..., `'text_field_N'`, or `'\\*'` for all columns in input_table of type `VARCHAR` |", "position": 4, "token_count": 200, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-004", "document_id": "core_extensions-full_text_search", "position": 4, "token_count": 200, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-005", "document_id": "core_extensions-full_text_search", "content": "| `stemmer` | `VARCHAR` | The type of stemmer to be used. One of `'arabic'`, `'basque'`, `'catalan'`, `'danish'`, `'dutch'`, `'english'`, `'finnish'`, `'french'`, `'german'`, `'greek'`, `'hindi'`, `'hungarian'`, `'indonesian'`, `'irish'`, `'italian'`, `'lithuanian'`, `'nepali'`, `'norwegian'`, `'porter'`, `'portuguese'`, `'romanian'`, `'russian'`, `'serbian'`, `'spanish'`, `'swedish'`, `'tamil'`, `'turkish'`, or `'none'` if no stemming is to be used. Defaults to `'porter'` |", "position": 5, "token_count": 210, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-005", "document_id": "core_extensions-full_text_search", "position": 5, "token_count": 210, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-006", "document_id": "core_extensions-full_text_search", "content": "| `stopwords` | `VARCHAR` | Qualified name of table containing a single `VARCHAR` column containing the desired stopwords, or `'none'` if no stopwords are to be used. Defaults to `'english'` for a pre-defined list of 571 English stopwords |\n| `ignore` | `VARCHAR` | Regular expression of patterns to be ignored. Defaults to `'(\\\\.|[^a-z])+'`, ignoring all escaped and non-alphabetic lowercase characters |\n| `strip_accents` | `BOOLEAN` | Whether to remove accents (e.g., convert `á` to `a`). Defaults to `1` |\n| `lower` | `BOOLEAN` | Whether to convert all text to lowercase. Defaults to `1` |\n| `overwrite` | `BOOLEAN` | Whether to overwrite an existing index on a table. Defaults to `0` |", "position": 6, "token_count": 215, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-006", "document_id": "core_extensions-full_text_search", "position": 6, "token_count": 215, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-007", "document_id": "core_extensions-full_text_search", "content": "This `PRAGMA` builds the index under a newly created schema. The schema will be named after the input table: if an index is created on table `'main.table_name'`, then the schema will be named `'fts_main_table_name'`.", "position": 7, "token_count": 66, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-007", "document_id": "core_extensions-full_text_search", "position": 7, "token_count": 66, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-008", "document_id": "core_extensions-full_text_search", "content": "### `PRAGMA drop_fts_index`\n\n```python\ndrop_fts_index(input_table)\n```\n\nDrops a FTS index for the specified table.\n\n| Name | Type | Description |\n|:--|:--|:-----------|\n| `input_table` | `VARCHAR` | Qualified name of input table, e.g., `'table_name'` or `'main.table_name'` |", "position": 8, "token_count": 115, "has_code": true, "section_hierarchy": ["`PRAGMA drop_fts_index`"], "metadata": {"chunk_id": "core_extensions-full_text_search-008", "document_id": "core_extensions-full_text_search", "position": 8, "token_count": 115, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`PRAGMA drop_fts_index`"], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search#pragma-dropftsindex"}}
{"chunk_id": "core_extensions-full_text_search-009", "document_id": "core_extensions-full_text_search", "content": "### `match_bm25` Function\n\n```python\nmatch_bm25(input_id, query_string, fields := NULL, k := 1.2, b := 0.75, conjunctive := 0)", "position": 9, "token_count": 57, "has_code": true, "section_hierarchy": ["`match_bm25` Function"], "metadata": {"chunk_id": "core_extensions-full_text_search-009", "document_id": "core_extensions-full_text_search", "position": 9, "token_count": 57, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`match_bm25` Function"], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search#matchbm25-function"}}
{"chunk_id": "core_extensions-full_text_search-010", "document_id": "core_extensions-full_text_search", "content": "```\n\nWhen an index is built, this retrieval macro is created that can be used to search the index.", "position": 10, "token_count": 25, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-010", "document_id": "core_extensions-full_text_search", "position": 10, "token_count": 25, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-011", "document_id": "core_extensions-full_text_search", "content": "| Name | Type | Description |\n|:--|:--|:----------|\n| `input_id` | `VARCHAR` | Column name of document identifier, e.g., `'document_identifier'` |\n| `query_string` | `VARCHAR` | The string to search the index for |\n| `fields` | `VARCHAR` | Comma-separarated list of fields to search in, e.g., `'text_field_2, text_field_N'`. Defaults to `NULL` to search all indexed fields |\n| `k` | `DOUBLE` | Parameter _k1_ in the Okapi BM25 retrieval model. Defaults to `1.2` |\n| `b` | `DOUBLE` | Parameter _b_ in the Okapi BM25 retrieval model. Defaults to `0.75` |\n| `conjunctive` | `BOOLEAN` | Whether to make the query conjunctive i.e., all terms in the query string must be present in order for a document to be retrieved |", "position": 11, "token_count": 254, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-011", "document_id": "core_extensions-full_text_search", "position": 11, "token_count": 254, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-012", "document_id": "core_extensions-full_text_search", "content": "### `stem` Function\n\n```python\nstem(input_string, stemmer)", "position": 12, "token_count": 22, "has_code": true, "section_hierarchy": ["`stem` Function"], "metadata": {"chunk_id": "core_extensions-full_text_search-012", "document_id": "core_extensions-full_text_search", "position": 12, "token_count": 22, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`stem` Function"], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search#stem-function"}}
{"chunk_id": "core_extensions-full_text_search-013", "document_id": "core_extensions-full_text_search", "content": "```\n\nReduces words to their base. Used internally by the extension.", "position": 13, "token_count": 17, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-013", "document_id": "core_extensions-full_text_search", "position": 13, "token_count": 17, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-014", "document_id": "core_extensions-full_text_search", "content": "| Name | Type | Description |\n|:--|:--|:----------|\n| `input_string` | `VARCHAR` | The column or constant to be stemmed. |\n| `stemmer` | `VARCHAR` | The type of stemmer to be used. One of `'arabic'`, `'basque'`, `'catalan'`, `'danish'`, `'dutch'`, `'english'`, `'finnish'`, `'french'`, `'german'`, `'greek'`, `'hindi'`, `'hungarian'`, `'indonesian'`, `'irish'`, `'italian'`, `'lithuanian'`, `'nepali'`, `'norwegian'`, `'porter'`, `'portuguese'`, `'romanian'`, `'russian'`, `'serbian'`, `'spanish'`, `'swedish'`, `'tamil'`, `'turkish'`, or `'none'` if no stemming is to be used. |", "position": 14, "token_count": 252, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-014", "document_id": "core_extensions-full_text_search", "position": 14, "token_count": 252, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-015", "document_id": "core_extensions-full_text_search", "content": "## Example Usage\n\nCreate a table and fill it with text data:\n\n```sql\nCREATE TABLE documents (\n document_identifier VARCHAR,\n text_content VARCHAR,\n author VARCHAR,\n doc_version INTEGER\n);\nINSERT INTO documents\n VALUES ('doc1',\n 'The mallard is a dabbling duck that breeds throughout the temperate.',\n 'Hannes Mühleisen',\n 3),\n ('doc2',\n 'The cat is a domestic species of small carnivorous mammal.',\n 'Laurens Kuiper',\n 2\n );\n```\n\nBuild the index, and make both the `text_content` and `author` columns searchable.\n\n```sql\nPRAGMA create_fts_index(\n 'documents', 'document_identifier', 'text_content', 'author'\n);", "position": 15, "token_count": 183, "has_code": true, "section_hierarchy": ["Example Usage"], "metadata": {"chunk_id": "core_extensions-full_text_search-015", "document_id": "core_extensions-full_text_search", "position": 15, "token_count": 183, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Example Usage"], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search#example-usage"}}
{"chunk_id": "core_extensions-full_text_search-016", "document_id": "core_extensions-full_text_search", "content": "```\n\nSearch the `author` field index for documents that are authored by `Muhleisen`. This retrieves `doc1`:\n\n```sql\nSELECT document_identifier, text_content, score\nFROM (\n SELECT *, fts_main_documents.match_bm25(\n document_identifier,\n 'Muhleisen',\n fields := 'author'\n ) AS score\n FROM documents\n) sq\nWHERE score IS NOT NULL\n AND doc_version > 2\nORDER BY score DESC;", "position": 16, "token_count": 110, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-016", "document_id": "core_extensions-full_text_search", "position": 16, "token_count": 110, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-017", "document_id": "core_extensions-full_text_search", "content": "```\n\n| document_identifier | text_content | score |\n|---------------------|----------------------------------------------------------------------|------:|\n| doc1 | The mallard is a dabbling duck that breeds throughout the temperate. | 0.0 |\n\nSearch for documents about `small cats`. This retrieves `doc2`:\n\n```sql\nSELECT document_identifier, text_content, score\nFROM (\n SELECT *, fts_main_documents.match_bm25(\n document_identifier,\n 'small cats'\n ) AS score\n FROM documents\n) sq\nWHERE score IS NOT NULL\nORDER BY score DESC;", "position": 17, "token_count": 222, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-017", "document_id": "core_extensions-full_text_search", "position": 17, "token_count": 222, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}
{"chunk_id": "core_extensions-full_text_search-018", "document_id": "core_extensions-full_text_search", "content": "```\n\n| document_identifier | text_content | score |\n|---------------------|------------------------------------------------------------|------:|\n| doc2 | The cat is a domestic species of small carnivorous mammal. | 0.0 |\n\n> Warning The FTS index will not update automatically when input table changes.\n> A workaround of this limitation can be recreating the index to refresh.", "position": 18, "token_count": 164, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-full_text_search-018", "document_id": "core_extensions-full_text_search", "position": 18, "token_count": 164, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/full_text_search.md", "url": "/core_extensions/full_text_search", "title": "Full-Text Search Extension", "category": null, "tags": [], "section_url": "/core_extensions/full_text_search"}}

{"chunk_id": "core_extensions-aws-000", "document_id": "core_extensions-aws", "content": "The `aws` extension adds functionality (e.g., authentication) on top of the `httpfs` extension's [S3 capabilities]({% link docs/stable/core_extensions/httpfs/overview.md %}#s3-api), using the AWS SDK.\n\n## Installing and Loading\n\nThe `aws` extension will be transparently [autoloaded]({% link docs/stable/core_extensions/overview.md %}#autoloading-extensions) on first use from the official extension repository.\nIf you would like to install and load it manually, run:\n\n```sql\nINSTALL aws;\nLOAD aws;\n```\n\n> In most cases, the `aws` extension works in conjunction with the [`httpfs` extension]({% link docs/stable/core_extensions/httpfs/overview.md %}).", "position": 0, "token_count": 195, "has_code": true, "section_hierarchy": ["Installing and Loading"], "metadata": {"chunk_id": "core_extensions-aws-000", "document_id": "core_extensions-aws", "position": 0, "token_count": 195, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Installing and Loading"], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws#installing-and-loading"}}
{"chunk_id": "core_extensions-aws-001", "document_id": "core_extensions-aws", "content": "## Configuration and Authentication\n\nThe preferred way to configure and authenticate to AWS S3 endpoints is to use [secrets]({% link docs/stable/sql/statements/create_secret.md %}).", "position": 1, "token_count": 53, "has_code": false, "section_hierarchy": ["Configuration and Authentication"], "metadata": {"chunk_id": "core_extensions-aws-001", "document_id": "core_extensions-aws", "position": 1, "token_count": 53, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Configuration and Authentication"], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws#configuration-and-authentication"}}
{"chunk_id": "core_extensions-aws-002", "document_id": "core_extensions-aws", "content": "### `config` Provider\n\nThe default provider, `config` (i.e., user-configured), allows access to the S3 bucket by manually providing a key. For example:\n\n```sql\nCREATE OR REPLACE SECRET secret (\n TYPE s3,\n PROVIDER config,\n KEY_ID '⟨AKIAIOSFODNN7EXAMPLE⟩',\n SECRET '⟨wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY⟩',\n REGION '⟨us-east-1⟩'\n);\n```\n\n> Tip If you get an IO Error (`Connection error for HTTP HEAD`), configure the endpoint explicitly via `ENDPOINT 's3.⟨your-region⟩.amazonaws.com'`{:.language-sql .highlight}.\n\nNow, to query using the above secret, simply query any `s3://` prefixed file:\n\n```sql\nSELECT *\nFROM 's3://⟨your-bucket⟩/⟨your_file⟩.parquet';\n```", "position": 2, "token_count": 239, "has_code": true, "section_hierarchy": ["`config` Provider"], "metadata": {"chunk_id": "core_extensions-aws-002", "document_id": "core_extensions-aws", "position": 2, "token_count": 239, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`config` Provider"], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws#config-provider"}}
{"chunk_id": "core_extensions-aws-003", "document_id": "core_extensions-aws", "content": "### `credential_chain` Provider\n\nThe `credential_chain` provider allows automatically fetching credentials using mechanisms provided by the AWS SDK. For example, to use the AWS SDK default provider:\n\n```sql\nCREATE OR REPLACE SECRET secret (\n TYPE s3,\n PROVIDER credential_chain\n);\n```\n\nAgain, to query a file using the above secret, simply query any `s3://` prefixed file.\n\nDuckDB also allows specifying a specific chain using the `CHAIN` keyword. This takes a semicolon-separated list (`a;b;c`) of providers that will be tried in order. For example:\n\n```sql\nCREATE OR REPLACE SECRET secret (\n TYPE s3,\n PROVIDER credential_chain,\n CHAIN 'env;config'\n);", "position": 3, "token_count": 179, "has_code": true, "section_hierarchy": ["`credential_chain` Provider"], "metadata": {"chunk_id": "core_extensions-aws-003", "document_id": "core_extensions-aws", "position": 3, "token_count": 179, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`credential_chain` Provider"], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws#credentialchain-provider"}}
{"chunk_id": "core_extensions-aws-004", "document_id": "core_extensions-aws", "content": "```\n\nThe possible values for `CHAIN` are the following:", "position": 4, "token_count": 16, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-aws-004", "document_id": "core_extensions-aws", "position": 4, "token_count": 16, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws"}}
{"chunk_id": "core_extensions-aws-005", "document_id": "core_extensions-aws", "content": "* [`config`](https://sdk.amazonaws.com/cpp/api/LATEST/aws-cpp-sdk-core/html/class_aws_1_1_auth_1_1_profile_config_file_a_w_s_credentials_provider.html)\n* [`sts`](https://sdk.amazonaws.com/cpp/api/LATEST/aws-cpp-sdk-core/html/class_aws_1_1_auth_1_1_s_t_s_assume_role_web_identity_credentials_provider.html)\n* [`sso`](https://aws.amazon.com/what-is/sso/)", "position": 5, "token_count": 183, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-aws-005", "document_id": "core_extensions-aws", "position": 5, "token_count": 183, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws"}}
{"chunk_id": "core_extensions-aws-006", "document_id": "core_extensions-aws", "content": "* [`sso`](https://aws.amazon.com/what-is/sso/)\n* [`env`](https://sdk.amazonaws.com/cpp/api/LATEST/aws-cpp-sdk-core/html/class_aws_1_1_auth_1_1_environment_a_w_s_credentials_provider.html)\n* [`instance`](https://sdk.amazonaws.com/cpp/api/LATEST/aws-cpp-sdk-core/html/class_aws_1_1_auth_1_1_instance_profile_credentials_provider.html)\n* [`process`](https://sdk.amazonaws.com/cpp/api/LATEST/aws-cpp-sdk-core/html/class_aws_1_1_auth_1_1_process_credentials_provider.html)", "position": 6, "token_count": 230, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-aws-006", "document_id": "core_extensions-aws", "position": 6, "token_count": 230, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws"}}
{"chunk_id": "core_extensions-aws-007", "document_id": "core_extensions-aws", "content": "The `credential_chain` provider also allows overriding the automatically fetched config. For example, to automatically load credentials, and then override the region, run:\n\n```sql\nCREATE OR REPLACE SECRET secret (\n TYPE s3,\n PROVIDER credential_chain,\n CHAIN config,\n REGION '⟨eu-west-1⟩'\n);", "position": 7, "token_count": 78, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-aws-007", "document_id": "core_extensions-aws", "position": 7, "token_count": 78, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws"}}
{"chunk_id": "core_extensions-aws-008", "document_id": "core_extensions-aws", "content": "```", "position": 8, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-aws-008", "document_id": "core_extensions-aws", "position": 8, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws"}}
{"chunk_id": "core_extensions-aws-009", "document_id": "core_extensions-aws", "content": "### Validation\n\nSince v1.4.0, the AWS `credential_chain` provider will look for any required credentials during `CREATE SECRET` time, failing if absent/unavailable.\n\nSince v1.4.1 this behavior may be configured via the `VALIDATION` option as follows:\n\n```sql\nCREATE OR REPLACE SECRET secret (\n TYPE s3,\n PROVIDER credential_chain,\n VALIDATION 'exists'\n);\n```\n\nTwo validation modes are supported:\n\n* `exists` (default) requires present credentials.\n* `none` allows `CREATE SECRET` to succeed for `credential_chains` with no available credentials.\n\n> `VALIDATION 'exists'` validates only the __presence__ of a credential, __not its operational readiness__. Thus, no attempt is made to\n> convert into an access token, or perform a read, write, etc.\n\n### Auto-Refresh\n\nSome AWS endpoints require periodic refreshing of the credentials.\nThis can be specified with the `REFRESH auto` option:\n\n```sql\nCREATE SECRET env_test (\n TYPE s3,\n PROVIDER credential_chain,\n REFRESH auto\n);\n```", "position": 9, "token_count": 252, "has_code": true, "section_hierarchy": ["Auto-Refresh"], "metadata": {"chunk_id": "core_extensions-aws-009", "document_id": "core_extensions-aws", "position": 9, "token_count": 252, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Auto-Refresh"], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws#auto-refresh"}}
{"chunk_id": "core_extensions-aws-010", "document_id": "core_extensions-aws", "content": "## Legacy Features\n\n> Deprecated The `load_aws_credentials` function is deprecated.\n\nPrior to version 0.10.0, DuckDB did not have a [Secrets manager]({% link docs/stable/sql/statements/create_secret.md %}), to load the credentials automatically, the AWS extension provided\na special function to load the AWS credentials in the [legacy authentication method]({% link docs/stable/core_extensions/httpfs/s3api_legacy_authentication.md %}).\n\n| Function | Type | Description |\n|---|---|-------|\n| `load_aws_credentials` | `PRAGMA` function | Loads the AWS credentials through the [AWS Default Credentials Provider Chain](https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/credentials-chain.html) |", "position": 10, "token_count": 214, "has_code": false, "section_hierarchy": ["Legacy Features"], "metadata": {"chunk_id": "core_extensions-aws-010", "document_id": "core_extensions-aws", "position": 10, "token_count": 214, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Legacy Features"], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws#legacy-features"}}
{"chunk_id": "core_extensions-aws-011", "document_id": "core_extensions-aws", "content": "### Load AWS Credentials (Legacy)\n\nTo load the AWS credentials, run:\n\n```sql\nCALL load_aws_credentials();\n```\n\n| loaded_access_key_id | loaded_secret_access_key | loaded_session_token | loaded_region |\n|----------------------|--------------------------|----------------------|---------------|\n| AKIAIOSFODNN7EXAMPLE | `` | NULL | us-east-2 |\n\nThe function takes a string parameter to specify a specific profile:\n\n```sql\nCALL load_aws_credentials('minio-testing-2');", "position": 11, "token_count": 212, "has_code": true, "section_hierarchy": ["Load AWS Credentials (Legacy)"], "metadata": {"chunk_id": "core_extensions-aws-011", "document_id": "core_extensions-aws", "position": 11, "token_count": 212, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Load AWS Credentials (Legacy)"], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws#load-aws-credentials-legacy"}}
{"chunk_id": "core_extensions-aws-012", "document_id": "core_extensions-aws", "content": "```\n\n| loaded_access_key_id | loaded_secret_access_key | loaded_session_token | loaded_region |\n|----------------------|--------------------------|----------------------|---------------|\n| minio_duckdb_user_2 | `` | NULL | NULL |\n\nThere are several parameters to tweak the behavior of the call:\n\n```sql\nCALL load_aws_credentials('minio-testing-2', set_region = false, redact_secret = false);", "position": 12, "token_count": 189, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-aws-012", "document_id": "core_extensions-aws", "position": 12, "token_count": 189, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws"}}
{"chunk_id": "core_extensions-aws-013", "document_id": "core_extensions-aws", "content": "```\n\n| loaded_access_key_id | loaded_secret_access_key | loaded_session_token | loaded_region |\n|----------------------|------------------------------|----------------------|---------------|\n| minio_duckdb_user_2 | minio_duckdb_user_password_2 | NULL | NULL |", "position": 13, "token_count": 153, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-aws-013", "document_id": "core_extensions-aws", "position": 13, "token_count": 153, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/aws.md", "url": "/core_extensions/aws", "title": "AWS Extension", "category": null, "tags": [], "section_url": "/core_extensions/aws"}}

{"chunk_id": "guides-file_formats-excel_import-000", "document_id": "guides-file_formats-excel_import", "content": "DuckDB supports reading Excel `.xlsx` files, however, `.xls` files are not supported.\n\n## Importing Excel Sheets\n\nUse the `read_xlsx` function in the `FROM` clause of a query:\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx');\n```\n\nAlternatively, you can omit the `read_xlsx` function and let DuckDB infer it from the extension:\n\n```sql\nSELECT * FROM 'test_excel.xlsx';\n```\n\nHowever, if you want to be able to pass options to control the import behavior, you should use the `read_xlsx` function.\n\nOne such option is the `sheet` parameter, which allows specifying the name of the Excel worksheet:\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx', sheet = 'Sheet1');\n```\n\nBy default, the first sheet is loaded if no sheet is specified.", "position": 0, "token_count": 227, "has_code": true, "section_hierarchy": ["Importing Excel Sheets"], "metadata": {"chunk_id": "guides-file_formats-excel_import-000", "document_id": "guides-file_formats-excel_import", "position": 0, "token_count": 227, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Importing Excel Sheets"], "file_path": "guides/file_formats/excel_import.md", "url": "/guides/file_formats/excel_import", "title": "Excel Import", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_import#importing-excel-sheets"}}
{"chunk_id": "guides-file_formats-excel_import-001", "document_id": "guides-file_formats-excel_import", "content": "## Importing a Specific Range\n\nTo select a specific range of cells, use the `range` parameter with a string in the format `A1:B2`, where `A1` is the top-left cell and `B2` is the bottom-right cell:\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx', range = 'A1:B2');\n```\n\nThis can also be used to, e.g., skip the first 5 of rows:\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx', range = 'A5:Z');\n```\n\nOr skip the first 5 columns\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx', range = 'E:Z');", "position": 1, "token_count": 187, "has_code": true, "section_hierarchy": ["Importing a Specific Range"], "metadata": {"chunk_id": "guides-file_formats-excel_import-001", "document_id": "guides-file_formats-excel_import", "position": 1, "token_count": 187, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Importing a Specific Range"], "file_path": "guides/file_formats/excel_import.md", "url": "/guides/file_formats/excel_import", "title": "Excel Import", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_import#importing-a-specific-range"}}
{"chunk_id": "guides-file_formats-excel_import-002", "document_id": "guides-file_formats-excel_import", "content": "```\n\nOr skip the first 5 columns\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx', range = 'E:Z');\n```\n\nIf no range parameter is provided, the range is automatically inferred as the rectangular region of cells between the first row of consecutive non-empty cells and the first empty row spanning the same columns.\n\nBy default, if no range is provided DuckDB will stop reading the Excel file at when encountering an empty row. But when a range is provided, the default is to read until the end of the range. This behavior can be controlled with the `stop_at_empty` parameter:\n\n```sql\n-- Read the first 100 rows, or until the first empty row, whichever comes first\nSELECT * FROM read_xlsx('test_excel.xlsx', range = '1:100', stop_at_empty = true);\n\n-- Always read the whole sheet, even if it contains empty rows\nSELECT * FROM read_xlsx('test_excel.xlsx', stop_at_empty = false);\n```", "position": 2, "token_count": 248, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-file_formats-excel_import-002", "document_id": "guides-file_formats-excel_import", "position": 2, "token_count": 248, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/file_formats/excel_import.md", "url": "/guides/file_formats/excel_import", "title": "Excel Import", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_import"}}
{"chunk_id": "guides-file_formats-excel_import-003", "document_id": "guides-file_formats-excel_import", "content": "## Creating a New Table\n\nTo create a new table using the result from a query, use `CREATE TABLE ... AS` from a `SELECT` statement:\n\n```sql\nCREATE TABLE new_tbl AS\n SELECT * FROM read_xlsx('test_excel.xlsx', sheet = 'Sheet1');\n```\n\n## Loading to an Existing Table\n\nTo load data into an existing table from a query, use `INSERT INTO` from a `SELECT` statement:\n\n```sql\nINSERT INTO tbl\n SELECT * FROM read_xlsx('test_excel.xlsx', sheet = 'Sheet1');\n```\n\nAlternatively, you can use the `COPY` statement with the `XLSX` format option to import an Excel file into an existing table:\n\n```sql\nCOPY tbl FROM 'test_excel.xlsx' (FORMAT xlsx, SHEET 'Sheet1');\n```\n\nWhen using the `COPY` statement to load an Excel file into an existing table, the types of the columns in the target table will be used to coerce the types of the cells in the Excel sheet.", "position": 3, "token_count": 249, "has_code": true, "section_hierarchy": ["Loading to an Existing Table"], "metadata": {"chunk_id": "guides-file_formats-excel_import-003", "document_id": "guides-file_formats-excel_import", "position": 3, "token_count": 249, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Loading to an Existing Table"], "file_path": "guides/file_formats/excel_import.md", "url": "/guides/file_formats/excel_import", "title": "Excel Import", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_import#loading-to-an-existing-table"}}
{"chunk_id": "guides-file_formats-excel_import-004", "document_id": "guides-file_formats-excel_import", "content": "## Importing a Sheet with/without a Header\n\nTo treat the first row as containing the names of the resulting columns, use the `header` parameter:\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx', header = true);\n```\n\nBy default, the first row is treated as a header if all the cells in the first row (within the inferred or supplied range) are non-empty strings. To disable this behavior, set `header` to `false`.", "position": 4, "token_count": 115, "has_code": true, "section_hierarchy": ["Importing a Sheet with/without a Header"], "metadata": {"chunk_id": "guides-file_formats-excel_import-004", "document_id": "guides-file_formats-excel_import", "position": 4, "token_count": 115, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Importing a Sheet with/without a Header"], "file_path": "guides/file_formats/excel_import.md", "url": "/guides/file_formats/excel_import", "title": "Excel Import", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_import#importing-a-sheet-withwithout-a-header"}}
{"chunk_id": "guides-file_formats-excel_import-005", "document_id": "guides-file_formats-excel_import", "content": "## Detecting Types\n\nWhen not importing into an existing table, DuckDB will attempt to infer the types of the columns in the Excel sheet based on their contents and/or \"number format\".\n\n- `TIMESTAMP`, `TIME`, `DATE` and `BOOLEAN` types are inferred when possible based on the \"number format\" applied to the cell.\n- Text cells containing `TRUE` and `FALSE` are inferred as `BOOLEAN`.\n- Empty cells are considered to be of type `DOUBLE` by default.\n- Otherwise cells are inferred as `VARCHAR` or `DOUBLE` based on their contents.\n\nThis behavior can be adjusted in the following ways.\n\nTo treat all empty cells as `VARCHAR` instead of `DOUBLE`, set `empty_as_varchar` to `true`:\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx', empty_as_varchar = true);", "position": 5, "token_count": 215, "has_code": true, "section_hierarchy": ["Detecting Types"], "metadata": {"chunk_id": "guides-file_formats-excel_import-005", "document_id": "guides-file_formats-excel_import", "position": 5, "token_count": 215, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Detecting Types"], "file_path": "guides/file_formats/excel_import.md", "url": "/guides/file_formats/excel_import", "title": "Excel Import", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_import#detecting-types"}}
{"chunk_id": "guides-file_formats-excel_import-006", "document_id": "guides-file_formats-excel_import", "content": "```\n\nTo disable type inference completely and treat all cells as `VARCHAR`, set `all_varchar` to `true`:\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx', all_varchar = true);\n```\n\nAdditionally, if the `ignore_errors` parameter is set to `true`, DuckDB will silently replace cells that can't be cast to the corresponding inferred column type with `NULL`'s.\n\n```sql\nSELECT * FROM read_xlsx('test_excel.xlsx', ignore_errors = true);\n```", "position": 6, "token_count": 147, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-file_formats-excel_import-006", "document_id": "guides-file_formats-excel_import", "position": 6, "token_count": 147, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/file_formats/excel_import.md", "url": "/guides/file_formats/excel_import", "title": "Excel Import", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_import"}}
{"chunk_id": "guides-file_formats-excel_import-007", "document_id": "guides-file_formats-excel_import", "content": "## See Also\n\nDuckDB can also [export Excel files]({% link docs/stable/guides/file_formats/excel_export.md %}).\nFor additional details on Excel support, see the [excel extension page]({% link docs/stable/core_extensions/excel.md %}).", "position": 7, "token_count": 73, "has_code": false, "section_hierarchy": ["See Also"], "metadata": {"chunk_id": "guides-file_formats-excel_import-007", "document_id": "guides-file_formats-excel_import", "position": 7, "token_count": 73, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["See Also"], "file_path": "guides/file_formats/excel_import.md", "url": "/guides/file_formats/excel_import", "title": "Excel Import", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_import#see-also"}}

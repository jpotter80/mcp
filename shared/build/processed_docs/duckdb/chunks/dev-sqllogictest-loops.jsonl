{"chunk_id": "dev-sqllogictest-loops-000", "document_id": "dev-sqllogictest-loops", "content": "Loops can be used in sqllogictests when it is required to execute the same query many times but with slight modifications in constant values. For example, suppose we want to fire off 100 queries that check for the presence of the values `0..100` in a table:\n\n```sql\n# create the table 'integers' with values 0..100\nstatement ok\nCREATE TABLE integers AS SELECT * FROM range(0, 100, 1) t1(i);\n\n# verify individually that all 100 values are there\nloop i 0 100\n\n# execute the query, replacing the value\nquery I\nSELECT count(*) FROM integers WHERE i = ${i};\n----\n1", "position": 0, "token_count": 143, "has_code": true, "section_hierarchy": ["execute the query, replacing the value"], "metadata": {"chunk_id": "dev-sqllogictest-loops-000", "document_id": "dev-sqllogictest-loops", "position": 0, "token_count": 143, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["execute the query, replacing the value"], "file_path": "dev/sqllogictest/loops.md", "url": "/dev/sqllogictest/loops", "title": "Loops", "category": null, "tags": [], "section_url": "/dev/sqllogictest/loops#execute-the-query-replacing-the-value"}}
{"chunk_id": "dev-sqllogictest-loops-001", "document_id": "dev-sqllogictest-loops", "content": "# end the loop (note that multiple statements can be part of a loop)\nendloop\n```\n\nSimilarly, `foreach` can be used to iterate over a set of values.\n\n```sql\nforeach partcode millennium century decade year quarter month day hour minute second millisecond microsecond epoch\n\nquery III\nSELECT i, date_part('${partcode}', i) AS p, date_part(['${partcode}'], i) AS st\nFROM intervals\nWHERE p <> st['${partcode}'];\n----\n\nendloop", "position": 1, "token_count": 133, "has_code": true, "section_hierarchy": ["end the loop (note that multiple statements can be part of a loop)"], "metadata": {"chunk_id": "dev-sqllogictest-loops-001", "document_id": "dev-sqllogictest-loops", "position": 1, "token_count": 133, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["end the loop (note that multiple statements can be part of a loop)"], "file_path": "dev/sqllogictest/loops.md", "url": "/dev/sqllogictest/loops", "title": "Loops", "category": null, "tags": [], "section_url": "/dev/sqllogictest/loops#end-the-loop-note-that-multiple-statements-can-be-part-of-a-loop"}}
{"chunk_id": "dev-sqllogictest-loops-002", "document_id": "dev-sqllogictest-loops", "content": "```\n\n`foreach` also has a number of preset combinations that should be used when required. In this manner, when new combinations are added to the preset, old tests will automatically pick up these new combinations.\n\n| Preset | Expansion |\n|----------------|--------------------------------------------------------------|\n| ⟨compression⟩ | none uncompressed rle bitpacking dictionary fsst chimp patas |\n| ⟨signed⟩ | tinyint smallint integer bigint hugeint |\n| ⟨unsigned⟩ | utinyint usmallint uinteger ubigint uhugeint |\n| ⟨integral⟩ | ⟨signed⟩ ⟨unsigned⟩ |\n| ⟨numeric⟩ | ⟨integral⟩ float double |\n| ⟨alltypes⟩ | ⟨numeric⟩ bool interval varchar json |", "position": 2, "token_count": 240, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "dev-sqllogictest-loops-002", "document_id": "dev-sqllogictest-loops", "position": 2, "token_count": 240, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "dev/sqllogictest/loops.md", "url": "/dev/sqllogictest/loops", "title": "Loops", "category": null, "tags": [], "section_url": "/dev/sqllogictest/loops"}}
{"chunk_id": "dev-sqllogictest-loops-003", "document_id": "dev-sqllogictest-loops", "content": "> Use large loops sparingly. Executing hundreds of thousands of SQL statements will slow down tests unnecessarily. Do not use loops for inserting data.", "position": 3, "token_count": 36, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "dev-sqllogictest-loops-003", "document_id": "dev-sqllogictest-loops", "position": 3, "token_count": 36, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "dev/sqllogictest/loops.md", "url": "/dev/sqllogictest/loops", "title": "Loops", "category": null, "tags": [], "section_url": "/dev/sqllogictest/loops"}}
{"chunk_id": "dev-sqllogictest-loops-004", "document_id": "dev-sqllogictest-loops", "content": "## Data Generation without Loops\n\nLoops should be used sparingly. While it might be tempting to use loops for inserting data using insert statements, this will considerably slow down the test cases. Instead, it is better to generate data using the built-in `range` and `repeat` functions.\n\nTo create the table `integers` with the values `[0, 1, ..., 98, 99]`, run:\n\n```sql\nCREATE TABLE integers AS SELECT * FROM range(0, 100, 1) t1(i);\n```\n\nTo create the table `strings` with 100 times the value `hello`, run:\n\n```sql\nCREATE TABLE strings AS SELECT * FROM repeat('hello', 100) t1(s);", "position": 4, "token_count": 162, "has_code": true, "section_hierarchy": ["Data Generation without Loops"], "metadata": {"chunk_id": "dev-sqllogictest-loops-004", "document_id": "dev-sqllogictest-loops", "position": 4, "token_count": 162, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Data Generation without Loops"], "file_path": "dev/sqllogictest/loops.md", "url": "/dev/sqllogictest/loops", "title": "Loops", "category": null, "tags": [], "section_url": "/dev/sqllogictest/loops#data-generation-without-loops"}}
{"chunk_id": "dev-sqllogictest-loops-005", "document_id": "dev-sqllogictest-loops", "content": "```\n\nTo create the table `strings` with 100 times the value `hello`, run:\n\n```sql\nCREATE TABLE strings AS SELECT * FROM repeat('hello', 100) t1(s);\n```\n\nUsing these two functions, together with clever use of cross products and other expressions, many different types of datasets can be efficiently generated. The `random()` function can also be used to generate random data.\n\nAn alternative option is to read data from an existing CSV or Parquet file. There are several large CSV files that can be loaded from the directory `test/sql/copy/csv/data/real` using a `COPY INTO` statement or the `read_csv_auto` function.\n\nThe TPC-H and TPC-DS extensions can also be used to generate synthetic data, using e.g. `CALL dbgen(sf = 1)` or `CALL dsdgen(sf = 1)`.", "position": 5, "token_count": 207, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "dev-sqllogictest-loops-005", "document_id": "dev-sqllogictest-loops", "position": 5, "token_count": 207, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "dev/sqllogictest/loops.md", "url": "/dev/sqllogictest/loops", "title": "Loops", "category": null, "tags": [], "section_url": "/dev/sqllogictest/loops"}}

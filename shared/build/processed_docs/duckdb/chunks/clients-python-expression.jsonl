{"chunk_id": "clients-python-expression-000", "document_id": "clients-python-expression", "content": "The `Expression` class represents an instance of an [expression]({% link docs/stable/sql/expressions/overview.md %}).\n\n## Why Would I Use the Expression API?\n\nUsing this API makes it possible to dynamically build up expressions, which are typically created by the parser from the query string.\nThis allows you to skip that and have more fine-grained control over the used expressions.\n\nBelow is a list of currently supported expressions that can be created through the API.", "position": 0, "token_count": 106, "has_code": false, "section_hierarchy": ["Why Would I Use the Expression API?"], "metadata": {"chunk_id": "clients-python-expression-000", "document_id": "clients-python-expression", "position": 0, "token_count": 106, "has_code": false, "overlap_with_previous": false, "section_hierarchy": ["Why Would I Use the Expression API?"], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression#why-would-i-use-the-expression-api"}}
{"chunk_id": "clients-python-expression-001", "document_id": "clients-python-expression", "content": "## Column Expression\n\nThis expression references a column by name.\n\n```python\nimport duckdb\nimport pandas as pd\n\ndf = pd.DataFrame({\n 'a': [1, 2, 3, 4],\n 'b': [True, None, False, True],\n 'c': [42, 21, 13, 14]\n})\n```\n\nSelecting a single column:\n\n```python\ncol = duckdb.ColumnExpression('a')\nduckdb.df(df).select(col).show()\n```\n\n```text\n┌───────┐\n│ a │\n│ int64 │\n├───────┤\n│ 1 │\n│ 2 │\n│ 3 │\n│ 4 │\n└───────┘\n```\n\nSelecting multiple columns:\n\n```python\ncol_list = [\n duckdb.ColumnExpression('a') * 10,\n duckdb.ColumnExpression('b').isnull(),\n duckdb.ColumnExpression('c') + 5\n ]\nduckdb.df(df).select(*col_list).show()", "position": 1, "token_count": 236, "has_code": true, "section_hierarchy": ["Column Expression"], "metadata": {"chunk_id": "clients-python-expression-001", "document_id": "clients-python-expression", "position": 1, "token_count": 236, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Column Expression"], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression#column-expression"}}
{"chunk_id": "clients-python-expression-002", "document_id": "clients-python-expression", "content": "```\n\n```text\n┌──────────┬─────────────┬─────────┐\n│ (a * 10) │ (b IS NULL) │ (c + 5) │\n│ int64 │ boolean │ int64 │\n├──────────┼─────────────┼─────────┤\n│ 10 │ false │ 47 │\n│ 20 │ true │ 26 │\n│ 30 │ false │ 18 │\n│ 40 │ false │ 19 │\n└──────────┴─────────────┴─────────┘\n```", "position": 2, "token_count": 72, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-expression-002", "document_id": "clients-python-expression", "position": 2, "token_count": 72, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression"}}
{"chunk_id": "clients-python-expression-003", "document_id": "clients-python-expression", "content": "## Star Expression\n\nThis expression selects all columns of the input source.\n\nOptionally it's possible to provide an `exclude` list to filter out columns of the table.\nThis `exclude` list can contain either strings or Expressions.\n\n```python\nimport duckdb\nimport pandas as pd\n\ndf = pd.DataFrame({\n 'a': [1, 2, 3, 4],\n 'b': [True, None, False, True],\n 'c': [42, 21, 13, 14]\n})\n\nstar = duckdb.StarExpression(exclude = ['b'])\nduckdb.df(df).select(star).show()\n```\n\n```text\n┌───────┬───────┐\n│ a │ c │\n│ int64 │ int64 │\n├───────┼───────┤\n│ 1 │ 42 │\n│ 2 │ 21 │\n│ 3 │ 13 │\n│ 4 │ 14 │\n└───────┴───────┘\n```", "position": 3, "token_count": 194, "has_code": true, "section_hierarchy": ["Star Expression"], "metadata": {"chunk_id": "clients-python-expression-003", "document_id": "clients-python-expression", "position": 3, "token_count": 194, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Star Expression"], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression#star-expression"}}
{"chunk_id": "clients-python-expression-004", "document_id": "clients-python-expression", "content": "## Constant Expression\n\nThis expression contains a single value.\n\n```python\nimport duckdb\nimport pandas as pd\n\ndf = pd.DataFrame({\n 'a': [1, 2, 3, 4],\n 'b': [True, None, False, True],\n 'c': [42, 21, 13, 14]\n})\n\nconst = duckdb.ConstantExpression('hello')\nduckdb.df(df).select(const).show()\n```\n\n```text\n┌─────────┐\n│ 'hello' │\n│ varchar │\n├─────────┤\n│ hello │\n│ hello │\n│ hello │\n│ hello │\n└─────────┘\n```", "position": 4, "token_count": 146, "has_code": true, "section_hierarchy": ["Constant Expression"], "metadata": {"chunk_id": "clients-python-expression-004", "document_id": "clients-python-expression", "position": 4, "token_count": 146, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Constant Expression"], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression#constant-expression"}}
{"chunk_id": "clients-python-expression-005", "document_id": "clients-python-expression", "content": "## Case Expression\n\nThis expression contains a `CASE WHEN (...) THEN (...) ELSE (...) END` expression.\nBy default `ELSE` is `NULL` and it can be set using `.else(value = ...)`.\nAdditional `WHEN (...) THEN (...)` blocks can be added with `.when(condition = ..., value = ...)`.\n\n```python\nimport duckdb\nimport pandas as pd\nfrom duckdb import (\n ConstantExpression,\n ColumnExpression,\n CaseExpression\n)\n\ndf = pd.DataFrame({\n 'a': [1, 2, 3, 4],\n 'b': [True, None, False, True],\n 'c': [42, 21, 13, 14]\n})\n\nhello = ConstantExpression('hello')\nworld = ConstantExpression('world')", "position": 5, "token_count": 205, "has_code": true, "section_hierarchy": ["Case Expression"], "metadata": {"chunk_id": "clients-python-expression-005", "document_id": "clients-python-expression", "position": 5, "token_count": 205, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Case Expression"], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression#case-expression"}}
{"chunk_id": "clients-python-expression-006", "document_id": "clients-python-expression", "content": "hello = ConstantExpression('hello')\nworld = ConstantExpression('world')\n\ncase = \\\n CaseExpression(condition = ColumnExpression('b') == False, value = world) \\\n .otherwise(hello)\nduckdb.df(df).select(case).show()", "position": 6, "token_count": 75, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-expression-006", "document_id": "clients-python-expression", "position": 6, "token_count": 75, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression"}}
{"chunk_id": "clients-python-expression-007", "document_id": "clients-python-expression", "content": "```\n\n```text\n┌──────────────────────────────────────────────────────────┐\n│ CASE WHEN ((b = false)) THEN ('world') ELSE 'hello' END │\n│ varchar │\n├──────────────────────────────────────────────────────────┤\n│ hello │\n│ hello │\n│ world │\n│ hello │\n└──────────────────────────────────────────────────────────┘\n```", "position": 7, "token_count": 54, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-expression-007", "document_id": "clients-python-expression", "position": 7, "token_count": 54, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression"}}
{"chunk_id": "clients-python-expression-008", "document_id": "clients-python-expression", "content": "## Function Expression\n\nThis expression contains a function call.\nIt can be constructed by providing the function name and an arbitrary amount of Expressions as arguments.\n\n```python\nimport duckdb\nimport pandas as pd\nfrom duckdb import (\n ConstantExpression,\n ColumnExpression,\n FunctionExpression\n)\n\ndf = pd.DataFrame({\n 'a': [1, 2, 3, 4],\n 'b': [True, None, False, True],\n 'c': [42, 21, 13, 14]\n})\n\nmultiply_by_2 = FunctionExpression('multiply', ColumnExpression('a'), ConstantExpression(2))\nduckdb.df(df).select(multiply_by_2).show()\n```\n\n```text\n┌────────────────┐\n│ multiply(a, 2) │\n│ int64 │\n├────────────────┤\n│ 2 │\n│ 4 │\n│ 6 │\n│ 8 │\n└────────────────┘\n```", "position": 8, "token_count": 211, "has_code": true, "section_hierarchy": ["Function Expression"], "metadata": {"chunk_id": "clients-python-expression-008", "document_id": "clients-python-expression", "position": 8, "token_count": 211, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Function Expression"], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression#function-expression"}}
{"chunk_id": "clients-python-expression-009", "document_id": "clients-python-expression", "content": "## SQL Expression\n\nThis expression contains any valid SQL expression.\n\n```python\nimport duckdb\nimport pandas as pd\n\nfrom duckdb import SQLExpression\n\ndf = pd.DataFrame({\n 'a': [1, 2, 3, 4],\n 'b': [True, None, False, True],\n 'c': [42, 21, 13, 14]\n})", "position": 9, "token_count": 86, "has_code": true, "section_hierarchy": ["SQL Expression"], "metadata": {"chunk_id": "clients-python-expression-009", "document_id": "clients-python-expression", "position": 9, "token_count": 86, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["SQL Expression"], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression#sql-expression"}}
{"chunk_id": "clients-python-expression-010", "document_id": "clients-python-expression", "content": "duckdb.df(df).filter(\n SQLExpression(\"b is true\")\n).select(\n SQLExpression(\"a\").alias(\"selecting_column_a\"),\n SQLExpression(\"case when a = 1 then 1 else 0 end\").alias(\"selecting_case_expression\"),\n SQLExpression(\"1\").alias(\"constant_numeric_column\"),\n SQLExpression(\"'hello'\").alias(\"constant_text_column\")\n).aggregate(\n aggr_expr=[\n SQLExpression(\"SUM(selecting_column_a)\").alias(\"sum_a\"),\n \"selecting_case_expression\" ,\n \"constant_numeric_column\",\n \"constant_text_column\"\n ],\n).show()", "position": 10, "token_count": 192, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-expression-010", "document_id": "clients-python-expression", "position": 10, "token_count": 192, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression"}}
{"chunk_id": "clients-python-expression-011", "document_id": "clients-python-expression", "content": "```\n\n```text\n┌────────┬───────────────────────────┬─────────────────────────┬──────────────────────┐\n│ sum_a │ selecting_case_expression │ constant_numeric_column │ constant_text_column │\n│ int128 │ int32 │ int32 │ varchar │\n├────────┼───────────────────────────┼─────────────────────────┼──────────────────────┤\n│ 4 │ 0 │ 1 │ hello │\n│ 1 │ 1 │ 1 │ hello │\n└────────┴───────────────────────────┴─────────────────────────┴──────────────────────┘\n```", "position": 11, "token_count": 72, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-expression-011", "document_id": "clients-python-expression", "position": 11, "token_count": 72, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression"}}
{"chunk_id": "clients-python-expression-012", "document_id": "clients-python-expression", "content": "## Common Operations\n\nThe Expression class also contains many operations that can be applied to any Expression type.", "position": 12, "token_count": 22, "has_code": false, "section_hierarchy": ["Common Operations"], "metadata": {"chunk_id": "clients-python-expression-012", "document_id": "clients-python-expression", "position": 12, "token_count": 22, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Common Operations"], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression#common-operations"}}
{"chunk_id": "clients-python-expression-013", "document_id": "clients-python-expression", "content": "| Operation | Description |\n|--------------------------------|-----------------------------------------------------------------------------------------------------------------------------|\n| `.alias(name: str)` | Applies an alias to the expression |\n| `.cast(type: DuckDBPyType)` | Applies a cast to the provided type on the expression |", "position": 13, "token_count": 211, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-expression-013", "document_id": "clients-python-expression", "position": 13, "token_count": 211, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression"}}
{"chunk_id": "clients-python-expression-014", "document_id": "clients-python-expression", "content": "| `.alias(name: str)` | Applies an alias to the expression |\n| `.cast(type: DuckDBPyType)` | Applies a cast to the provided type on the expression |\n| `.isin(*exprs: Expression)` | Creates an [`IN` expression]({% link docs/stable/sql/expressions/in.md %}#in) against the provided expressions as the list |\n| `.isnotin(*exprs: Expression)` | Creates a [`NOT IN` expression]({% link docs/stable/sql/expressions/in.md %}#not-in) against the provided expressions as the list |\n| `.isnotnull()` | Checks whether the expression is not `NULL` |\n| `.isnull()` | Checks whether the expression is `NULL` |", "position": 14, "token_count": 193, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-expression-014", "document_id": "clients-python-expression", "position": 14, "token_count": 193, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression"}}
{"chunk_id": "clients-python-expression-015", "document_id": "clients-python-expression", "content": "### Order Operations\n\nWhen expressions are provided to `DuckDBPyRelation.order()`, the following order operations can be applied.\n\n| Operation | Description |\n|--------------------------------|------------------------------------------------------------------------------------|\n| `.asc()` | Indicates that this expression should be sorted in ascending order |\n| `.desc()` | Indicates that this expression should be sorted in descending order |\n| `.nulls_first()` | Indicates that the nulls in this expression should precede the non-null values |\n| `.nulls_last()` | Indicates that the nulls in this expression should come after the non-null values |", "position": 15, "token_count": 252, "has_code": false, "section_hierarchy": ["Order Operations"], "metadata": {"chunk_id": "clients-python-expression-015", "document_id": "clients-python-expression", "position": 15, "token_count": 252, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Order Operations"], "file_path": "clients/python/expression.md", "url": "/clients/python/expression", "title": "Expression API", "category": null, "tags": [], "section_url": "/clients/python/expression#order-operations"}}

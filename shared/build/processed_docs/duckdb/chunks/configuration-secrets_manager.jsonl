{"chunk_id": "configuration-secrets_manager-000", "document_id": "configuration-secrets_manager", "content": "The **Secrets manager** provides a unified user interface for secrets across all backends that use them. Secrets can be scoped, so different storage prefixes can have different secrets, allowing for example to join data across organizations in a single query. Secrets can also be persisted, so that they do not need to be specified every time DuckDB is launched.\n\n> Warning Persistent secrets are stored in unencrypted binary format on the disk.", "position": 0, "token_count": 94, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "configuration-secrets_manager-000", "document_id": "configuration-secrets_manager", "position": 0, "token_count": 94, "has_code": false, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager"}}
{"chunk_id": "configuration-secrets_manager-001", "document_id": "configuration-secrets_manager", "content": "## Types of Secrets\n\nSecrets are typed, their type identifies which service they are for.\nMost secrets are not included in DuckDB default, instead, they are registered by extensions.\nCurrently, the following secret types are available:", "position": 1, "token_count": 47, "has_code": false, "section_hierarchy": ["Types of Secrets"], "metadata": {"chunk_id": "configuration-secrets_manager-001", "document_id": "configuration-secrets_manager", "position": 1, "token_count": 47, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Types of Secrets"], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager#types-of-secrets"}}
{"chunk_id": "configuration-secrets_manager-002", "document_id": "configuration-secrets_manager", "content": "| Secret type | Service / protocol | Extension |\n| ------------- | -------------------- | --------------------------------------------------------------------------------- |\n| `azure` | Azure Blob Storage | [`azure`]({% link docs/stable/core_extensions/azure.md %}) |\n| `ducklake` | DuckLake | [`ducklake`](https://ducklake.select/docs/stable/duckdb/usage/connecting#secrets) |", "position": 2, "token_count": 206, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "configuration-secrets_manager-002", "document_id": "configuration-secrets_manager", "position": 2, "token_count": 206, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager"}}
{"chunk_id": "configuration-secrets_manager-003", "document_id": "configuration-secrets_manager", "content": "| `ducklake` | DuckLake | [`ducklake`](https://ducklake.select/docs/stable/duckdb/usage/connecting#secrets) |\n| `gcs` | Google Cloud Storage | [`httpfs`]({% link docs/stable/core_extensions/httpfs/s3api.md %}) |\n| `http` | HTTP and HTTPS | [`httpfs`]({% link docs/stable/core_extensions/httpfs/https.md %}) |\n| `huggingface` | Hugging Face | [`httpfs`]({% link docs/stable/core_extensions/httpfs/hugging_face.md %}) |\n| `iceberg` | Iceberg REST Catalog | [`httpfs`]({% link docs/stable/core_extensions/httpfs/s3api.md %}), [`iceberg`]({% link docs/stable/core_extensions/iceberg/iceberg_rest_catalogs.md %}) |", "position": 3, "token_count": 240, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "configuration-secrets_manager-003", "document_id": "configuration-secrets_manager", "position": 3, "token_count": 240, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager"}}
{"chunk_id": "configuration-secrets_manager-004", "document_id": "configuration-secrets_manager", "content": "| `mysql` | MySQL | [`mysql`]({% link docs/stable/core_extensions/mysql.md %}) |\n| `postgres` | PostgreSQL | [`postgres`]({% link docs/stable/core_extensions/postgres.md %}) |\n| `r2` | Cloudflare R2 | [`httpfs`]({% link docs/stable/core_extensions/httpfs/s3api.md %}) |\n| `s3` | AWS S3 | [`httpfs`]({% link docs/stable/core_extensions/httpfs/s3api.md %}) |", "position": 4, "token_count": 175, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "configuration-secrets_manager-004", "document_id": "configuration-secrets_manager", "position": 4, "token_count": 175, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager"}}
{"chunk_id": "configuration-secrets_manager-005", "document_id": "configuration-secrets_manager", "content": "For each type, there are one or more “secret providers” that specify how the secret is created. Secrets can also have an optional scope, which is a file path prefix that the secret applies to. When fetching a secret for a path, the secret scopes are compared to the path, returning the matching secret for the path. In the case of multiple matching secrets, the longest prefix is chosen.", "position": 5, "token_count": 84, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "configuration-secrets_manager-005", "document_id": "configuration-secrets_manager", "position": 5, "token_count": 84, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager"}}
{"chunk_id": "configuration-secrets_manager-006", "document_id": "configuration-secrets_manager", "content": "## Creating a Secret\n\nSecrets can be created using the [`CREATE SECRET` SQL statement]({% link docs/stable/sql/statements/create_secret.md %}).\nSecrets can be **temporary** or **persistent**. Temporary secrets are used by default – and are stored in-memory for the life span of the DuckDB instance similar to how settings worked previously. Persistent secrets are stored in **unencrypted binary format** in the `~/.duckdb/stored_secrets` directory. On startup of DuckDB, persistent secrets are read from this directory and automatically loaded.", "position": 6, "token_count": 135, "has_code": false, "section_hierarchy": ["Creating a Secret"], "metadata": {"chunk_id": "configuration-secrets_manager-006", "document_id": "configuration-secrets_manager", "position": 6, "token_count": 135, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Creating a Secret"], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager#creating-a-secret"}}
{"chunk_id": "configuration-secrets_manager-007", "document_id": "configuration-secrets_manager", "content": "### Secret Providers\n\nTo create a secret, a **Secret Provider** needs to be used. A Secret Provider is a mechanism through which a secret is generated. To illustrate this, for the `S3`, `GCS`, `R2`, and `AZURE` secret types, DuckDB currently supports two providers: `CONFIG` and `credential_chain`. The `CONFIG` provider requires the user to pass all configuration information into the `CREATE SECRET`, whereas the `credential_chain` provider will automatically try to fetch credentials. When no Secret Provider is specified, the `CONFIG` provider is used. For more details on how to create secrets using different providers check out the respective pages on [httpfs]({% link docs/stable/core_extensions/httpfs/overview.md %}#configuration-and-authentication-using-secrets) and [azure]({% link docs/stable/core_extensions/azure.md %}#authentication-with-secret).", "position": 7, "token_count": 225, "has_code": false, "section_hierarchy": ["Secret Providers"], "metadata": {"chunk_id": "configuration-secrets_manager-007", "document_id": "configuration-secrets_manager", "position": 7, "token_count": 225, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Secret Providers"], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager#secret-providers"}}
{"chunk_id": "configuration-secrets_manager-008", "document_id": "configuration-secrets_manager", "content": "### Temporary Secrets\n\nTo create a temporary unscoped secret to access S3, we can now use the following:\n\n```sql\nCREATE SECRET my_secret (\n TYPE s3,\n KEY_ID 'my_secret_key',\n SECRET 'my_secret_value',\n REGION 'my_region'\n);\n```\n\nNote that we implicitly use the default `CONFIG` secret provider here.\n\n### Persistent Secrets\n\nIn order to persist secrets between DuckDB database instances, we can now use the `CREATE PERSISTENT SECRET` command, e.g.:\n\n```sql\nCREATE PERSISTENT SECRET my_persistent_secret (\n TYPE s3,\n KEY_ID 'my_secret_key',\n SECRET 'my_secret_value'\n);\n```\n\nBy default, this will write the secret (unencrypted) to the `~/.duckdb/stored_secrets` directory. To change the secrets directory, issue:\n\n```sql\nSET secret_directory = 'path/to/my_secrets_dir';\n```\n\nNote that setting the value of the `home_directory` configuration option has no effect on the location of the secrets.", "position": 8, "token_count": 249, "has_code": true, "section_hierarchy": ["Persistent Secrets"], "metadata": {"chunk_id": "configuration-secrets_manager-008", "document_id": "configuration-secrets_manager", "position": 8, "token_count": 249, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Persistent Secrets"], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager#persistent-secrets"}}
{"chunk_id": "configuration-secrets_manager-009", "document_id": "configuration-secrets_manager", "content": "## Deleting Secrets\n\nSecrets can be deleted using the [`DROP SECRET` statement]({% link docs/stable/sql/statements/create_secret.md %}#syntax-for-drop-secret), e.g.:\n\n```sql\nDROP PERSISTENT SECRET my_persistent_secret;\n```", "position": 9, "token_count": 72, "has_code": true, "section_hierarchy": ["Deleting Secrets"], "metadata": {"chunk_id": "configuration-secrets_manager-009", "document_id": "configuration-secrets_manager", "position": 9, "token_count": 72, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Deleting Secrets"], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager#deleting-secrets"}}
{"chunk_id": "configuration-secrets_manager-010", "document_id": "configuration-secrets_manager", "content": "## Creating Multiple Secrets for the Same Service Type\n\nIf two secrets exist for a service type, the scope can be used to decide which one should be used. For example:\n\n```sql\nCREATE SECRET secret1 (\n TYPE s3,\n KEY_ID 'my_secret_key1',\n SECRET 'my_secret_value1',\n SCOPE 's3://⟨my-bucket⟩'\n);\n```\n\n```sql\nCREATE SECRET secret2 (\n TYPE s3,\n KEY_ID 'my_secret_key2',\n SECRET 'my_secret_value2',\n SCOPE 's3://⟨my-other-bucket⟩'\n);\n```\n\nNow, if the user queries something from `s3://⟨my-other-bucket⟩/something`, secret `secret2` will be chosen automatically for that request. To see which secret is being used, the `which_secret` scalar function can be used, which takes a path and a secret type as parameters:\n\n```sql\nFROM which_secret('s3://⟨my-other-bucket⟩/file.parquet', 's3');\n```", "position": 10, "token_count": 254, "has_code": true, "section_hierarchy": ["Creating Multiple Secrets for the Same Service Type"], "metadata": {"chunk_id": "configuration-secrets_manager-010", "document_id": "configuration-secrets_manager", "position": 10, "token_count": 254, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Creating Multiple Secrets for the Same Service Type"], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager#creating-multiple-secrets-for-the-same-service-type"}}
{"chunk_id": "configuration-secrets_manager-011", "document_id": "configuration-secrets_manager", "content": "## Listing Secrets\n\nSecrets can be listed using the built-in table-producing function, e.g., by using the [`duckdb_secrets()` table function]({% link docs/stable/sql/meta/duckdb_table_functions.md %}#duckdb_secrets):\n\n```sql\nFROM duckdb_secrets();\n```\n\nSensitive information will be redacted.", "position": 11, "token_count": 93, "has_code": true, "section_hierarchy": ["Listing Secrets"], "metadata": {"chunk_id": "configuration-secrets_manager-011", "document_id": "configuration-secrets_manager", "position": 11, "token_count": 93, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Listing Secrets"], "file_path": "configuration/secrets_manager.md", "url": "/configuration/secrets_manager", "title": "Secrets Manager", "category": null, "tags": [], "section_url": "/configuration/secrets_manager#listing-secrets"}}

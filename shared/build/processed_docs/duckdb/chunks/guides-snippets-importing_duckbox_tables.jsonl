{"chunk_id": "guides-snippets-importing_duckbox_tables-000", "document_id": "guides-snippets-importing_duckbox_tables", "content": "> The scripts provided in this page work on Linux, macOS, and WSL.\n\nBy default, the DuckDB [CLI client]({% link docs/stable/clients/cli/overview.md %}) renders query results in the [duckbox format]({% link docs/stable/clients/cli/output_formats.md %}),\nwhich uses rich, ASCII-art inspired tables to show data.\nThese tables are often shared verbatim in other documents.\nFor example, take the table used to demonstrate [new CSV features in the DuckDB v1.2.0 release blog post]({% post_url 2025-02-05-announcing-duckdb-120 %}#csv-features.md):\n\n```text\n┌─────────┬───────┐\n│ a │ b │\n│ varchar │ int64 │\n├─────────┼───────┤\n│ hello │ 42 │\n│ world │ 84 │\n└─────────┴───────┘", "position": 0, "token_count": 201, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-importing_duckbox_tables-000", "document_id": "guides-snippets-importing_duckbox_tables", "position": 0, "token_count": 201, "has_code": true, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "guides/snippets/importing_duckbox_tables.md", "url": "/guides/snippets/importing_duckbox_tables", "title": "Importing Duckbox Tables", "category": null, "tags": [], "section_url": "/guides/snippets/importing_duckbox_tables"}}
{"chunk_id": "guides-snippets-importing_duckbox_tables-001", "document_id": "guides-snippets-importing_duckbox_tables", "content": "```\n\nWhat if we would like to load this data back to DuckDB?\nThis is not supported by default but it can be achieved by some scripting:\nwe can turn the table into a `│`-separated file and read it with DuckDB's [CSV reader]({% link docs/stable/data/csv/overview.md %}).\nNote that the separator is not the pipe character `|`, instead it is the [“Box Drawings Light Vertical” character](https://www.compart.com/en/unicode/U+2502) `│`.", "position": 1, "token_count": 136, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-importing_duckbox_tables-001", "document_id": "guides-snippets-importing_duckbox_tables", "position": 1, "token_count": 136, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/importing_duckbox_tables.md", "url": "/guides/snippets/importing_duckbox_tables", "title": "Importing Duckbox Tables", "category": null, "tags": [], "section_url": "/guides/snippets/importing_duckbox_tables"}}
{"chunk_id": "guides-snippets-importing_duckbox_tables-002", "document_id": "guides-snippets-importing_duckbox_tables", "content": "## Loading Duckbox Tables to DuckDB\n\nFirst, we save the table above as `duckbox.csv`.\nThen, we clean it using `sed`:\n\n```bash\necho -n > duckbox-cleaned.csv\nsed -n \"2s/^│ *//;s/ *│$//;s/ *│ */│/p;2q\" duckbox.csv >> duckbox-cleaned.csv\nsed \"1,4d;\\$d;s/^│ *//;s/ *│$//;s/ *│ */│/g\" duckbox.csv >> duckbox-cleaned.csv\n```\n\nThe `duckbox-cleaned.csv` file looks as follows:\n\n```text\na│b\nhello│42\nworld│84\n```\n\nWe can then simply load this to DuckDB via:\n\n```sql\nFROM read_csv('duckbox-cleaned.csv', delim = '│');", "position": 2, "token_count": 228, "has_code": true, "section_hierarchy": ["Loading Duckbox Tables to DuckDB"], "metadata": {"chunk_id": "guides-snippets-importing_duckbox_tables-002", "document_id": "guides-snippets-importing_duckbox_tables", "position": 2, "token_count": 228, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Loading Duckbox Tables to DuckDB"], "file_path": "guides/snippets/importing_duckbox_tables.md", "url": "/guides/snippets/importing_duckbox_tables", "title": "Importing Duckbox Tables", "category": null, "tags": [], "section_url": "/guides/snippets/importing_duckbox_tables#loading-duckbox-tables-to-duckdb"}}
{"chunk_id": "guides-snippets-importing_duckbox_tables-003", "document_id": "guides-snippets-importing_duckbox_tables", "content": "```\n\nWe can then simply load this to DuckDB via:\n\n```sql\nFROM read_csv('duckbox-cleaned.csv', delim = '│');\n```\n\nAnd export it to a CSV:\n\n```sql\nCOPY (FROM read_csv('duckbox-cleaned.csv', delim = '│')) TO 'out.csv';\n```\n\n```text\na,b\nhello,42\nworld,84\n```", "position": 3, "token_count": 112, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-importing_duckbox_tables-003", "document_id": "guides-snippets-importing_duckbox_tables", "position": 3, "token_count": 112, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/importing_duckbox_tables.md", "url": "/guides/snippets/importing_duckbox_tables", "title": "Importing Duckbox Tables", "category": null, "tags": [], "section_url": "/guides/snippets/importing_duckbox_tables"}}
{"chunk_id": "guides-snippets-importing_duckbox_tables-004", "document_id": "guides-snippets-importing_duckbox_tables", "content": "## Using `shellfs`\n\nTo parse duckbox tables with a single `read_csv` call – and without creating any temporary files –, we can use the [`shellfs` community extension]({% link community_extensions/extensions/shellfs.md %}):\n\n```sql\nINSTALL shellfs FROM community;\nLOAD shellfs;\nFROM read_csv(\n '(sed -n \"2s/^│ *//;s/ *│$//;s/ *│ */│/p;2q\" duckbox.csv; ' ||\n 'sed \"1,4d;\\$d;s/^│ *//;s/ *│$//;s/ *│ */│/g\" duckbox.csv) |',\n delim = '│'\n );", "position": 4, "token_count": 186, "has_code": true, "section_hierarchy": ["Using `shellfs`"], "metadata": {"chunk_id": "guides-snippets-importing_duckbox_tables-004", "document_id": "guides-snippets-importing_duckbox_tables", "position": 4, "token_count": 186, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Using `shellfs`"], "file_path": "guides/snippets/importing_duckbox_tables.md", "url": "/guides/snippets/importing_duckbox_tables", "title": "Importing Duckbox Tables", "category": null, "tags": [], "section_url": "/guides/snippets/importing_duckbox_tables#using-shellfs"}}
{"chunk_id": "guides-snippets-importing_duckbox_tables-005", "document_id": "guides-snippets-importing_duckbox_tables", "content": "```\n\nWe can also create a [table macro]({% link docs/stable/sql/statements/create_macro.md %}#table-macros):\n\n```sql\nCREATE MACRO read_duckbox(path) AS TABLE\n FROM read_csv(\n printf(\n '(sed -n \"2s/^│ *//;s/ *│$//;s/ *│ */│/p;2q\" %s; ' ||\n 'sed \"1,4d;\\$d;s/^│ *//;s/ *│$//;s/ *│ */│/g\" %s) |',\n path, path\n ),\n delim = '│'\n );\n```\n\nThen, reading a duckbox table is as simple as:\n\n```sql\nFROM read_duckbox('duckbox.csv');", "position": 5, "token_count": 200, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-importing_duckbox_tables-005", "document_id": "guides-snippets-importing_duckbox_tables", "position": 5, "token_count": 200, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/importing_duckbox_tables.md", "url": "/guides/snippets/importing_duckbox_tables", "title": "Importing Duckbox Tables", "category": null, "tags": [], "section_url": "/guides/snippets/importing_duckbox_tables"}}
{"chunk_id": "guides-snippets-importing_duckbox_tables-006", "document_id": "guides-snippets-importing_duckbox_tables", "content": "```\n\nThen, reading a duckbox table is as simple as:\n\n```sql\nFROM read_duckbox('duckbox.csv');\n```\n\n> `shellfs` is a community extension and it comes without any support or guarantees.\n> Only use it if you can ensure that its inputs are appropriately sanitized.\n> Please consult the [Securing DuckDB page]({% link docs/stable/operations_manual/securing_duckdb/overview.md %}) for more details.", "position": 6, "token_count": 112, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-snippets-importing_duckbox_tables-006", "document_id": "guides-snippets-importing_duckbox_tables", "position": 6, "token_count": 112, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/snippets/importing_duckbox_tables.md", "url": "/guides/snippets/importing_duckbox_tables", "title": "Importing Duckbox Tables", "category": null, "tags": [], "section_url": "/guides/snippets/importing_duckbox_tables"}}
{"chunk_id": "guides-snippets-importing_duckbox_tables-007", "document_id": "guides-snippets-importing_duckbox_tables", "content": "## Limitations\n\nPlease consider the following limitations when running this script:\n\n* This approach only works if the table does not have long pipe `│` characters.\n It also trims spaces from the table cell values.\n Make sure to factor in these assumptions when running the script.\n\n* The script is compatible with both BSD `sed` (which is the default on macOS) and GNU `sed` (which is the default on Linux and available on macOS as `gsed`).\n\n* Only the data types [supported by the CSV sniffer]({% link docs/stable/data/csv/auto_detection.md %}#type-detection) are parsed correctly. Values containing nested data will be parsed as a `VARCHAR`.", "position": 7, "token_count": 165, "has_code": false, "section_hierarchy": ["Limitations"], "metadata": {"chunk_id": "guides-snippets-importing_duckbox_tables-007", "document_id": "guides-snippets-importing_duckbox_tables", "position": 7, "token_count": 165, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Limitations"], "file_path": "guides/snippets/importing_duckbox_tables.md", "url": "/guides/snippets/importing_duckbox_tables", "title": "Importing Duckbox Tables", "category": null, "tags": [], "section_url": "/guides/snippets/importing_duckbox_tables#limitations"}}

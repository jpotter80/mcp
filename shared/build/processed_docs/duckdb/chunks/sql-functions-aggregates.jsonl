{"chunk_id": "sql-functions-aggregates-000", "document_id": "sql-functions-aggregates", "content": "## Examples\n\nProduce a single row containing the sum of the `amount` column:\n\n```sql\nSELECT sum(amount)\nFROM sales;\n```\n\nProduce one row per unique region, containing the sum of `amount` for each group:\n\n```sql\nSELECT region, sum(amount)\nFROM sales\nGROUP BY region;\n```\n\nReturn only the regions that have a sum of `amount` higher than 100:\n\n```sql\nSELECT region\nFROM sales\nGROUP BY region\nHAVING sum(amount) > 100;\n```\n\nReturn the number of unique values in the `region` column:\n\n```sql\nSELECT count(DISTINCT region)\nFROM sales;\n```\n\nReturn two values, the total sum of `amount` and the sum of `amount` minus columns where the region is `north` using the [`FILTER` clause]({% link docs/stable/sql/query_syntax/filter.md %}):\n\n```sql\nSELECT sum(amount), sum(amount) FILTER (region != 'north')\nFROM sales;", "position": 0, "token_count": 222, "has_code": true, "section_hierarchy": ["Examples"], "metadata": {"chunk_id": "sql-functions-aggregates-000", "document_id": "sql-functions-aggregates", "position": 0, "token_count": 222, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Examples"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#examples"}}
{"chunk_id": "sql-functions-aggregates-001", "document_id": "sql-functions-aggregates", "content": "```\n\nReturns a list of all regions in order of the `amount` column:\n\n```sql\nSELECT list(region ORDER BY amount DESC)\nFROM sales;\n```\n\nReturns the amount of the first sale using the `first()` aggregate function:\n\n```sql\nSELECT first(amount ORDER BY date ASC)\nFROM sales;\n```", "position": 1, "token_count": 77, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-001", "document_id": "sql-functions-aggregates", "position": 1, "token_count": 77, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-002", "document_id": "sql-functions-aggregates", "content": "## Syntax\n\nAggregates are functions that *combine* multiple rows into a single value. Aggregates are different from scalar functions and window functions because they change the cardinality of the result. As such, aggregates can only be used in the `SELECT` and `HAVING` clauses of a SQL query.\n\n### `DISTINCT` Clause in Aggregate Functions\n\nWhen the `DISTINCT` clause is provided, only distinct values are considered in the computation of the aggregate. This is typically used in combination with the `count` aggregate to get the number of distinct elements; but it can be used together with any aggregate function in the system.\nThere are some aggregates that are insensitive to duplicate values (e.g., `min` and `max`) and for them this clause is parsed and ignored.", "position": 2, "token_count": 168, "has_code": false, "section_hierarchy": ["`DISTINCT` Clause in Aggregate Functions"], "metadata": {"chunk_id": "sql-functions-aggregates-002", "document_id": "sql-functions-aggregates", "position": 2, "token_count": 168, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`DISTINCT` Clause in Aggregate Functions"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#distinct-clause-in-aggregate-functions"}}
{"chunk_id": "sql-functions-aggregates-003", "document_id": "sql-functions-aggregates", "content": "### `ORDER BY` Clause in Aggregate Functions\n\nAn `ORDER BY` clause can be provided after the last argument of the function call. Note the lack of the comma separator before the clause.\n\n```sql\nSELECT ⟨aggregate_function⟩(⟨arg⟩, ⟨sep⟩ ORDER BY ⟨ordering_criteria⟩);\n```\n\nThis clause ensures that the values being aggregated are sorted before applying the function.\nMost aggregate functions are order-insensitive, and for them this clause is parsed and discarded.\nHowever, there are some order-sensitive aggregates that can have non-deterministic results without ordering, e.g., `first`, `last`, `list` and `string_agg` / `group_concat` / `listagg`.\nThese can be made deterministic by ordering the arguments.\n\nFor example:\n\n```sql\nCREATE TABLE tbl AS\n SELECT s FROM range(1, 4) r(s);\n\nSELECT string_agg(s, ', ' ORDER BY s DESC) AS countdown\nFROM tbl;", "position": 3, "token_count": 233, "has_code": true, "section_hierarchy": ["`ORDER BY` Clause in Aggregate Functions"], "metadata": {"chunk_id": "sql-functions-aggregates-003", "document_id": "sql-functions-aggregates", "position": 3, "token_count": 233, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`ORDER BY` Clause in Aggregate Functions"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#order-by-clause-in-aggregate-functions"}}
{"chunk_id": "sql-functions-aggregates-004", "document_id": "sql-functions-aggregates", "content": "```\n\n| countdown |\n|-----------|\n| 3, 2, 1 |", "position": 4, "token_count": 28, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-004", "document_id": "sql-functions-aggregates", "position": 4, "token_count": 28, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-005", "document_id": "sql-functions-aggregates", "content": "### Handling `NULL` Values\n\nAll general aggregate functions ignore `NULL`s, except for [`list`](#listarg) ([`array_agg`](#listarg)), [`first`](#firstarg) ([`arbitrary`](#firstarg)) and [`last`](#lastarg).\nTo exclude `NULL`s from `list`, you can use a [`FILTER` clause]({% link docs/stable/sql/query_syntax/filter.md %}).\nTo ignore `NULL`s from `first`, you can use the [`any_value` aggregate](#any_valuearg).", "position": 5, "token_count": 162, "has_code": false, "section_hierarchy": ["Handling `NULL` Values"], "metadata": {"chunk_id": "sql-functions-aggregates-005", "document_id": "sql-functions-aggregates", "position": 5, "token_count": 162, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Handling `NULL` Values"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#handling-null-values"}}
{"chunk_id": "sql-functions-aggregates-006", "document_id": "sql-functions-aggregates", "content": "All general aggregate functions except [`count`](#countarg) return `NULL` on empty groups.\nIn particular, [`list`](#listarg) does *not* return an empty list, [`sum`](#sumarg) does *not* return zero, and [`string_agg`](#string_aggarg-sep) does *not* return an empty string in this case.", "position": 6, "token_count": 98, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-006", "document_id": "sql-functions-aggregates", "position": 6, "token_count": 98, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-007", "document_id": "sql-functions-aggregates", "content": "## General Aggregate Functions\n\nThe table below shows the available general aggregate functions.", "position": 7, "token_count": 17, "has_code": false, "section_hierarchy": ["General Aggregate Functions"], "metadata": {"chunk_id": "sql-functions-aggregates-007", "document_id": "sql-functions-aggregates", "position": 7, "token_count": 17, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["General Aggregate Functions"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#general-aggregate-functions"}}
{"chunk_id": "sql-functions-aggregates-008", "document_id": "sql-functions-aggregates", "content": "| Function | Description |\n|:--|:--------|\n| [`any_value(arg)`](#any_valuearg) | Returns the first non-null value from `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`arg_max(arg, val)`](#arg_maxarg-val) | Finds the row with the maximum `val` and calculates the `arg` expression at that row. Rows where the value of the `arg` or `val` expression is `NULL` are ignored. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |", "position": 8, "token_count": 175, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-008", "document_id": "sql-functions-aggregates", "position": 8, "token_count": 175, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-009", "document_id": "sql-functions-aggregates", "content": "| [`arg_max(arg, val, n)`](#arg_maxarg-val-n) | The generalized case of [`arg_max`](#arg_maxarg-val) for `n` values: returns a `LIST` containing the `arg` expressions for the top `n` rows ordered by `val` descending. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`arg_max_null(arg, val)`](#arg_max_nullarg-val) | Finds the row with the maximum `val` and calculates the `arg` expression at that row. Rows where the `val` expression evaluates to `NULL` are ignored. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |", "position": 9, "token_count": 205, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-009", "document_id": "sql-functions-aggregates", "position": 9, "token_count": 205, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-010", "document_id": "sql-functions-aggregates", "content": "| [`arg_min(arg, val)`](#arg_minarg-val) | Finds the row with the minimum `val` and calculates the `arg` expression at that row. Rows where the value of the `arg` or `val` expression is `NULL` are ignored. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`arg_min(arg, val, n)`](#arg_minarg-val-n) | Returns a `LIST` containing the `arg` expressions for the \"bottom\" `n` rows ordered by `val` ascending. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |", "position": 10, "token_count": 178, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-010", "document_id": "sql-functions-aggregates", "position": 10, "token_count": 178, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-011", "document_id": "sql-functions-aggregates", "content": "| [`arg_min_null(arg, val)`](#arg_min_nullarg-val) | Finds the row with the minimum `val` and calculates the `arg` expression at that row. Rows where the `val` expression evaluates to `NULL` are ignored. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`avg(arg)`](#avgarg) | Calculates the average of all non-null values in `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`bit_and(arg)`](#bit_andarg) | Returns the bitwise AND of all bits in a given expression. |\n| [`bit_or(arg)`](#bit_orarg) | Returns the bitwise OR of all bits in a given expression. |", "position": 11, "token_count": 223, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-011", "document_id": "sql-functions-aggregates", "position": 11, "token_count": 223, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-012", "document_id": "sql-functions-aggregates", "content": "| [`bit_or(arg)`](#bit_orarg) | Returns the bitwise OR of all bits in a given expression. |\n| [`bit_xor(arg)`](#bit_xorarg) | Returns the bitwise XOR of all bits in a given expression. |\n| [`bitstring_agg(arg)`](#bitstring_aggarg) | Returns a bitstring whose length corresponds to the range of the non-null (integer) values, with bits set at the location of each (distinct) value. |\n| [`bool_and(arg)`](#bool_andarg) | Returns `true` if every input value is `true`, otherwise `false`. |\n| [`bool_or(arg)`](#bool_orarg) | Returns `true` if any input value is `true`, otherwise `false`. |", "position": 12, "token_count": 219, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-012", "document_id": "sql-functions-aggregates", "position": 12, "token_count": 219, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-013", "document_id": "sql-functions-aggregates", "content": "| [`bool_or(arg)`](#bool_orarg) | Returns `true` if any input value is `true`, otherwise `false`. |\n| [`count()`](#count) | Returns the number of rows. |\n| [`count(arg)`](#countarg) | Returns the number of rows where `arg` is not `NULL`. |\n| [`countif(arg)`](#countifarg) | Returns the number of rows where `arg` is `true`. |\n| [`favg(arg)`](#favgarg) | Calculates the average using a more accurate floating point summation (Kahan Sum). This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |", "position": 13, "token_count": 195, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-013", "document_id": "sql-functions-aggregates", "position": 13, "token_count": 195, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-014", "document_id": "sql-functions-aggregates", "content": "| [`first(arg)`](#firstarg) | Returns the first value (null or non-null) from `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`fsum(arg)`](#fsumarg) | Calculates the sum using a more accurate floating point summation (Kahan Sum). This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`geometric_mean(arg)`](#geometric_meanarg) | Calculates the geometric mean of all non-null values in `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`histogram(arg)`](#histogramarg) | Returns a `MAP` of key-value pairs representing buckets and counts. |", "position": 14, "token_count": 221, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-014", "document_id": "sql-functions-aggregates", "position": 14, "token_count": 221, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-015", "document_id": "sql-functions-aggregates", "content": "| [`histogram(arg)`](#histogramarg) | Returns a `MAP` of key-value pairs representing buckets and counts. |\n| [`histogram(arg, boundaries)`](#histogramarg-boundaries) | Returns a `MAP` of key-value pairs representing the provided upper `boundaries` and counts of elements in the corresponding bins (left-open and right-closed partitions) of the datatype. A boundary at the largest value of the datatype is automatically added when elements larger than all provided `boundaries` appear, see [`is_histogram_other_bin`]({% link docs/stable/sql/functions/utility.md %}#is_histogram_other_binarg). Boundaries may be provided, e.g., via [`equi_width_bins`]({% link docs/stable/sql/functions/utility.md %}#equi_width_binsminmaxbincountnice). |", "position": 15, "token_count": 235, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-015", "document_id": "sql-functions-aggregates", "position": 15, "token_count": 235, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-016", "document_id": "sql-functions-aggregates", "content": "| [`histogram_exact(arg, elements)`](#histogram_exactarg-elements) | Returns a `MAP` of key-value pairs representing the requested elements and their counts. A catch-all element specific to the data-type is automatically added to count other elements when they appear, see [`is_histogram_other_bin`]({% link docs/stable/sql/functions/utility.md %}#is_histogram_other_binarg). |\n| [`histogram_values(source, boundaries)`](#histogram_valuessource-col_name-technique-bin_count) | Returns the upper boundaries of the bins and their counts. |\n| [`last(arg)`](#lastarg) | Returns the last value of a column. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |", "position": 16, "token_count": 217, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-016", "document_id": "sql-functions-aggregates", "position": 16, "token_count": 217, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-017", "document_id": "sql-functions-aggregates", "content": "| [`list(arg)`](#listarg) | Returns a `LIST` containing all the values of a column. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`max(arg)`](#maxarg) | Returns the maximum value present in `arg`. This function is [unaffected by distinctness](#distinct-clause-in-aggregate-functions). |\n| [`max(arg, n)`](#maxarg-n) | Returns a `LIST` containing the `arg` values for the \"top\" `n` rows ordered by `arg` descending. |\n| [`min(arg)`](#minarg) | Returns the minimum value present in `arg`. This function is [unaffected by distinctness](#distinct-clause-in-aggregate-functions). |", "position": 17, "token_count": 208, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-017", "document_id": "sql-functions-aggregates", "position": 17, "token_count": 208, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-018", "document_id": "sql-functions-aggregates", "content": "| [`min(arg, n)`](#minarg-n) | Returns a `LIST` containing the `arg` values for the \"bottom\" `n` rows ordered by `arg` ascending. |\n| [`product(arg)`](#productarg) | Calculates the product of all non-null values in `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`string_agg(arg)`](#string_aggarg-sep) | Concatenates the column string values with a comma separator (`,`). This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`string_agg(arg, sep)`](#string_aggarg-sep) | Concatenates the column string values with a separator. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |", "position": 18, "token_count": 242, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-018", "document_id": "sql-functions-aggregates", "position": 18, "token_count": 242, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-019", "document_id": "sql-functions-aggregates", "content": "| [`sum(arg)`](#sumarg) | Calculates the sum of all non-null values in `arg` / counts `true` values when `arg` is boolean. The floating-point versions of this function are [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`weighted_avg(arg, weight)`](#weighted_avgarg-weight) | Calculates the weighted average all non-null values in `arg`, where each value is scaled by its corresponding `weight`. If `weight` is `NULL`, the corresponding `arg` value will be skipped. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |", "position": 19, "token_count": 177, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-019", "document_id": "sql-functions-aggregates", "position": 19, "token_count": 177, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-020", "document_id": "sql-functions-aggregates", "content": "#### `any_value(arg)`\n\n| **Description** | Returns the first non-`NULL` value from `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `any_value(A)` |\n\n#### `arg_max(arg, val)`\n\n| **Description** | Finds the row with the maximum `val` and calculates the `arg` expression at that row. Rows where the value of the `arg` or `val` expression is `NULL` are ignored. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `arg_max(A, B)` |\n| **Alias(es)** | `argmax(arg, val)`, `max_by(arg, val)` |", "position": 20, "token_count": 221, "has_code": false, "section_hierarchy": ["`arg_max(arg, val)`"], "metadata": {"chunk_id": "sql-functions-aggregates-020", "document_id": "sql-functions-aggregates", "position": 20, "token_count": 221, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`arg_max(arg, val)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#argmaxarg-val"}}
{"chunk_id": "sql-functions-aggregates-021", "document_id": "sql-functions-aggregates", "content": "#### `arg_max(arg, val, n)`\n\n| **Description** | The generalized case of [`arg_max`](#arg_maxarg-val) for `n` values: returns a `LIST` containing the `arg` expressions for the top `n` rows ordered by `val` descending. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `arg_max(A, B, 2)` |\n| **Alias(es)** | `argmax(arg, val, n)`, `max_by(arg, val, n)` |", "position": 21, "token_count": 165, "has_code": false, "section_hierarchy": ["`arg_max(arg, val, n)`"], "metadata": {"chunk_id": "sql-functions-aggregates-021", "document_id": "sql-functions-aggregates", "position": 21, "token_count": 165, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`arg_max(arg, val, n)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#argmaxarg-val-n"}}
{"chunk_id": "sql-functions-aggregates-022", "document_id": "sql-functions-aggregates", "content": "#### `arg_max_null(arg, val)`\n\n| **Description** | Finds the row with the maximum `val` and calculates the `arg` expression at that row. Rows where the `val` expression evaluates to `NULL` are ignored. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `arg_max_null(A, B)` |", "position": 22, "token_count": 110, "has_code": false, "section_hierarchy": ["`arg_max_null(arg, val)`"], "metadata": {"chunk_id": "sql-functions-aggregates-022", "document_id": "sql-functions-aggregates", "position": 22, "token_count": 110, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`arg_max_null(arg, val)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#argmaxnullarg-val"}}
{"chunk_id": "sql-functions-aggregates-023", "document_id": "sql-functions-aggregates", "content": "#### `arg_min(arg, val)`\n\n| **Description** | Finds the row with the minimum `val` and calculates the `arg` expression at that row. Rows where the value of the `arg` or `val` expression is `NULL` are ignored. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `arg_min(A, B)` |\n| **Alias(es)** | `argmin(arg, val)`, `min_by(arg, val)` |", "position": 23, "token_count": 146, "has_code": false, "section_hierarchy": ["`arg_min(arg, val)`"], "metadata": {"chunk_id": "sql-functions-aggregates-023", "document_id": "sql-functions-aggregates", "position": 23, "token_count": 146, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`arg_min(arg, val)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#argminarg-val"}}
{"chunk_id": "sql-functions-aggregates-024", "document_id": "sql-functions-aggregates", "content": "#### `arg_min(arg, val, n)`\n\n| **Description** | The generalized case of [`arg_min`](#arg_minarg-val) for `n` values: returns a `LIST` containing the `arg` expressions for the top `n` rows ordered by `val` descending. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `arg_min(A, B, 2)` |\n| **Alias(es)** | `argmin(arg, val, n)`, `min_by(arg, val, n)` |", "position": 24, "token_count": 164, "has_code": false, "section_hierarchy": ["`arg_min(arg, val, n)`"], "metadata": {"chunk_id": "sql-functions-aggregates-024", "document_id": "sql-functions-aggregates", "position": 24, "token_count": 164, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`arg_min(arg, val, n)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#argminarg-val-n"}}
{"chunk_id": "sql-functions-aggregates-025", "document_id": "sql-functions-aggregates", "content": "#### `arg_min_null(arg, val)`\n\n| **Description** | Finds the row with the minimum `val` and calculates the `arg` expression at that row. Rows where the `val` expression evaluates to `NULL` are ignored. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `arg_min_null(A, B)` |\n\n#### `avg(arg)`\n\n| **Description** | Calculates the average of all non-null values in `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `avg(A)` |\n| **Alias(es)** | `mean` |", "position": 25, "token_count": 198, "has_code": false, "section_hierarchy": ["`avg(arg)`"], "metadata": {"chunk_id": "sql-functions-aggregates-025", "document_id": "sql-functions-aggregates", "position": 25, "token_count": 198, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`avg(arg)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#avgarg"}}
{"chunk_id": "sql-functions-aggregates-026", "document_id": "sql-functions-aggregates", "content": "#### `bit_and(arg)`\n\n| **Description** | Returns the bitwise `AND` of all bits in a given expression. |\n| **Example** | `bit_and(A)` |\n\n#### `bit_or(arg)`\n\n| **Description** | Returns the bitwise `OR` of all bits in a given expression. |\n| **Example** | `bit_or(A)` |\n\n#### `bit_xor(arg)`\n\n| **Description** | Returns the bitwise `XOR` of all bits in a given expression. |\n| **Example** | `bit_xor(A)` |\n\n#### `bitstring_agg(arg)`\n\n| **Description** | Returns a bitstring whose length corresponds to the range of the non-null (integer) values, with bits set at the location of each (distinct) value. |\n| **Example** | `bitstring_agg(A)` |", "position": 26, "token_count": 238, "has_code": false, "section_hierarchy": ["`bitstring_agg(arg)`"], "metadata": {"chunk_id": "sql-functions-aggregates-026", "document_id": "sql-functions-aggregates", "position": 26, "token_count": 238, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`bitstring_agg(arg)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#bitstringaggarg"}}
{"chunk_id": "sql-functions-aggregates-027", "document_id": "sql-functions-aggregates", "content": "#### `bool_and(arg)`\n\n| **Description** | Returns `true` if every input value is `true`, otherwise `false`. |\n| **Example** | `bool_and(A)` |\n\n#### `bool_or(arg)`\n\n| **Description** | Returns `true` if any input value is `true`, otherwise `false`. |\n| **Example** | `bool_or(A)` |\n\n#### `count()`\n\n| **Description** | Returns the number of rows. |\n| **Example** | `count()` |\n| **Alias(es)** | `count(*)` |\n\n#### `count(arg)`\n\n| **Description** | Returns the number rows where `arg` is not `NULL`. |\n| **Example** | `count(A)` |", "position": 27, "token_count": 217, "has_code": false, "section_hierarchy": ["`count(arg)`"], "metadata": {"chunk_id": "sql-functions-aggregates-027", "document_id": "sql-functions-aggregates", "position": 27, "token_count": 217, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`count(arg)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#countarg"}}
{"chunk_id": "sql-functions-aggregates-028", "document_id": "sql-functions-aggregates", "content": "#### `count(arg)`\n\n| **Description** | Returns the number rows where `arg` is not `NULL`. |\n| **Example** | `count(A)` |\n\n#### `countif(arg)`\n\n| **Description** | Returns the number of rows where `arg` is `true`. |\n| **Example** | `countif(A)` |\n\n#### `favg(arg)`\n\n| **Description** | Calculates the average using a more accurate floating point summation (Kahan Sum). This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `favg(A)` |", "position": 28, "token_count": 178, "has_code": false, "section_hierarchy": ["`favg(arg)`"], "metadata": {"chunk_id": "sql-functions-aggregates-028", "document_id": "sql-functions-aggregates", "position": 28, "token_count": 178, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`favg(arg)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#favgarg"}}
{"chunk_id": "sql-functions-aggregates-029", "document_id": "sql-functions-aggregates", "content": "#### `first(arg)`\n\n| **Description** | Returns the first value (null or non-null) from `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `first(A)` |\n| **Alias(es)** | `arbitrary(A)` |\n\n#### `fsum(arg)`\n\n| **Description** | Calculates the sum using a more accurate floating point summation (Kahan Sum). This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `fsum(A)` |\n| **Alias(es)** | `sumkahan`, `kahan_sum` |", "position": 29, "token_count": 191, "has_code": false, "section_hierarchy": ["`fsum(arg)`"], "metadata": {"chunk_id": "sql-functions-aggregates-029", "document_id": "sql-functions-aggregates", "position": 29, "token_count": 191, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`fsum(arg)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#fsumarg"}}
{"chunk_id": "sql-functions-aggregates-030", "document_id": "sql-functions-aggregates", "content": "#### `geometric_mean(arg)`\n\n| **Description** | Calculates the geometric mean of all non-null values in `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `geometric_mean(A)` |\n| **Alias(es)** | `geomean(A)` |\n\n#### `histogram(arg)`\n\n| **Description** | Returns a `MAP` of key-value pairs representing buckets and counts. |\n| **Example** | `histogram(A)` |", "position": 30, "token_count": 151, "has_code": false, "section_hierarchy": ["`histogram(arg)`"], "metadata": {"chunk_id": "sql-functions-aggregates-030", "document_id": "sql-functions-aggregates", "position": 30, "token_count": 151, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`histogram(arg)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#histogramarg"}}
{"chunk_id": "sql-functions-aggregates-031", "document_id": "sql-functions-aggregates", "content": "#### `histogram(arg, boundaries)`\n\n| **Description** | Returns a `MAP` of key-value pairs representing the provided upper `boundaries` and counts of elements in the corresponding bins (left-open and right-closed partitions) of the datatype. A boundary at the largest value of the datatype is automatically added when elements larger than all provided `boundaries` appear, see [`is_histogram_other_bin`]({% link docs/stable/sql/functions/utility.md %}#is_histogram_other_binarg). Boundaries may be provided, e.g., via [`equi_width_bins`]({% link docs/stable/sql/functions/utility.md %}#equi_width_binsminmaxbincountnice). |\n| **Example** | `histogram(A, [0, 1, 10])` |", "position": 31, "token_count": 218, "has_code": false, "section_hierarchy": ["`histogram(arg, boundaries)`"], "metadata": {"chunk_id": "sql-functions-aggregates-031", "document_id": "sql-functions-aggregates", "position": 31, "token_count": 218, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`histogram(arg, boundaries)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#histogramarg-boundaries"}}
{"chunk_id": "sql-functions-aggregates-032", "document_id": "sql-functions-aggregates", "content": "#### `histogram_exact(arg, elements)`\n\n| **Description** | Returns a `MAP` of key-value pairs representing the requested elements and their counts. A catch-all element specific to the data-type is automatically added to count other elements when they appear, see [`is_histogram_other_bin`]({% link docs/stable/sql/functions/utility.md %}#is_histogram_other_binarg). |\n| **Example** | `histogram_exact(A, [0, 1, 10])` |\n\n#### `histogram_values(source, col_name, technique, bin_count)`\n\n| **Description** | Returns the upper boundaries of the bins and their counts. |\n| **Example** | `histogram_values(integers, i, bin_count := 2)` |", "position": 32, "token_count": 210, "has_code": false, "section_hierarchy": ["`histogram_values(source, col_name, technique, bin_count)`"], "metadata": {"chunk_id": "sql-functions-aggregates-032", "document_id": "sql-functions-aggregates", "position": 32, "token_count": 210, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`histogram_values(source, col_name, technique, bin_count)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#histogramvaluessource-colname-technique-bincount"}}
{"chunk_id": "sql-functions-aggregates-033", "document_id": "sql-functions-aggregates", "content": "#### `last(arg)`\n\n| **Description** | Returns the last value of a column. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `last(A)` |\n\n#### `list(arg)`\n\n| **Description** | Returns a `LIST` containing all the values of a column. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `list(A)` |\n| **Alias(es)** | `array_agg` |\n\n#### `max(arg)`\n\n| **Description** | Returns the maximum value present in `arg`. This function is [unaffected by distinctness](#distinct-clause-in-aggregate-functions). |\n| **Example** | `max(A)` |", "position": 33, "token_count": 218, "has_code": false, "section_hierarchy": ["`max(arg)`"], "metadata": {"chunk_id": "sql-functions-aggregates-033", "document_id": "sql-functions-aggregates", "position": 33, "token_count": 218, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`max(arg)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#maxarg"}}
{"chunk_id": "sql-functions-aggregates-034", "document_id": "sql-functions-aggregates", "content": "#### `max(arg, n)`\n\n| **Description** | Returns a `LIST` containing the `arg` values for the \"top\" `n` rows ordered by `arg` descending. |\n| **Example** | `max(A, 2)` |\n\n#### `min(arg)`\n\n| **Description** | Returns the minimum value present in `arg`. This function is [unaffected by distinctness](#distinct-clause-in-aggregate-functions). |\n| **Example** | `min(A)` |\n\n#### `min(arg, n)`\n\n| **Description** | Returns a `LIST` containing the `arg` values for the \"bottom\" `n` rows ordered by `arg` ascending. |\n| **Example** | `min(A, 2)` |", "position": 34, "token_count": 200, "has_code": false, "section_hierarchy": ["`min(arg, n)`"], "metadata": {"chunk_id": "sql-functions-aggregates-034", "document_id": "sql-functions-aggregates", "position": 34, "token_count": 200, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`min(arg, n)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#minarg-n"}}
{"chunk_id": "sql-functions-aggregates-035", "document_id": "sql-functions-aggregates", "content": "#### `product(arg)`\n\n| **Description** | Calculates the product of all non-null values in `arg`. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `product(A)` |\n\n#### `string_agg(arg)`\n\n| **Description** | Concatenates the column string values with a comma separator (`,`). This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `string_agg(S, ',')` |\n| **Alias(es)** | `group_concat(arg)`, `listagg(arg)` |", "position": 35, "token_count": 192, "has_code": false, "section_hierarchy": ["`string_agg(arg)`"], "metadata": {"chunk_id": "sql-functions-aggregates-035", "document_id": "sql-functions-aggregates", "position": 35, "token_count": 192, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`string_agg(arg)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#stringaggarg"}}
{"chunk_id": "sql-functions-aggregates-036", "document_id": "sql-functions-aggregates", "content": "#### `string_agg(arg, sep)`\n\n| **Description** | Concatenates the column string values with a separator. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `string_agg(S, ',')` |\n| **Alias(es)** | `group_concat(arg, sep)`, `listagg(arg, sep)` |\n\n#### `sum(arg)`\n\n| **Description** | Calculates the sum of all non-null values in `arg` / counts `true` values when `arg` is boolean. The floating-point versions of this function are [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `sum(A)` |", "position": 36, "token_count": 211, "has_code": false, "section_hierarchy": ["`sum(arg)`"], "metadata": {"chunk_id": "sql-functions-aggregates-036", "document_id": "sql-functions-aggregates", "position": 36, "token_count": 211, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`sum(arg)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#sumarg"}}
{"chunk_id": "sql-functions-aggregates-037", "document_id": "sql-functions-aggregates", "content": "#### `weighted_avg(arg, weight)`\n\n| **Description** | Calculates the weighted average of all non-null values in `arg`, where each value is scaled by its corresponding `weight`. If `weight` is `NULL`, the value will be skipped. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Example** | `weighted_avg(A, W)` |\n| **Alias(es)** | `wavg(arg, weight)` |", "position": 37, "token_count": 134, "has_code": false, "section_hierarchy": ["`weighted_avg(arg, weight)`"], "metadata": {"chunk_id": "sql-functions-aggregates-037", "document_id": "sql-functions-aggregates", "position": 37, "token_count": 134, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`weighted_avg(arg, weight)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#weightedavgarg-weight"}}
{"chunk_id": "sql-functions-aggregates-038", "document_id": "sql-functions-aggregates", "content": "## Approximate Aggregates\n\nThe table below shows the available approximate aggregate functions.\n\n| Function | Description | Example |\n|:---|:---|:---|\n| `approx_count_distinct(x)` | Calculates the approximate count of distinct elements using HyperLogLog. | `approx_count_distinct(A)` |\n| `approx_quantile(x, pos)` | Calculates the approximate quantile using T-Digest. | `approx_quantile(A, 0.5)` |\n| `approx_top_k(arg, k)` | Calculates a `LIST` of the `k` approximately most frequent values of `arg` using Filtered Space-Saving. | |\n| `reservoir_quantile(x, quantile, sample_size = 8192)` | Calculates the approximate quantile using reservoir sampling, the sample size is optional and uses 8192 as a default size. | `reservoir_quantile(A, 0.5, 1024)` |", "position": 38, "token_count": 225, "has_code": false, "section_hierarchy": ["Approximate Aggregates"], "metadata": {"chunk_id": "sql-functions-aggregates-038", "document_id": "sql-functions-aggregates", "position": 38, "token_count": 225, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Approximate Aggregates"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#approximate-aggregates"}}
{"chunk_id": "sql-functions-aggregates-039", "document_id": "sql-functions-aggregates", "content": "## Statistical Aggregates\n\nThe table below shows the available statistical aggregate functions.\nThey all ignore `NULL` values (in the case of a single input column `x`), or pairs where either input is `NULL` (in the case of two input columns `y` and `x`).", "position": 39, "token_count": 64, "has_code": false, "section_hierarchy": ["Statistical Aggregates"], "metadata": {"chunk_id": "sql-functions-aggregates-039", "document_id": "sql-functions-aggregates", "position": 39, "token_count": 64, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Statistical Aggregates"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#statistical-aggregates"}}
{"chunk_id": "sql-functions-aggregates-040", "document_id": "sql-functions-aggregates", "content": "| Function | Description |\n|:--|:--------|\n| [`corr(y, x)`](#corry-x) | The correlation coefficient. |\n| [`covar_pop(y, x)`](#covar_popy-x) | The population covariance, which does not include bias correction. |\n| [`covar_samp(y, x)`](#covar_sampy-x) | The sample covariance, which includes Bessel's bias correction. |\n| [`entropy(x)`](#entropyx) | The log-2 entropy. |\n| [`kurtosis_pop(x)`](#kurtosis_popx) | The excess kurtosis (Fisher’s definition) without bias correction. |\n| [`kurtosis(x)`](#kurtosisx) | The excess kurtosis (Fisher's definition) with bias correction according to the sample size. |", "position": 40, "token_count": 223, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-040", "document_id": "sql-functions-aggregates", "position": 40, "token_count": 223, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-041", "document_id": "sql-functions-aggregates", "content": "| [`kurtosis(x)`](#kurtosisx) | The excess kurtosis (Fisher's definition) with bias correction according to the sample size. |\n| [`mad(x)`](#madx) | The median absolute deviation. Temporal types return a positive `INTERVAL`. |\n| [`median(x)`](#medianx) | The middle value of the set. For even value counts, quantitative values are averaged and ordinal values return the lower value. |\n| [`mode(x)`](#modex)| The most frequent value. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| [`quantile_cont(x, pos)`](#quantile_contx-pos) | The interpolated `pos`-quantile of `x` for `0", "position": 41, "token_count": 202, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-041", "document_id": "sql-functions-aggregates", "position": 41, "token_count": 202, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-042", "document_id": "sql-functions-aggregates", "content": "| **Description** | The correlation coefficient.\n| **Formula** | `covar_pop(y, x) / (stddev_pop(x) * stddev_pop(y))` |", "position": 42, "token_count": 52, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-042", "document_id": "sql-functions-aggregates", "position": 42, "token_count": 52, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-043", "document_id": "sql-functions-aggregates", "content": "#### `covar_pop(y, x)`\n\n| **Description** | The population covariance, which does not include bias correction. |\n| **Formula** | `(sum(x*y) - sum(x) * sum(y) / regr_count(y, x)) / regr_count(y, x)`, `covar_samp(y, x) * (1 - 1 / regr_count(y, x))` |", "position": 43, "token_count": 115, "has_code": false, "section_hierarchy": ["`covar_pop(y, x)`"], "metadata": {"chunk_id": "sql-functions-aggregates-043", "document_id": "sql-functions-aggregates", "position": 43, "token_count": 115, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`covar_pop(y, x)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#covarpopy-x"}}
{"chunk_id": "sql-functions-aggregates-044", "document_id": "sql-functions-aggregates", "content": "#### `covar_samp(y, x)`\n\n| **Description** | The sample covariance, which includes Bessel's bias correction. |\n| **Formula** | `(sum(x*y) - sum(x) * sum(y) / regr_count(y, x)) / (regr_count(y, x) - 1)`, `covar_pop(y, x) / (1 - 1 / regr_count(y, x))` |\n| **Alias(es)** | `regr_sxy(y, x)` |\n\n#### `entropy(x)`\n\n| **Description** | The log-2 entropy. |\n| **Formula** | - |\n\n#### `kurtosis_pop(x)`\n\n| **Description** | The excess kurtosis (Fisher’s definition) without bias correction. |\n| **Formula** | - |", "position": 44, "token_count": 221, "has_code": false, "section_hierarchy": ["`kurtosis_pop(x)`"], "metadata": {"chunk_id": "sql-functions-aggregates-044", "document_id": "sql-functions-aggregates", "position": 44, "token_count": 221, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`kurtosis_pop(x)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#kurtosispopx"}}
{"chunk_id": "sql-functions-aggregates-045", "document_id": "sql-functions-aggregates", "content": "#### `kurtosis_pop(x)`\n\n| **Description** | The excess kurtosis (Fisher’s definition) without bias correction. |\n| **Formula** | - |\n\n#### `kurtosis(x)`\n\n| **Description** | The excess kurtosis (Fisher's definition) with bias correction according to the sample size. |\n| **Formula** | - |\n\n#### `mad(x)`\n\n| **Description** | The median absolute deviation. Temporal types return a positive `INTERVAL`. |\n| **Formula** | `median(abs(x - median(x)))` |\n\n#### `median(x)`\n\n| **Description** | The middle value of the set. For even value counts, quantitative values are averaged and ordinal values return the lower value. |\n| **Formula** | `quantile_cont(x, 0.5)` |", "position": 45, "token_count": 213, "has_code": false, "section_hierarchy": ["`median(x)`"], "metadata": {"chunk_id": "sql-functions-aggregates-045", "document_id": "sql-functions-aggregates", "position": 45, "token_count": 213, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`median(x)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#medianx"}}
{"chunk_id": "sql-functions-aggregates-046", "document_id": "sql-functions-aggregates", "content": "#### `mode(x)`\n\n| **Description** | The most frequent value. This function is [affected by ordering](#order-by-clause-in-aggregate-functions). |\n| **Formula** | - |\n\n#### `quantile_cont(x, pos)`\n\n| **Description** | The interpolated `pos`-quantile of `x` for `0\n\n| **Description** | The discrete `pos`-quantile of `x` for `0\n\n| **Description** | The average of the independent variable for non-`NULL` pairs, where x is the independent variable and y is the dependent variable. |\n| **Formula** | - |\n\n#### `regr_avgy(y, x)`\n\n| **Description** | The average of the dependent variable for non-`NULL` pairs, where x is the independent variable and y is the dependent variable. |\n| **Formula** | - |", "position": 46, "token_count": 226, "has_code": false, "section_hierarchy": ["`regr_avgy(y, x)`"], "metadata": {"chunk_id": "sql-functions-aggregates-046", "document_id": "sql-functions-aggregates", "position": 46, "token_count": 226, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`regr_avgy(y, x)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#regravgyy-x"}}
{"chunk_id": "sql-functions-aggregates-047", "document_id": "sql-functions-aggregates", "content": "#### `regr_count(y, x)`\n\n| **Description** | The number of non-`NULL` pairs. |\n| **Formula** | - |\n\n#### `regr_intercept(y, x)`\n\n| **Description** | The intercept of the univariate linear regression line, where x is the independent variable and y is the dependent variable. |\n| **Formula** | `regr_avgy(y, x) - regr_slope(y, x) * regr_avgx(y, x)` |\n\n#### `regr_r2(y, x)`\n\n| **Description** | The squared Pearson correlation coefficient between y and x. Also: The coefficient of determination in a linear regression, where x is the independent variable and y is the dependent variable. |\n| **Formula** | - |", "position": 47, "token_count": 200, "has_code": false, "section_hierarchy": ["`regr_r2(y, x)`"], "metadata": {"chunk_id": "sql-functions-aggregates-047", "document_id": "sql-functions-aggregates", "position": 47, "token_count": 200, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`regr_r2(y, x)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#regrr2y-x"}}
{"chunk_id": "sql-functions-aggregates-048", "document_id": "sql-functions-aggregates", "content": "#### `regr_slope(y, x)`\n\n| **Description** | Returns the slope of the linear regression line, where x is the independent variable and y is the dependent variable. |\n| **Formula** | `regr_sxy(y, x) / regr_sxx(y, x)` |\n| **Alias(es)** | - |\n\n#### `regr_sxx(y, x)`\n\n| **Description** | The sample variance, which includes Bessel's bias correction, of the independent variable for non-`NULL` pairs, where x is the independent variable and y is the dependent variable. |\n| **Formula** | - |", "position": 48, "token_count": 161, "has_code": false, "section_hierarchy": ["`regr_sxx(y, x)`"], "metadata": {"chunk_id": "sql-functions-aggregates-048", "document_id": "sql-functions-aggregates", "position": 48, "token_count": 161, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`regr_sxx(y, x)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#regrsxxy-x"}}
{"chunk_id": "sql-functions-aggregates-049", "document_id": "sql-functions-aggregates", "content": "#### `regr_sxy(y, x)`\n\n| **Description** | The sample covariance, which includes Bessel's bias correction. |\n| **Formula** | `(sum(x*y) - sum(x) * sum(y) / regr_count(y, x)) / (regr_count(y, x) - 1)`, `covar_pop(y, x) / (1 - 1 / regr_count(y, x))` |\n| **Alias(es)** | `covar_samp(y, x)` |\n\n#### `regr_syy(y, x)`\n\n| **Description** | The sample variance, which includes Bessel's bias correction, of the dependent variable for non-`NULL` pairs, where x is the independent variable and y is the dependent variable. |\n| **Formula** | - |", "position": 49, "token_count": 215, "has_code": false, "section_hierarchy": ["`regr_syy(y, x)`"], "metadata": {"chunk_id": "sql-functions-aggregates-049", "document_id": "sql-functions-aggregates", "position": 49, "token_count": 215, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`regr_syy(y, x)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#regrsyyy-x"}}
{"chunk_id": "sql-functions-aggregates-050", "document_id": "sql-functions-aggregates", "content": "#### `sem(x)`\n\n| **Description** | The standard error of the mean. |\n| **Formula** | - |\n\n#### `skewness(x)`\n\n| **Description** | The skewness. |\n| **Formula** | - |\n\n#### `stddev_pop(x)`\n\n| **Description** | The population standard deviation. |\n| **Formula** | `sqrt(var_pop(x))` |\n\n#### `stddev_samp(x)`\n\n| **Description** | The sample standard deviation. |\n| **Formula** | `sqrt(var_samp(x))`|\n| **Alias(es)** | `stddev(x)`|", "position": 50, "token_count": 186, "has_code": false, "section_hierarchy": ["`stddev_samp(x)`"], "metadata": {"chunk_id": "sql-functions-aggregates-050", "document_id": "sql-functions-aggregates", "position": 50, "token_count": 186, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`stddev_samp(x)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#stddevsampx"}}
{"chunk_id": "sql-functions-aggregates-051", "document_id": "sql-functions-aggregates", "content": "#### `var_pop(x)`\n\n| **Description** | The population variance, which does not include bias correction. |\n| **Formula** | `(sum(x^2) - sum(x)^2 / count(x)) / count(x)`, `var_samp(y, x) * (1 - 1 / count(x))` |\n\n#### `var_samp(x)`\n\n| **Description** | The sample variance, which includes Bessel's bias correction. |\n| **Formula** | `(sum(x^2) - sum(x)^2 / count(x)) / (count(x) - 1)`, `var_pop(y, x) / (1 - 1 / count(x))` |\n| **Alias(es)** | `variance(arg, val)` |", "position": 51, "token_count": 206, "has_code": false, "section_hierarchy": ["`var_samp(x)`"], "metadata": {"chunk_id": "sql-functions-aggregates-051", "document_id": "sql-functions-aggregates", "position": 51, "token_count": 206, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`var_samp(x)`"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#varsampx"}}
{"chunk_id": "sql-functions-aggregates-052", "document_id": "sql-functions-aggregates", "content": "## Ordered Set Aggregate Functions\n\nThe table below shows the available “ordered set” aggregate functions.\nThese functions are specified using the `WITHIN GROUP (ORDER BY sort_expression)` syntax,\nand they are converted to an equivalent aggregate function that takes the ordering expression\nas the first argument.", "position": 52, "token_count": 59, "has_code": false, "section_hierarchy": ["Ordered Set Aggregate Functions"], "metadata": {"chunk_id": "sql-functions-aggregates-052", "document_id": "sql-functions-aggregates", "position": 52, "token_count": 59, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Ordered Set Aggregate Functions"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#ordered-set-aggregate-functions"}}
{"chunk_id": "sql-functions-aggregates-053", "document_id": "sql-functions-aggregates", "content": "| Function | Equivalent |\n|:---|:---|\n| mode() WITHIN GROUP (ORDER BY column [(ASC&#124;DESC)]) | mode(column ORDER BY column [(ASC&#124;DESC)]) |\n| percentile_cont(fraction) WITHIN GROUP (ORDER BY column [(ASC&#124;DESC)]) | quantile_cont(column, fraction ORDER BY column [(ASC&#124;DESC)]) |\n| percentile_cont(fractions) WITHIN GROUP (ORDER BY column [(ASC&#124;DESC)]) | quantile_cont(column, fractions ORDER BY column [(ASC&#124;DESC)]) |\n| percentile_disc(fraction) WITHIN GROUP (ORDER BY column [(ASC&#124;DESC)]) | quantile_disc(column, fraction ORDER BY column [(ASC&#124;DESC)]) |", "position": 53, "token_count": 227, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-053", "document_id": "sql-functions-aggregates", "position": 53, "token_count": 227, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-054", "document_id": "sql-functions-aggregates", "content": "| percentile_disc(fractions) WITHIN GROUP (ORDER BY column [(ASC&#124;DESC)]) | quantile_disc(column, fractions ORDER BY column [(ASC&#124;DESC)]) |", "position": 54, "token_count": 57, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-aggregates-054", "document_id": "sql-functions-aggregates", "position": 54, "token_count": 57, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates"}}
{"chunk_id": "sql-functions-aggregates-055", "document_id": "sql-functions-aggregates", "content": "## Miscellaneous Aggregate Functions\n\n| Function | Description | Alias |\n|:--|:---|:--|\n| `grouping()` | For queries with `GROUP BY` and either [`ROLLUP` or `GROUPING SETS`]({% link docs/stable/sql/query_syntax/grouping_sets.md %}#identifying-grouping-sets-with-grouping_id): Returns an integer identifying which of the argument expressions where used to group on to create the current supper-aggregate row. | `grouping_id()` |", "position": 55, "token_count": 124, "has_code": false, "section_hierarchy": ["Miscellaneous Aggregate Functions"], "metadata": {"chunk_id": "sql-functions-aggregates-055", "document_id": "sql-functions-aggregates", "position": 55, "token_count": 124, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Miscellaneous Aggregate Functions"], "file_path": "sql/functions/aggregates.md", "url": "/sql/functions/aggregates", "title": "Aggregate Functions", "category": null, "tags": [], "section_url": "/sql/functions/aggregates#miscellaneous-aggregate-functions"}}

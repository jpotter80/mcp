{"chunk_id": "guides-python-polars-000", "document_id": "guides-python-polars", "content": "[Polars](https://github.com/pola-rs/polars) is a DataFrames library built in Rust with bindings for Python and Node.js. It uses [Apache Arrow's columnar format](https://arrow.apache.org/docs/format/Columnar.html) as its memory model. DuckDB can read Polars DataFrames and convert query results to Polars DataFrames. It does this internally using the efficient Apache Arrow integration. Note that the `pyarrow` library must be installed for the integration to work.\n\n## Installation\n\n```batch\npip install -U duckdb 'polars[pyarrow]'\n```", "position": 0, "token_count": 156, "has_code": true, "section_hierarchy": ["Installation"], "metadata": {"chunk_id": "guides-python-polars-000", "document_id": "guides-python-polars", "position": 0, "token_count": 156, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Installation"], "file_path": "guides/python/polars.md", "url": "/guides/python/polars", "title": "Integration with Polars", "category": null, "tags": [], "section_url": "/guides/python/polars#installation"}}
{"chunk_id": "guides-python-polars-001", "document_id": "guides-python-polars", "content": "## Installation\n\n```batch\npip install -U duckdb 'polars[pyarrow]'\n```\n\n## Polars to DuckDB\n\nDuckDB can natively query Polars DataFrames by referring to the name of Polars DataFrames as they exist in the current scope.\n\n```python\nimport duckdb\nimport polars as pl\n\ndf = pl.DataFrame(\n {\n \"A\": [1, 2, 3, 4, 5],\n \"fruits\": [\"banana\", \"banana\", \"apple\", \"apple\", \"banana\"],\n \"B\": [5, 4, 3, 2, 1],\n \"cars\": [\"beetle\", \"audi\", \"beetle\", \"beetle\", \"beetle\"],\n }\n)\nduckdb.sql(\"SELECT * FROM df\").show()\n```", "position": 1, "token_count": 191, "has_code": true, "section_hierarchy": ["Polars to DuckDB"], "metadata": {"chunk_id": "guides-python-polars-001", "document_id": "guides-python-polars", "position": 1, "token_count": 191, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Polars to DuckDB"], "file_path": "guides/python/polars.md", "url": "/guides/python/polars", "title": "Integration with Polars", "category": null, "tags": [], "section_url": "/guides/python/polars#polars-to-duckdb"}}
{"chunk_id": "guides-python-polars-002", "document_id": "guides-python-polars", "content": "## DuckDB to Polars\n\nDuckDB can output results as Polars DataFrames using the `.pl()` result-conversion method.\n\n```python\ndf = duckdb.sql(\"\"\"\n SELECT 1 AS id, 'banana' AS fruit\n UNION ALL\n SELECT 2, 'apple'\n UNION ALL\n SELECT 3, 'mango'\"\"\"\n).pl()\nprint(df)\n```\n\n```text\nshape: (3, 2)\n┌─────┬────────┐\n│ id ┆ fruit │\n│ --- ┆ --- │\n│ i32 ┆ str │\n╞═════╪════════╡\n│ 1 ┆ banana │\n│ 2 ┆ apple │\n│ 3 ┆ mango │\n└─────┴────────┘\n```\n\nThe optional `lazy` parameter allows returning Polars LazyFrames.\n\n```python\ndf = duckdb.sql(\"\"\"\n SELECT 1 AS id, 'banana' AS fruit\n UNION ALL\n SELECT 2, 'apple'\n UNION ALL\n SELECT 3, 'mango'\"\"\"\n).pl(lazy=True)\nprint(df)", "position": 2, "token_count": 214, "has_code": true, "section_hierarchy": ["DuckDB to Polars"], "metadata": {"chunk_id": "guides-python-polars-002", "document_id": "guides-python-polars", "position": 2, "token_count": 214, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["DuckDB to Polars"], "file_path": "guides/python/polars.md", "url": "/guides/python/polars", "title": "Integration with Polars", "category": null, "tags": [], "section_url": "/guides/python/polars#duckdb-to-polars"}}
{"chunk_id": "guides-python-polars-003", "document_id": "guides-python-polars", "content": "```\n\n```text\nnaive plan: (run LazyFrame.explain(optimized=True) to see the optimized plan)\n\nPYTHON SCAN []\nPROJECT */2 COLUMNS\n```\n\nTo learn more about Polars, feel free to explore their [Python API Reference](https://pola-rs.github.io/polars/py-polars/html/reference/index.html).", "position": 3, "token_count": 96, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-python-polars-003", "document_id": "guides-python-polars", "position": 3, "token_count": 96, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/python/polars.md", "url": "/guides/python/polars", "title": "Integration with Polars", "category": null, "tags": [], "section_url": "/guides/python/polars"}}

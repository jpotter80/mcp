{"chunk_id": "sql-query_syntax-unnest-000", "document_id": "sql-query_syntax-unnest", "content": "## Examples\n\nUnnest a list, generating 3 rows (1, 2, 3):\n\n```sql\nSELECT unnest([1, 2, 3]);\n```\n\nUnnesting a struct, generating two columns (a, b):\n\n```sql\nSELECT unnest({'a': 42, 'b': 84});\n```\n\nRecursive unnest of a list of structs:\n\n```sql\nSELECT unnest([{'a': 42, 'b': 84}, {'a': 100, 'b': NULL}], recursive := true);\n```\n\nLimit depth of recursive unnest using `max_depth`:\n\n```sql\nSELECT unnest([[[1, 2], [3, 4]], [[5, 6], [7, 8, 9], []], [[10, 11]]], max_depth := 2);", "position": 0, "token_count": 227, "has_code": true, "section_hierarchy": ["Examples"], "metadata": {"chunk_id": "sql-query_syntax-unnest-000", "document_id": "sql-query_syntax-unnest", "position": 0, "token_count": 227, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Examples"], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest#examples"}}
{"chunk_id": "sql-query_syntax-unnest-001", "document_id": "sql-query_syntax-unnest", "content": "```\n\nThe `unnest` special function is used to unnest lists or structs by one level. The function can be used as a regular scalar function, but only in the `SELECT` clause. Invoking `unnest` with the `recursive` parameter will unnest lists and structs of multiple levels. The depth of unnesting can be limited using the `max_depth` parameter (which assumes `recursive` unnesting by default).", "position": 1, "token_count": 109, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-query_syntax-unnest-001", "document_id": "sql-query_syntax-unnest", "position": 1, "token_count": 109, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest"}}
{"chunk_id": "sql-query_syntax-unnest-002", "document_id": "sql-query_syntax-unnest", "content": "### Unnesting Lists\n\nUnnest a list, generating 3 rows (1, 2, 3):\n\n```sql\nSELECT unnest([1, 2, 3]);\n```\n\nUnnest a list, generating 3 rows ((1, 10), (2, 10), (3, 10)):\n\n```sql\nSELECT unnest([1, 2, 3]), 10;\n```\n\nUnnest two lists of different sizes, generating 3 rows ((1, 10), (2, 11), (3, NULL)):\n\n```sql\nSELECT unnest([1, 2, 3]), unnest([10, 11]);\n```\nUnnest a list column from a subquery:\n\n```sql\nSELECT unnest(l) + 10 FROM (VALUES ([1, 2, 3]), ([4, 5])) tbl(l);\n```\n\nEmpty result:\n\n```sql\nSELECT unnest([]);", "position": 2, "token_count": 234, "has_code": true, "section_hierarchy": ["Unnesting Lists"], "metadata": {"chunk_id": "sql-query_syntax-unnest-002", "document_id": "sql-query_syntax-unnest", "position": 2, "token_count": 234, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Unnesting Lists"], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest#unnesting-lists"}}
{"chunk_id": "sql-query_syntax-unnest-003", "document_id": "sql-query_syntax-unnest", "content": "```\n\nEmpty result:\n\n```sql\nSELECT unnest([]);\n```\n\nEmpty result:\n\n```sql\nSELECT unnest(NULL);\n```\n\nUsing `unnest` on a list emits one row per list entry. Regular scalar expressions in the same `SELECT` clause are repeated for every emitted row. When multiple lists are unnested in the same `SELECT` clause, the lists are unnested side-by-side. If one list is longer than the other, the shorter list is padded with `NULL` values.\n\nEmpty and `NULL` lists both unnest to zero rows.", "position": 3, "token_count": 138, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-query_syntax-unnest-003", "document_id": "sql-query_syntax-unnest", "position": 3, "token_count": 138, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest"}}
{"chunk_id": "sql-query_syntax-unnest-004", "document_id": "sql-query_syntax-unnest", "content": "### Unnesting Structs\n\nUnnesting a struct, generating two columns (a, b):\n\n```sql\nSELECT unnest({'a': 42, 'b': 84});\n```\n\nUnnesting a struct, generating two columns (a, b):\n\n```sql\nSELECT unnest({'a': 42, 'b': {'x': 84}});\n```\n\n`unnest` on a struct will emit one column per entry in the struct.", "position": 4, "token_count": 128, "has_code": true, "section_hierarchy": ["Unnesting Structs"], "metadata": {"chunk_id": "sql-query_syntax-unnest-004", "document_id": "sql-query_syntax-unnest", "position": 4, "token_count": 128, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Unnesting Structs"], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest#unnesting-structs"}}
{"chunk_id": "sql-query_syntax-unnest-005", "document_id": "sql-query_syntax-unnest", "content": "### Recursive Unnest\n\nUnnesting a list of lists recursively, generating 5 rows (1, 2, 3, 4, 5):\n\n```sql\nSELECT unnest([[1, 2, 3], [4, 5]], recursive := true);\n```\n\nUnnesting a list of structs recursively, generating two rows of two columns (a, b):\n\n```sql\nSELECT unnest([{'a': 42, 'b': 84}, {'a': 100, 'b': NULL}], recursive := true);\n```\n\nUnnesting a struct, generating two columns (a, b):\n\n```sql\nSELECT unnest({'a': [1, 2, 3], 'b': 88}, recursive := true);", "position": 5, "token_count": 202, "has_code": true, "section_hierarchy": ["Recursive Unnest"], "metadata": {"chunk_id": "sql-query_syntax-unnest-005", "document_id": "sql-query_syntax-unnest", "position": 5, "token_count": 202, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Recursive Unnest"], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest#recursive-unnest"}}
{"chunk_id": "sql-query_syntax-unnest-006", "document_id": "sql-query_syntax-unnest", "content": "```\n\nCalling `unnest` with the `recursive` setting will fully unnest lists, followed by fully unnesting structs. This can be useful to fully flatten columns that contain lists within lists, or lists of structs. Note that lists *within* structs are not unnested.", "position": 6, "token_count": 73, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-query_syntax-unnest-006", "document_id": "sql-query_syntax-unnest", "position": 6, "token_count": 73, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest"}}
{"chunk_id": "sql-query_syntax-unnest-007", "document_id": "sql-query_syntax-unnest", "content": "### Setting the Maximum Depth of Unnesting\n\nThe `max_depth` parameter allows limiting the maximum depth of recursive unnesting (which is assumed by default and does not have to be specified separately).\nFor example, unnestig to `max_depth` of 2 yields the following:\n\n```sql\nSELECT unnest([[[1, 2], [3, 4]], [[5, 6], [7, 8, 9], []], [[10, 11]]], max_depth := 2) AS x;", "position": 7, "token_count": 129, "has_code": true, "section_hierarchy": ["Setting the Maximum Depth of Unnesting"], "metadata": {"chunk_id": "sql-query_syntax-unnest-007", "document_id": "sql-query_syntax-unnest", "position": 7, "token_count": 129, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Setting the Maximum Depth of Unnesting"], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest#setting-the-maximum-depth-of-unnesting"}}
{"chunk_id": "sql-query_syntax-unnest-008", "document_id": "sql-query_syntax-unnest", "content": "```\n\n| x |\n|-----------|\n| [1, 2] |\n| [3, 4] |\n| [5, 6] |\n| [7, 8, 9] |\n| [] |\n| [10, 11] |\n\nMeanwhile, unnesting to `max_depth` of 3 results in:\n\n```sql\nSELECT unnest([[[1, 2], [3, 4]], [[5, 6], [7, 8, 9], []], [[10, 11]]], max_depth := 3) AS x;\n```\n\n| x |\n|---:|\n| 1 |\n| 2 |\n| 3 |\n| 4 |\n| 5 |\n| 6 |\n| 7 |\n| 8 |\n| 9 |\n| 10 |\n| 11 |", "position": 8, "token_count": 185, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-query_syntax-unnest-008", "document_id": "sql-query_syntax-unnest", "position": 8, "token_count": 185, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest"}}
{"chunk_id": "sql-query_syntax-unnest-009", "document_id": "sql-query_syntax-unnest", "content": "### Keeping Track of List Entry Positions\n\nTo keep track of each entry's position within the original list, `unnest` may be combined with [`generate_subscripts`]({% link docs/stable/sql/functions/list.md %}#generate_subscripts):\n\n```sql\nSELECT unnest(l) AS x, generate_subscripts(l, 1) AS index\nFROM (VALUES ([1, 2, 3]), ([4, 5])) tbl(l);\n```\n\n| x | index |\n|--:|------:|\n| 1 | 1 |\n| 2 | 2 |\n| 3 | 3 |\n| 4 | 1 |\n| 5 | 2 |", "position": 9, "token_count": 168, "has_code": true, "section_hierarchy": ["Keeping Track of List Entry Positions"], "metadata": {"chunk_id": "sql-query_syntax-unnest-009", "document_id": "sql-query_syntax-unnest", "position": 9, "token_count": 168, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Keeping Track of List Entry Positions"], "file_path": "sql/query_syntax/unnest.md", "url": "/sql/query_syntax/unnest", "title": "Unnesting", "category": null, "tags": [], "section_url": "/sql/query_syntax/unnest#keeping-track-of-list-entry-positions"}}

{"chunk_id": "guides-file_formats-excel_export-000", "document_id": "guides-file_formats-excel_export", "content": "DuckDB supports exporting data to Excel `.xlsx` files via the `excel` extension. Please note that `.xls` files are not supported.\n\nTo install and load the extension, run:\n\n```sql\nINSTALL excel;\nLOAD excel;\n```", "position": 0, "token_count": 59, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-file_formats-excel_export-000", "document_id": "guides-file_formats-excel_export", "position": 0, "token_count": 59, "has_code": true, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "guides/file_formats/excel_export.md", "url": "/guides/file_formats/excel_export", "title": "Excel Export", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_export"}}
{"chunk_id": "guides-file_formats-excel_export-001", "document_id": "guides-file_formats-excel_export", "content": "## Exporting Excel Sheets\n\nTo export a table to an Excel file, use the `COPY` statement with the `FORMAT xlsx` option:\n\n```sql\nCOPY tbl TO 'output.xlsx' WITH (FORMAT xlsx);\n```\n\nThe result of a query can also be directly exported to an Excel file:\n\n```sql\nCOPY (SELECT * FROM tbl) TO 'output.xlsx' WITH (FORMAT xlsx);\n```\n\nOr:\n\n```sql\nCOPY (SELECT * FROM tbl) TO 'output.xlsx';\n```\n\nTo write the column names as the first row in the Excel file, use the `HEADER` option:\n\n```sql\nCOPY tbl TO 'output.xlsx' WITH (FORMAT xlsx, HEADER true);\n```\n\nTo name the worksheet in the resulting Excel file, use the `SHEET` option:\n\n```sql\nCOPY tbl TO 'output.xlsx' WITH (FORMAT xlsx, SHEET 'Sheet1');\n```", "position": 1, "token_count": 232, "has_code": true, "section_hierarchy": ["Exporting Excel Sheets"], "metadata": {"chunk_id": "guides-file_formats-excel_export-001", "document_id": "guides-file_formats-excel_export", "position": 1, "token_count": 232, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Exporting Excel Sheets"], "file_path": "guides/file_formats/excel_export.md", "url": "/guides/file_formats/excel_export", "title": "Excel Export", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_export#exporting-excel-sheets"}}
{"chunk_id": "guides-file_formats-excel_export-002", "document_id": "guides-file_formats-excel_export", "content": "## Type Conversions\n\nBecause Excel only really supports storing numbers or strings â€“ the equivalent of `VARCHAR` and `DOUBLE`, the following type conversions are automatically applied when writing XLSX files:\n\n* Numeric types are cast to `DOUBLE`.\n* Temporal types (`TIMESTAMP`, `DATE`, `TIME`, etc.) are converted to Excel \"serial\" numbers, that is the number of days since 1900-01-01 for dates and the fraction of a day for times. These are then styled with a \"number format\" so that they appear as dates or times when opened in Excel.\n* `TIMESTAMP_TZ` and `TIME_TZ` are cast to UTC `TIMESTAMP` and `TIME` respectively, with the timezone information being lost.\n* `BOOLEAN`s are converted to `1` and `0`, with a \"number format\" applied to make them appear as `TRUE` and `FALSE` in Excel.\n* All other types are cast to `VARCHAR` and then written as text cells.", "position": 2, "token_count": 227, "has_code": false, "section_hierarchy": ["Type Conversions"], "metadata": {"chunk_id": "guides-file_formats-excel_export-002", "document_id": "guides-file_formats-excel_export", "position": 2, "token_count": 227, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Type Conversions"], "file_path": "guides/file_formats/excel_export.md", "url": "/guides/file_formats/excel_export", "title": "Excel Export", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_export#type-conversions"}}
{"chunk_id": "guides-file_formats-excel_export-003", "document_id": "guides-file_formats-excel_export", "content": "But you can of course also explicitly cast columns to a different type before exporting them to Excel:\n\n```sql\nCOPY (SELECT CAST(a AS VARCHAR), b FROM tbl) TO 'output.xlsx' WITH (FORMAT xlsx);", "position": 3, "token_count": 59, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-file_formats-excel_export-003", "document_id": "guides-file_formats-excel_export", "position": 3, "token_count": 59, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/file_formats/excel_export.md", "url": "/guides/file_formats/excel_export", "title": "Excel Export", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_export"}}
{"chunk_id": "guides-file_formats-excel_export-004", "document_id": "guides-file_formats-excel_export", "content": "```", "position": 4, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-file_formats-excel_export-004", "document_id": "guides-file_formats-excel_export", "position": 4, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/file_formats/excel_export.md", "url": "/guides/file_formats/excel_export", "title": "Excel Export", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_export"}}
{"chunk_id": "guides-file_formats-excel_export-005", "document_id": "guides-file_formats-excel_export", "content": "## See Also\n\nDuckDB can also [import Excel files]({% link docs/stable/guides/file_formats/excel_import.md %}).\nFor additional details on Excel support, see the [`excel` extension page]({% link docs/stable/core_extensions/excel.md %}).", "position": 5, "token_count": 75, "has_code": false, "section_hierarchy": ["See Also"], "metadata": {"chunk_id": "guides-file_formats-excel_export-005", "document_id": "guides-file_formats-excel_export", "position": 5, "token_count": 75, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["See Also"], "file_path": "guides/file_formats/excel_export.md", "url": "/guides/file_formats/excel_export", "title": "Excel Export", "category": null, "tags": [], "section_url": "/guides/file_formats/excel_export#see-also"}}

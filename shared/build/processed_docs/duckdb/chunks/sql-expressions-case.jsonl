{"chunk_id": "sql-expressions-case-000", "document_id": "sql-expressions-case", "content": "The `CASE` expression performs a switch based on a condition. The basic form is identical to the ternary condition used in many programming languages (`CASE WHEN cond THEN a ELSE b END` is equivalent to `cond ? a : b`). With a single condition this can be expressed with `IF(cond, a, b)`.\n\n```sql\nCREATE OR REPLACE TABLE integers AS SELECT unnest([1, 2, 3]) AS i;\nSELECT i, CASE WHEN i > 2 THEN 1 ELSE 0 END AS test\nFROM integers;\n```\n\n| i | test |\n|--:|-----:|\n| 1 | 0 |\n| 2 | 0 |\n| 3 | 1 |\n\nThis is equivalent to:\n\n```sql\nSELECT i, IF(i > 2, 1, 0) AS test\nFROM integers;", "position": 0, "token_count": 182, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-expressions-case-000", "document_id": "sql-expressions-case", "position": 0, "token_count": 182, "has_code": true, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "sql/expressions/case.md", "url": "/sql/expressions/case", "title": "CASE Expression", "category": null, "tags": [], "section_url": "/sql/expressions/case"}}
{"chunk_id": "sql-expressions-case-001", "document_id": "sql-expressions-case", "content": "```\n\nThe `WHEN cond THEN expr` part of the `CASE` expression can be chained, whenever any of the conditions returns true for a single tuple, the corresponding expression is evaluated and returned.\n\n```sql\nCREATE OR REPLACE TABLE integers AS SELECT unnest([1, 2, 3]) AS i;\nSELECT i, CASE WHEN i = 1 THEN 10 WHEN i = 2 THEN 20 ELSE 0 END AS test\nFROM integers;\n```\n\n| i | test |\n|--:|-----:|\n| 1 | 10 |\n| 2 | 20 |\n| 3 | 0 |\n\nThe `ELSE` clause of the `CASE` expression is optional. If no `ELSE` clause is provided and none of the conditions match, the `CASE` expression will return `NULL`.\n\n```sql\nCREATE OR REPLACE TABLE integers AS SELECT unnest([1, 2, 3]) AS i;\nSELECT i, CASE WHEN i = 1 THEN 10 END AS test\nFROM integers;", "position": 1, "token_count": 213, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-expressions-case-001", "document_id": "sql-expressions-case", "position": 1, "token_count": 213, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/expressions/case.md", "url": "/sql/expressions/case", "title": "CASE Expression", "category": null, "tags": [], "section_url": "/sql/expressions/case"}}
{"chunk_id": "sql-expressions-case-002", "document_id": "sql-expressions-case", "content": "```\n\n| i | test |\n|--:|-----:|\n| 1 | 10 |\n| 2 | NULL |\n| 3 | NULL |\n\nIt is also possible to provide an individual expression after the `CASE` but before the `WHEN`. When this is done, the `CASE` expression is effectively transformed into a switch statement.\n\n```sql\nCREATE OR REPLACE TABLE integers AS SELECT unnest([1, 2, 3]) AS i;\nSELECT i, CASE i WHEN 1 THEN 10 WHEN 2 THEN 20 WHEN 3 THEN 30 END AS test\nFROM integers;\n```\n\n| i | test |\n|--:|-----:|\n| 1 | 10 |\n| 2 | 20 |\n| 3 | 30 |\n\nThis is equivalent to:\n\n```sql\nSELECT i, CASE WHEN i = 1 THEN 10 WHEN i = 2 THEN 20 WHEN i = 3 THEN 30 END AS test\nFROM integers;\n```", "position": 2, "token_count": 200, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-expressions-case-002", "document_id": "sql-expressions-case", "position": 2, "token_count": 200, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/expressions/case.md", "url": "/sql/expressions/case", "title": "CASE Expression", "category": null, "tags": [], "section_url": "/sql/expressions/case"}}

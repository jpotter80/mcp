{"chunk_id": "core_extensions-azure-000", "document_id": "core_extensions-azure", "content": "The `azure` extension is a loadable extension that adds a filesystem abstraction for the [Azure Blob storage](https://azure.microsoft.com/en-us/products/storage/blobs) to DuckDB.\n\n## Installing and Loading\n\nThe `azure` extension will be transparently [autoloaded]({% link docs/stable/core_extensions/overview.md %}#autoloading-extensions) on first use from the official extension repository.\nIf you would like to install and load it manually, run:\n\n```sql\nINSTALL azure;\nLOAD azure;\n```", "position": 0, "token_count": 132, "has_code": true, "section_hierarchy": ["Installing and Loading"], "metadata": {"chunk_id": "core_extensions-azure-000", "document_id": "core_extensions-azure", "position": 0, "token_count": 132, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["Installing and Loading"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#installing-and-loading"}}
{"chunk_id": "core_extensions-azure-001", "document_id": "core_extensions-azure", "content": "## Usage\n\nOnce the [authentication](#authentication) is set up, you can query Azure storage as follows:", "position": 1, "token_count": 26, "has_code": false, "section_hierarchy": ["Usage"], "metadata": {"chunk_id": "core_extensions-azure-001", "document_id": "core_extensions-azure", "position": 1, "token_count": 26, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Usage"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#usage"}}
{"chunk_id": "core_extensions-azure-002", "document_id": "core_extensions-azure", "content": "### Azure Blob Storage\n\nAllowed URI schemes: `az` or `azure`\n\n```sql\nSELECT count(*)\nFROM 'az://⟨my_container⟩/⟨path⟩/⟨my_file⟩.⟨parquet_or_csv⟩';\n```\n\nGlobs are also supported:\n\n```sql\nSELECT *\nFROM 'az://⟨my_container⟩/⟨path⟩/*.csv';\n```\n\n```sql\nSELECT *\nFROM 'az://⟨my_container⟩/⟨path⟩/**';\n```\n\nOr with a fully qualified path syntax:\n\n```sql\nSELECT count(*)\nFROM 'az://⟨my_storage_account⟩.blob.core.windows.net/⟨my_container⟩/⟨path⟩/⟨my_file⟩.⟨parquet_or_csv⟩';\n```\n\n```sql\nSELECT *\nFROM 'az://⟨my_storage_account⟩.blob.core.windows.net/⟨my_container⟩/⟨path⟩/*.csv';\n```", "position": 2, "token_count": 254, "has_code": true, "section_hierarchy": ["Azure Blob Storage"], "metadata": {"chunk_id": "core_extensions-azure-002", "document_id": "core_extensions-azure", "position": 2, "token_count": 254, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Azure Blob Storage"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#azure-blob-storage"}}
{"chunk_id": "core_extensions-azure-003", "document_id": "core_extensions-azure", "content": "### Azure Data Lake Storage (ADLS)\n\nAllowed URI schemes: `abfss`\n\n```sql\nSELECT count(*)\nFROM 'abfss://⟨my_filesystem⟩/⟨path⟩/⟨my_file⟩.⟨parquet_or_csv⟩';\n```\n\nGlobs are also supported:\n\n```sql\nSELECT *\nFROM 'abfss://⟨my_filesystem⟩/⟨path⟩/*.csv';\n```\n\n```sql\nSELECT *\nFROM 'abfss://⟨my_filesystem⟩/⟨path⟩/**';\n```\n\nOr with a fully qualified path syntax:\n\n```sql\nSELECT count(*)\nFROM 'abfss://⟨my_storage_account⟩.dfs.core.windows.net/⟨my_filesystem⟩/⟨path⟩/⟨my_file⟩.⟨parquet_or_csv⟩';", "position": 3, "token_count": 218, "has_code": true, "section_hierarchy": ["Azure Data Lake Storage (ADLS)"], "metadata": {"chunk_id": "core_extensions-azure-003", "document_id": "core_extensions-azure", "position": 3, "token_count": 218, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Azure Data Lake Storage (ADLS)"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#azure-data-lake-storage-adls"}}
{"chunk_id": "core_extensions-azure-004", "document_id": "core_extensions-azure", "content": "```\n\n```sql\nSELECT *\nFROM 'abfss://⟨my_storage_account⟩.dfs.core.windows.net/⟨my_filesystem⟩/⟨path⟩/*.csv';\n```", "position": 4, "token_count": 57, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-004", "document_id": "core_extensions-azure", "position": 4, "token_count": 57, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-005", "document_id": "core_extensions-azure", "content": "## Configuration\n\nUse the following [configuration options]({% link docs/stable/configuration/overview.md %}) how the extension reads remote files:", "position": 5, "token_count": 36, "has_code": false, "section_hierarchy": ["Configuration"], "metadata": {"chunk_id": "core_extensions-azure-005", "document_id": "core_extensions-azure", "position": 5, "token_count": 36, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Configuration"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#configuration"}}
{"chunk_id": "core_extensions-azure-006", "document_id": "core_extensions-azure", "content": "| Name | Description | Type | Default |\n|:---|:---|:---|:---|\n| `azure_http_stats` | Include HTTP info from Azure Storage in the [`EXPLAIN ANALYZE` statement]({% link docs/stable/dev/profiling.md %}). | `BOOLEAN` | `false` |\n| `azure_read_transfer_concurrency` | Maximum number of threads the Azure client can use for a single parallel read. If `azure_read_transfer_chunk_size` is less than `azure_read_buffer_size` then setting this > 1 will allow the Azure client to do concurrent requests to fill the buffer. | `BIGINT` | `5` |\n| `azure_read_transfer_chunk_size` | Maximum size in bytes that the Azure client will read in a single request. It is recommended that this is a factor of `azure_read_buffer_size`. | `BIGINT` | `1024*1024` |", "position": 6, "token_count": 225, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-006", "document_id": "core_extensions-azure", "position": 6, "token_count": 225, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-007", "document_id": "core_extensions-azure", "content": "| `azure_read_buffer_size` | Size of the read buffer. It is recommended that this is evenly divisible by `azure_read_transfer_chunk_size`. | `UBIGINT` | `1024*1024` |\n| `azure_transport_option_type` | Underlying [adapter](https://github.com/Azure/azure-sdk-for-cpp/blob/main/doc/HttpTransportAdapter.md) to use in the Azure SDK. Valid values are: `default` or `curl`. | `VARCHAR` | `default` |\n| `azure_context_caching` | Enable/disable the caching of the underlying Azure SDK HTTP connection in the DuckDB connection context when performing queries. If you suspect that this is causing some side effect, you can try to disable it by setting it to false (not recommended). | `BOOLEAN` | `true` |", "position": 7, "token_count": 220, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-007", "document_id": "core_extensions-azure", "position": 7, "token_count": 220, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-008", "document_id": "core_extensions-azure", "content": "> Setting `azure_transport_option_type` explicitly to `curl` will have the following effect:\n> * On Linux, this may solve certificate issue (`Error: Invalid Error: Fail to get a new connection for: https://storage_account_name.blob.core.windows.net/. Problem with the SSL CA cert (path? access rights?)`) because when specifying the extension will try to find the bundle certificate in various paths (that is not done by *curl* by default and might be wrong due to static linking).\n> * On Windows, this replaces the default adapter (*WinHTTP*) allowing you to use all *curl* capabilities (for example using a socks proxies).\n> * On all operating systems, it will honor the following environment variables:\n> * `CURL_CA_INFO`: Path to a PEM encoded file containing the certificate authorities sent to libcurl. Note that this option is known to only work on Linux and might throw if set on other platforms.", "position": 8, "token_count": 225, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-008", "document_id": "core_extensions-azure", "position": 8, "token_count": 225, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-009", "document_id": "core_extensions-azure", "content": "> * `CURL_CA_INFO`: Path to a PEM encoded file containing the certificate authorities sent to libcurl. Note that this option is known to only work on Linux and might throw if set on other platforms.\n> * `CURL_CA_PATH`: Path to a directory which holds PEM encoded files, containing the certificate authorities sent to libcurl.", "position": 9, "token_count": 82, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-009", "document_id": "core_extensions-azure", "position": 9, "token_count": 82, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-010", "document_id": "core_extensions-azure", "content": "Example:\n\n```sql\nSET azure_http_stats = false;\nSET azure_read_transfer_concurrency = 5;\nSET azure_read_transfer_chunk_size = 1_048_576;\nSET azure_read_buffer_size = 1_048_576;", "position": 10, "token_count": 64, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-010", "document_id": "core_extensions-azure", "position": 10, "token_count": 64, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-011", "document_id": "core_extensions-azure", "content": "```", "position": 11, "token_count": 5, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-011", "document_id": "core_extensions-azure", "position": 11, "token_count": 5, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-012", "document_id": "core_extensions-azure", "content": "## Authentication\n\nThe Azure extension has two ways to configure the authentication. The preferred way is to use Secrets.", "position": 12, "token_count": 27, "has_code": false, "section_hierarchy": ["Authentication"], "metadata": {"chunk_id": "core_extensions-azure-012", "document_id": "core_extensions-azure", "position": 12, "token_count": 27, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Authentication"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#authentication"}}
{"chunk_id": "core_extensions-azure-013", "document_id": "core_extensions-azure", "content": "### Authentication with Secret\n\nMultiple [Secret Providers]({% link docs/stable/configuration/secrets_manager.md %}#secret-providers) are available for the Azure extension:\n\n* If you need to define different secrets for different storage accounts, use the [`SCOPE` configuration]({% link docs/stable/configuration/secrets_manager.md %}#creating-multiple-secrets-for-the-same-service-type). Note that the `SCOPE` requires a trailing slash (`SCOPE 'azure://some_container/'`).\n* If you use fully qualified path then the `ACCOUNT_NAME` attribute is optional.", "position": 13, "token_count": 144, "has_code": false, "section_hierarchy": ["Authentication with Secret"], "metadata": {"chunk_id": "core_extensions-azure-013", "document_id": "core_extensions-azure", "position": 13, "token_count": 144, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Authentication with Secret"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#authentication-with-secret"}}
{"chunk_id": "core_extensions-azure-014", "document_id": "core_extensions-azure", "content": "#### `CONFIG` Provider\n\nThe default provider, `CONFIG` (i.e., user-configured), allows access to the storage account using a connection string or anonymously. For example:\n\n```sql\nCREATE SECRET secret1 (\n TYPE azure,\n CONNECTION_STRING '⟨value⟩'\n);\n```\n\nIf you do not use authentication, you still need to specify the storage account name. For example:\n\n```sql\nCREATE SECRET secret2 (\n TYPE azure,\n PROVIDER config,\n ACCOUNT_NAME '⟨storage_account_name⟩'\n);\n```\n\nThe default `PROVIDER` is `CONFIG`.", "position": 14, "token_count": 140, "has_code": true, "section_hierarchy": ["`CONFIG` Provider"], "metadata": {"chunk_id": "core_extensions-azure-014", "document_id": "core_extensions-azure", "position": 14, "token_count": 140, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`CONFIG` Provider"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#config-provider"}}
{"chunk_id": "core_extensions-azure-015", "document_id": "core_extensions-azure", "content": "#### `credential_chain` Provider\n\nThe `credential_chain` provider allows connecting using credentials automatically fetched by the Azure SDK via the Azure credential chain.\nBy default, the `DefaultAzureCredential` chain used, which tries credentials according to the order specified by the [Azure documentation](https://learn.microsoft.com/en-us/javascript/api/@azure/identity/defaultazurecredential?view=azure-node-latest#@azure-identity-defaultazurecredential-constructor).\nFor example:\n\n```sql\nCREATE SECRET secret3 (\n TYPE azure,\n PROVIDER credential_chain,\n ACCOUNT_NAME '⟨storage_account_name⟩'\n);", "position": 15, "token_count": 164, "has_code": true, "section_hierarchy": ["`credential_chain` Provider"], "metadata": {"chunk_id": "core_extensions-azure-015", "document_id": "core_extensions-azure", "position": 15, "token_count": 164, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`credential_chain` Provider"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#credentialchain-provider"}}
{"chunk_id": "core_extensions-azure-016", "document_id": "core_extensions-azure", "content": "```\n\nDuckDB also allows specifying a specific chain using the `CHAIN` keyword. This takes a semicolon-separated list (`a;b;c`) of providers that will be tried in order. For example:\n\n```sql\nCREATE SECRET secret4 (\n TYPE azure,\n PROVIDER credential_chain,\n CHAIN 'cli;env',\n ACCOUNT_NAME '⟨storage_account_name⟩'\n);", "position": 16, "token_count": 94, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-016", "document_id": "core_extensions-azure", "position": 16, "token_count": 94, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-017", "document_id": "core_extensions-azure", "content": "```\n\nThe possible values are the following:\n[`cli`](https://learn.microsoft.com/en-us/cli/azure/authenticate-azure-cli);\n[`managed_identity`](https://learn.microsoft.com/en-us/entra/identity/managed-identities-azure-resources/overview);\n[`workload_identity`](https://learn.microsoft.com/en-us/entra/workload-id/workload-identities-overview);\n[`env`](https://github.com/Azure/azure-sdk-for-cpp/blob/azure-identity_1.6.0/sdk/identity/azure-identity/README.md#environment-variables);\n[`default`](https://github.com/Azure/azure-sdk-for-cpp/blob/azure-identity_1.6.0/sdk/identity/azure-identity/README.md#defaultazurecredential);", "position": 17, "token_count": 250, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-017", "document_id": "core_extensions-azure", "position": 17, "token_count": 250, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-018", "document_id": "core_extensions-azure", "content": "If no explicit `CHAIN` is provided, the default one will be [`default`](https://github.com/Azure/azure-sdk-for-cpp/blob/azure-identity_1.6.0/sdk/identity/azure-identity/README.md#defaultazurecredential)", "position": 18, "token_count": 79, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-018", "document_id": "core_extensions-azure", "position": 18, "token_count": 79, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-019", "document_id": "core_extensions-azure", "content": "#### Managed Identity\n\nManaged Identity (MI) can be used gracefully and automatically via the `credential_chain`. In typical\ncases where the executor has a single MI available, no configuration is needed.\n\nIf your execution environment has multiple Identities, use the `MANAGED_IDENTITY` provider and specify\nwhich identity to use. This provider allows identity specification via one of\n`CLIENT_ID`, `OBJECT_ID` or `RESOURCE_ID`, e.g.:\n\n```sql\nCREATE SECRET secret1 (\n TYPE AZURE,\n PROVIDER MANAGED_IDENTITY,\n ACCOUNT_NAME '⟨storage account name⟩',\n CLIENT_ID '⟨used-assigned managed identity client id⟩'\n);\n```\n\nThe provider may be used without specifying an ID; if only a single ID is available this provider\nwill function identically to the `credential_chain` provider, and use the single available ID. If\nmultiple IDs are available, behavior is undefined (or more specifically, defined by the Azure SDK)\n– therefore we recommend explicit Identity setting in this situation.", "position": 19, "token_count": 226, "has_code": true, "section_hierarchy": ["Managed Identity"], "metadata": {"chunk_id": "core_extensions-azure-019", "document_id": "core_extensions-azure", "position": 19, "token_count": 226, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Managed Identity"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#managed-identity"}}
{"chunk_id": "core_extensions-azure-020", "document_id": "core_extensions-azure", "content": "#### `SERVICE_PRINCIPAL` Provider\n\nThe `SERVICE_PRINCIPAL` provider allows connecting using a [Azure Service Principal (SPN)](https://learn.microsoft.com/en-us/entra/architecture/service-accounts-principal).\n\nEither with a secret:\n\n```sql\nCREATE SECRET azure_spn (\n TYPE azure,\n PROVIDER service_principal,\n TENANT_ID '⟨tenant_id⟩',\n CLIENT_ID '⟨client_id⟩',\n CLIENT_SECRET '⟨client_secret⟩',\n ACCOUNT_NAME '⟨storage_account_name⟩'\n);\n```\n\nOr with a certificate:\n\n```sql\nCREATE SECRET azure_spn_cert (\n TYPE azure,\n PROVIDER service_principal,\n TENANT_ID '⟨tenant_id⟩',\n CLIENT_ID '⟨client_id⟩',\n CLIENT_CERTIFICATE_PATH '⟨client_cert_path⟩',\n ACCOUNT_NAME '⟨storage_account_name⟩'\n);\n```", "position": 20, "token_count": 215, "has_code": true, "section_hierarchy": ["`SERVICE_PRINCIPAL` Provider"], "metadata": {"chunk_id": "core_extensions-azure-020", "document_id": "core_extensions-azure", "position": 20, "token_count": 215, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`SERVICE_PRINCIPAL` Provider"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#serviceprincipal-provider"}}
{"chunk_id": "core_extensions-azure-021", "document_id": "core_extensions-azure", "content": "#### Configuring a Proxy\n\nTo configure proxy information when using secrets, you can add `HTTP_PROXY`, `PROXY_USER_NAME`, and `PROXY_PASSWORD` in the secret definition. For example:\n\n```sql\nCREATE SECRET secret5 (\n TYPE azure,\n CONNECTION_STRING '⟨value⟩',\n HTTP_PROXY 'http://localhost:3128',\n PROXY_USER_NAME 'john',\n PROXY_PASSWORD 'doe'\n);\n```\n\n> * When using secrets, the `HTTP_PROXY` environment variable will still be honored except if you provide an explicit value for it.\n> * When using secrets, the `SET` variable of the *Authentication with variables* session will be ignored.\n> * The Azure `credential_chain` provider, the actual token is fetched at query time, not when the secret is created.", "position": 21, "token_count": 192, "has_code": true, "section_hierarchy": ["Configuring a Proxy"], "metadata": {"chunk_id": "core_extensions-azure-021", "document_id": "core_extensions-azure", "position": 21, "token_count": 192, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Configuring a Proxy"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#configuring-a-proxy"}}
{"chunk_id": "core_extensions-azure-022", "document_id": "core_extensions-azure", "content": "### Authentication with Variables (Deprecated)\n\n```sql\nSET variable_name = variable_value;", "position": 22, "token_count": 26, "has_code": true, "section_hierarchy": ["Authentication with Variables (Deprecated)"], "metadata": {"chunk_id": "core_extensions-azure-022", "document_id": "core_extensions-azure", "position": 22, "token_count": 26, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Authentication with Variables (Deprecated)"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#authentication-with-variables-deprecated"}}
{"chunk_id": "core_extensions-azure-023", "document_id": "core_extensions-azure", "content": "```\n\nWhere `variable_name` can be one of the following:", "position": 23, "token_count": 18, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-023", "document_id": "core_extensions-azure", "position": 23, "token_count": 18, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-024", "document_id": "core_extensions-azure", "content": "| Name | Description | Type | Default |\n|:---|:---|:---|:---|\n| `azure_storage_connection_string` | Azure connection string, used for authenticating and configuring Azure requests. | `STRING` | - |\n| `azure_account_name` | Azure account name, when set, the extension will attempt to automatically detect credentials (not used if you pass the connection string). | `STRING` | - |\n| `azure_endpoint` | Override the Azure endpoint for when the Azure credential providers are used. | `STRING` | `blob.core.windows.net` |", "position": 24, "token_count": 150, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-024", "document_id": "core_extensions-azure", "position": 24, "token_count": 150, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-025", "document_id": "core_extensions-azure", "content": "| `azure_endpoint` | Override the Azure endpoint for when the Azure credential providers are used. | `STRING` | `blob.core.windows.net` |\n| `azure_credential_chain`| Ordered list of Azure credential providers, in string format separated by `;`. For example: `'cli;managed_identity;env'`. See the list of possible values in the [`credential_chain` provider section](#credential_chain-provider). Not used if you pass the connection string. | `STRING` | - |\n| `azure_http_proxy` | Proxy to use when login & performing request to Azure. | `STRING` | `HTTP_PROXY` environment variable (if set). |\n| `azure_proxy_user_name` | HTTP proxy username if needed. | `STRING` | - |\n| `azure_proxy_password` | HTTP proxy password if needed. | `STRING` | - |", "position": 25, "token_count": 222, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-025", "document_id": "core_extensions-azure", "position": 25, "token_count": 222, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-026", "document_id": "core_extensions-azure", "content": "## Additional Information\n\n### Logging\n\nThe Azure extension relies on the Azure SDK to connect to Azure Blob storage and supports printing the SDK logs to the console.\nTo control the log level, set the [`AZURE_LOG_LEVEL`](https://github.com/Azure/azure-sdk-for-cpp/blob/main/sdk/core/azure-core/README.md#sdk-log-messages) environment variable.\n\nFor instance, verbose logs can be enabled in Python as follows:\n\n```python\nimport os\nimport duckdb\n\nos.environ[\"AZURE_LOG_LEVEL\"] = \"verbose\"\n\nduckdb.sql(\"CREATE SECRET myaccount (TYPE azure, PROVIDER credential_chain, SCOPE 'az://myaccount.blob.core.windows.net/')\")\nduckdb.sql(\"SELECT count(*) FROM 'az://myaccount.blob.core.windows.net/path/to/blob.parquet'\")\n```", "position": 26, "token_count": 246, "has_code": true, "section_hierarchy": ["Logging"], "metadata": {"chunk_id": "core_extensions-azure-026", "document_id": "core_extensions-azure", "position": 26, "token_count": 246, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Logging"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#logging"}}
{"chunk_id": "core_extensions-azure-027", "document_id": "core_extensions-azure", "content": "### Difference between ADLS and Blob Storage\n\nEven though ADLS implements similar functionality as the Blob storage, there are some important performance benefits to using the ADLS endpoints for globbing, especially when using (complex) glob patterns.\n\nTo demonstrate, let's look at an example of how a glob is performed internally using the Blob and ADLS endpoints, respectively.\n\nUsing the following filesystem:", "position": 27, "token_count": 96, "has_code": false, "section_hierarchy": ["Difference between ADLS and Blob Storage"], "metadata": {"chunk_id": "core_extensions-azure-027", "document_id": "core_extensions-azure", "position": 27, "token_count": 96, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Difference between ADLS and Blob Storage"], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure#difference-between-adls-and-blob-storage"}}
{"chunk_id": "core_extensions-azure-028", "document_id": "core_extensions-azure", "content": "To demonstrate, let's look at an example of how a glob is performed internally using the Blob and ADLS endpoints, respectively.\n\nUsing the following filesystem:\n\n```text\nroot\n├── l_receipmonth=1997-10\n│ ├── l_shipmode=AIR\n│ │ └── data_0.csv\n│ ├── l_shipmode=SHIP\n│ │ └── data_0.csv\n│ └── l_shipmode=TRUCK\n│ └── data_0.csv\n├── l_receipmonth=1997-11\n│ ├── l_shipmode=AIR\n│ │ └── data_0.csv\n│ ├── l_shipmode=SHIP\n│ │ └── data_0.csv\n│ └── l_shipmode=TRUCK\n│ └── data_0.csv\n└── l_receipmonth=1997-12\n ├── l_shipmode=AIR\n │ └── data_0.csv\n ├── l_shipmode=SHIP\n │ └── data_0.csv\n └── l_shipmode=TRUCK\n └── data_0.csv", "position": 28, "token_count": 235, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-028", "document_id": "core_extensions-azure", "position": 28, "token_count": 235, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-029", "document_id": "core_extensions-azure", "content": "```\n\nThe following query is performed through the Blob endpoint:\n\n```sql\nSELECT count(*)\nFROM 'az://root/l_receipmonth=1997-*/l_shipmode=SHIP/*.csv';", "position": 29, "token_count": 61, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-029", "document_id": "core_extensions-azure", "position": 29, "token_count": 61, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-030", "document_id": "core_extensions-azure", "content": "```\n\nIt will perform the following steps:", "position": 30, "token_count": 12, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-030", "document_id": "core_extensions-azure", "position": 30, "token_count": 12, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-031", "document_id": "core_extensions-azure", "content": "* List all the files with the prefix `root/l_receipmonth=1997-`\n * `root/l_receipmonth=1997-10/l_shipmode=SHIP/data_0.csv`\n * `root/l_receipmonth=1997-10/l_shipmode=AIR/data_0.csv`\n * `root/l_receipmonth=1997-10/l_shipmode=TRUCK/data_0.csv`\n * `root/l_receipmonth=1997-11/l_shipmode=SHIP/data_0.csv`\n * `root/l_receipmonth=1997-11/l_shipmode=AIR/data_0.csv`\n * `root/l_receipmonth=1997-11/l_shipmode=TRUCK/data_0.csv`", "position": 31, "token_count": 210, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-031", "document_id": "core_extensions-azure", "position": 31, "token_count": 210, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-032", "document_id": "core_extensions-azure", "content": "* `root/l_receipmonth=1997-11/l_shipmode=TRUCK/data_0.csv`\n * `root/l_receipmonth=1997-12/l_shipmode=SHIP/data_0.csv`\n * `root/l_receipmonth=1997-12/l_shipmode=AIR/data_0.csv`\n * `root/l_receipmonth=1997-12/l_shipmode=TRUCK/data_0.csv`\n* Filter the result with the requested pattern `root/l_receipmonth=1997-*/l_shipmode=SHIP/*.csv`\n * `root/l_receipmonth=1997-10/l_shipmode=SHIP/data_0.csv`\n * `root/l_receipmonth=1997-11/l_shipmode=SHIP/data_0.csv`", "position": 32, "token_count": 224, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-032", "document_id": "core_extensions-azure", "position": 32, "token_count": 224, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-033", "document_id": "core_extensions-azure", "content": "* `root/l_receipmonth=1997-11/l_shipmode=SHIP/data_0.csv`\n * `root/l_receipmonth=1997-12/l_shipmode=SHIP/data_0.csv`", "position": 33, "token_count": 64, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-033", "document_id": "core_extensions-azure", "position": 33, "token_count": 64, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-034", "document_id": "core_extensions-azure", "content": "Meanwhile, the same query can be performed through the datalake endpoint as follows:\n\n```sql\nSELECT count(*)\nFROM 'abfss://root/l_receipmonth=1997-*/l_shipmode=SHIP/*.csv';", "position": 34, "token_count": 64, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-034", "document_id": "core_extensions-azure", "position": 34, "token_count": 64, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-035", "document_id": "core_extensions-azure", "content": "```\n\nThis will perform the following steps:", "position": 35, "token_count": 12, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-035", "document_id": "core_extensions-azure", "position": 35, "token_count": 12, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-036", "document_id": "core_extensions-azure", "content": "* List all directories in `root/`\n * `root/l_receipmonth=1997-10`\n * `root/l_receipmonth=1997-11`\n * `root/l_receipmonth=1997-12`\n* Filter and list subdirectories: `root/l_receipmonth=1997-10`, `root/l_receipmonth=1997-11`, `root/l_receipmonth=1997-12`\n * `root/l_receipmonth=1997-10/l_shipmode=SHIP`\n * `root/l_receipmonth=1997-10/l_shipmode=AIR`\n * `root/l_receipmonth=1997-10/l_shipmode=TRUCK`\n * `root/l_receipmonth=1997-11/l_shipmode=SHIP`", "position": 36, "token_count": 213, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-036", "document_id": "core_extensions-azure", "position": 36, "token_count": 213, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-037", "document_id": "core_extensions-azure", "content": "* `root/l_receipmonth=1997-11/l_shipmode=SHIP`\n * `root/l_receipmonth=1997-11/l_shipmode=AIR`\n * `root/l_receipmonth=1997-11/l_shipmode=TRUCK`\n * `root/l_receipmonth=1997-12/l_shipmode=SHIP`\n * `root/l_receipmonth=1997-12/l_shipmode=AIR`\n * `root/l_receipmonth=1997-12/l_shipmode=TRUCK`\n* Filter and list subdirectories: `root/l_receipmonth=1997-10/l_shipmode=SHIP`, `root/l_receipmonth=1997-11/l_shipmode=SHIP`, `root/l_receipmonth=1997-12/l_shipmode=SHIP`", "position": 37, "token_count": 227, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-037", "document_id": "core_extensions-azure", "position": 37, "token_count": 227, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-038", "document_id": "core_extensions-azure", "content": "* `root/l_receipmonth=1997-10/l_shipmode=SHIP/data_0.csv`\n * `root/l_receipmonth=1997-11/l_shipmode=SHIP/data_0.csv`\n * `root/l_receipmonth=1997-12/l_shipmode=SHIP/data_0.csv`", "position": 38, "token_count": 95, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-038", "document_id": "core_extensions-azure", "position": 38, "token_count": 95, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}
{"chunk_id": "core_extensions-azure-039", "document_id": "core_extensions-azure", "content": "As you can see because the Blob endpoint does not support the notion of directories, the filter can only be performed after the listing, whereas the ADLS endpoint will list files recursively. Especially with higher partition/directory counts, the performance difference can be very significant.", "position": 39, "token_count": 61, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-azure-039", "document_id": "core_extensions-azure", "position": 39, "token_count": 61, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/azure.md", "url": "/core_extensions/azure", "title": "Azure Extension", "category": null, "tags": [], "section_url": "/core_extensions/azure"}}

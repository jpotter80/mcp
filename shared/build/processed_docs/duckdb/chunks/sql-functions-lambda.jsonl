{"chunk_id": "sql-functions-lambda-000", "document_id": "sql-functions-lambda", "content": "> Deprecated DuckDB 1.3.0 deprecated the old lambda single arrow syntax (`x -> x + 1`)\n> in favor of the Python-style syntax (`lambda x : x + 1`).\n>\n> DuckDB 1.3.0 also introduces a new setting to configure the lambda syntax.\n>\n> ```sql\n> SET lambda_syntax = 'DEFAULT';\n> SET lambda_syntax = 'ENABLE_SINGLE_ARROW';\n> SET lambda_syntax = 'DISABLE_SINGLE_ARROW';\n>", "position": 0, "token_count": 121, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-lambda-000", "document_id": "sql-functions-lambda", "position": 0, "token_count": 121, "has_code": true, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda"}}
{"chunk_id": "sql-functions-lambda-001", "document_id": "sql-functions-lambda", "content": "```\n>\n> Currently, `DEFAULT` enables both syntax styles, i.e.,\n> the old single arrow syntax and the Python-style syntax.\n>\n> DuckDB 1.4.0 will be the last release supporting the single arrow syntax without explicitly enabling it.\n>\n> DuckDB 1.5.0 disables the single arrow syntax on default.\n>\n> DuckDB 1.6.0 removes the `lambda_syntax` flag and fully deprecates the single arrow syntax,\n> so the old behavior will no longer be possible.\n\nLambda functions enable the use of more complex and flexible expressions in queries.\nDuckDB supports several scalar functions that operate on [`LIST`s]({% link docs/stable/sql/data_types/list.md %}) and\naccept lambda functions as parameters\nin the form `lambda ⟨parameter1⟩, ⟨parameter2⟩, ... : ⟨expression⟩`{:.language-sql .highlight}.\nIf the lambda function has only one parameter, then the parentheses can be omitted.\nThe parameters can have any names.\nFor example, the following are all valid lambda functions:", "position": 1, "token_count": 242, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-lambda-001", "document_id": "sql-functions-lambda", "position": 1, "token_count": 242, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda"}}
{"chunk_id": "sql-functions-lambda-002", "document_id": "sql-functions-lambda", "content": "* `lambda param : param > 1`{:.language-sql .highlight}\n* `lambda s : contains(concat(s, 'DB'), 'duck')`{:.language-sql .highlight}\n* `lambda acc, x : acc + x`{:.language-sql .highlight}", "position": 2, "token_count": 73, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-lambda-002", "document_id": "sql-functions-lambda", "position": 2, "token_count": 73, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda"}}
{"chunk_id": "sql-functions-lambda-003", "document_id": "sql-functions-lambda", "content": "## Scalar Functions That Accept Lambda Functions", "position": 3, "token_count": 11, "has_code": false, "section_hierarchy": ["Scalar Functions That Accept Lambda Functions"], "metadata": {"chunk_id": "sql-functions-lambda-003", "document_id": "sql-functions-lambda", "position": 3, "token_count": 11, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Scalar Functions That Accept Lambda Functions"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#scalar-functions-that-accept-lambda-functions"}}
{"chunk_id": "sql-functions-lambda-004", "document_id": "sql-functions-lambda", "content": "| Function | Description |\n|:--|:-------|\n| [`apply(list, lambda(x))`](#list_transformlist-lambdax) | Alias for `list_transform`. |\n| [`array_apply(list, lambda(x))`](#list_transformlist-lambdax) | Alias for `list_transform`. |\n| [`array_filter(list, lambda(x))`](#list_filterlist-lambdax) | Alias for `list_filter`. |\n| [`array_reduce(list, lambda(x, y)[, initial_value])`](#list_reducelist-lambdax-y-initial_value) | Alias for `list_reduce`. |\n| [`array_transform(list, lambda(x))`](#list_transformlist-lambdax) | Alias for `list_transform`. |", "position": 4, "token_count": 213, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-lambda-004", "document_id": "sql-functions-lambda", "position": 4, "token_count": 213, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda"}}
{"chunk_id": "sql-functions-lambda-005", "document_id": "sql-functions-lambda", "content": "| [`array_transform(list, lambda(x))`](#list_transformlist-lambdax) | Alias for `list_transform`. |\n| [`filter(list, lambda(x))`](#list_filterlist-lambdax) | Alias for `list_filter`. |\n| [`list_apply(list, lambda(x))`](#list_transformlist-lambdax) | Alias for `list_transform`. |\n| [`list_filter(list, lambda(x))`](#list_filterlist-lambdax) | Constructs a list from those elements of the input `list` for which the `lambda` function returns `true`. DuckDB must be able to cast the `lambda` function's return type to `BOOL`. The return type of `list_filter` is the same as the input list's. See [`list_filter` examples]({% link docs/stable/sql/functions/lambda.md %}#list_filter-examples). |", "position": 5, "token_count": 237, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-lambda-005", "document_id": "sql-functions-lambda", "position": 5, "token_count": 237, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda"}}
{"chunk_id": "sql-functions-lambda-006", "document_id": "sql-functions-lambda", "content": "| [`list_reduce(list, lambda(x, y)[, initial_value])`](#list_reducelist-lambdax-y-initial_value) | Reduces all elements of the input `list` into a single scalar value by executing the `lambda` function on a running result and the next list element. The `lambda` function has an optional `initial_value` argument. See [`list_reduce` examples]({% link docs/stable/sql/functions/lambda.md %}#list_reduce-examples). |\n| [`list_transform(list, lambda(x))`](#list_transformlist-lambdax) | Returns a list that is the result of applying the `lambda` function to each element of the input `list`. The return type is defined by the return type of the `lambda` function. See [`list_transform` examples]({% link docs/stable/sql/functions/lambda.md %}#list_transform-examples). |", "position": 6, "token_count": 229, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-lambda-006", "document_id": "sql-functions-lambda", "position": 6, "token_count": 229, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda"}}
{"chunk_id": "sql-functions-lambda-007", "document_id": "sql-functions-lambda", "content": "| [`reduce(list, lambda(x, y)[, initial_value])`](#list_reducelist-lambdax-y-initial_value) | Alias for `list_reduce`. |", "position": 7, "token_count": 50, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-lambda-007", "document_id": "sql-functions-lambda", "position": 7, "token_count": 50, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda"}}
{"chunk_id": "sql-functions-lambda-008", "document_id": "sql-functions-lambda", "content": "#### `list_filter(list, lambda(x))`\n\n| **Description** | Constructs a list from those elements of the input `list` for which the `lambda` function returns `true`. DuckDB must be able to cast the `lambda` function's return type to `BOOL`. The return type of `list_filter` is the same as the input list's. See [`list_filter` examples]({% link docs/stable/sql/functions/lambda.md %}#list_filter-examples). |\n| **Example** | `list_filter([3, 4, 5], lambda x : x > 4)` |\n| **Result** | `[5]` |\n| **Aliases** | `array_filter`, `filter` |", "position": 8, "token_count": 188, "has_code": false, "section_hierarchy": ["`list_filter(list, lambda(x))`"], "metadata": {"chunk_id": "sql-functions-lambda-008", "document_id": "sql-functions-lambda", "position": 8, "token_count": 188, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`list_filter(list, lambda(x))`"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#listfilterlist-lambdax"}}
{"chunk_id": "sql-functions-lambda-009", "document_id": "sql-functions-lambda", "content": "#### `list_reduce(list, lambda(x, y)[, initial_value])`\n\n| **Description** | Reduces all elements of the input `list` into a single scalar value by executing the `lambda` function on a running result and the next list element. The `lambda` function has an optional `initial_value` argument. See [`list_reduce` examples]({% link docs/stable/sql/functions/lambda.md %}#list_reduce-examples). |\n| **Example** | `list_reduce([1, 2, 3], lambda x, y : x + y)` |\n| **Result** | `6` |\n| **Aliases** | `array_reduce`, `reduce` |", "position": 9, "token_count": 177, "has_code": false, "section_hierarchy": ["`list_reduce(list, lambda(x, y)[, initial_value])`"], "metadata": {"chunk_id": "sql-functions-lambda-009", "document_id": "sql-functions-lambda", "position": 9, "token_count": 177, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`list_reduce(list, lambda(x, y)[, initial_value])`"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#listreducelist-lambdax-y-initialvalue"}}
{"chunk_id": "sql-functions-lambda-010", "document_id": "sql-functions-lambda", "content": "#### `list_transform(list, lambda(x))`\n\n| **Description** | Returns a list that is the result of applying the `lambda` function to each element of the input `list`. The return type is defined by the return type of the `lambda` function. See [`list_transform` examples]({% link docs/stable/sql/functions/lambda.md %}#list_transform-examples). |\n| **Example** | `list_transform([1, 2, 3], lambda x : x + 1)` |\n| **Result** | `[2, 3, 4]` |\n| **Aliases** | `apply`, `array_apply`, `array_transform`, `list_apply` |", "position": 10, "token_count": 178, "has_code": false, "section_hierarchy": ["`list_transform(list, lambda(x))`"], "metadata": {"chunk_id": "sql-functions-lambda-010", "document_id": "sql-functions-lambda", "position": 10, "token_count": 178, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["`list_transform(list, lambda(x))`"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#listtransformlist-lambdax"}}
{"chunk_id": "sql-functions-lambda-011", "document_id": "sql-functions-lambda", "content": "## Nesting Lambda Functions\n\nAll scalar functions can be arbitrarily nested. For example, nested lambda functions to get all squares of even list elements:\n\n```sql\nSELECT list_transform(\n list_filter([0, 1, 2, 3, 4, 5], lambda x: x % 2 = 0),\n lambda y: y * y\n );\n```\n\n```text\n[0, 4, 16]\n```\n\nNested lambda function to add each element of the first list to the sum of the second list:\n\n```sql\nSELECT list_transform(\n [1, 2, 3],\n lambda x :\n list_reduce([4, 5, 6], lambda a, b: a + b) + x\n );\n```\n\n```text\n[16, 17, 18]\n```", "position": 11, "token_count": 180, "has_code": true, "section_hierarchy": ["Nesting Lambda Functions"], "metadata": {"chunk_id": "sql-functions-lambda-011", "document_id": "sql-functions-lambda", "position": 11, "token_count": 180, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Nesting Lambda Functions"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#nesting-lambda-functions"}}
{"chunk_id": "sql-functions-lambda-012", "document_id": "sql-functions-lambda", "content": "## Scoping\n\nLambda functions confirm to scoping rules in the following order:\n\n* inner lambda parameters\n* outer lambda parameters\n* column names\n* macro parameters\n\n```sql\nCREATE TABLE tbl (x INTEGER);\nINSERT INTO tbl VALUES (10);\nSELECT list_apply(\n [1, 2],\n lambda x: list_apply([4], lambda x: x + tbl.x)[1] + x\n )\nFROM tbl;\n```\n\n```text\n[15, 16]\n```\n\n## Indexes as Parameters\n\nAll lambda functions accept an optional extra parameter that represents the index of the current element.\nThis is always the last parameter of the lambda function (e.g., `i` in `(x, i)`), and is 1-based (i.e., the first element has index 1).\n\nGet all elements that are larger than their index:\n\n```sql\nSELECT list_filter([1, 3, 1, 5], lambda x, i: x > i);\n```\n\n```text\n[3, 5]\n```", "position": 12, "token_count": 236, "has_code": true, "section_hierarchy": ["Indexes as Parameters"], "metadata": {"chunk_id": "sql-functions-lambda-012", "document_id": "sql-functions-lambda", "position": 12, "token_count": 236, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Indexes as Parameters"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#indexes-as-parameters"}}
{"chunk_id": "sql-functions-lambda-013", "document_id": "sql-functions-lambda", "content": "## Examples\n\n### `list_transform` Examples\n\nIncrementing each list element by one:\n\n```sql\nSELECT list_transform([1, 2, NULL, 3], lambda x: x + 1);\n```\n\n```text\n[2, 3, NULL, 4]\n```\n\nTransforming strings:\n\n```sql\nSELECT list_transform(['Duck', 'Goose', 'Sparrow'], lambda s: concat(s, 'DB'));\n```\n\n```text\n[DuckDB, GooseDB, SparrowDB]\n```\n\nCombining lambda functions with other functions:\n\n```sql\nSELECT list_transform([5, NULL, 6], lambda x: coalesce(x, 0) + 1);\n```\n\n```text\n[6, 1, 7]\n```", "position": 13, "token_count": 185, "has_code": true, "section_hierarchy": ["`list_transform` Examples"], "metadata": {"chunk_id": "sql-functions-lambda-013", "document_id": "sql-functions-lambda", "position": 13, "token_count": 185, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`list_transform` Examples"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#listtransform-examples"}}
{"chunk_id": "sql-functions-lambda-014", "document_id": "sql-functions-lambda", "content": "### `list_filter` Examples\n\nFilter out negative values:\n\n```sql\nSELECT list_filter([5, -6, NULL, 7], lambda x: x > 0);\n```\n\n```text\n[5, 7]\n```\n\nDivisible by 2 and 5:\n\n```sql\nSELECT list_filter(\n list_filter([2, 4, 3, 1, 20, 10, 3, 30], lambda x: x % 2 = 0),\n lambda y: y % 5 = 0\n );\n```\n\n```text\n[20, 10, 30]\n```\n\nIn combination with `range(...)` to construct lists:\n\n```sql\nSELECT list_filter([1, 2, 3, 4], lambda x: x > #1) FROM range(4);\n```\n\n```text\n[1, 2, 3, 4]\n[2, 3, 4]\n[3, 4]\n[4]\n```", "position": 14, "token_count": 217, "has_code": true, "section_hierarchy": ["`list_filter` Examples"], "metadata": {"chunk_id": "sql-functions-lambda-014", "document_id": "sql-functions-lambda", "position": 14, "token_count": 217, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`list_filter` Examples"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#listfilter-examples"}}
{"chunk_id": "sql-functions-lambda-015", "document_id": "sql-functions-lambda", "content": "### `list_reduce` Examples\n\nSum of all list elements:\n\n```sql\nSELECT list_reduce([1, 2, 3, 4], lambda acc, x: acc + x);\n```\n\n```text\n10\n```\n\nOnly add up list elements if they are greater than 2:\n\n```sql\nSELECT list_reduce(\n list_filter([1, 2, 3, 4], lambda x: x > 2),\n lambda acc, x: acc + x\n );\n```\n\n```text\n7\n```\n\nConcat all list elements:\n\n```sql\nSELECT list_reduce(['DuckDB', 'is', 'awesome'], lambda acc, x: concat(acc, ' ', x));\n```\n\n```text\nDuckDB is awesome", "position": 15, "token_count": 179, "has_code": true, "section_hierarchy": ["`list_reduce` Examples"], "metadata": {"chunk_id": "sql-functions-lambda-015", "document_id": "sql-functions-lambda", "position": 15, "token_count": 179, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`list_reduce` Examples"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#listreduce-examples"}}
{"chunk_id": "sql-functions-lambda-016", "document_id": "sql-functions-lambda", "content": "```\n\n```text\nDuckDB is awesome\n```\n\nConcatenate elements with the index without an initial value:\n\n```sql\nSELECT list_reduce(\n ['a', 'b', 'c', 'd'],\n lambda x, y, i: x || ' - ' || CAST(i AS VARCHAR) || ' - ' || y\n );\n```\n\n```text\na - 2 - b - 3 - c - 4 - d\n```\n\nConcatenate elements with the index with an initial value:\n\n```sql\nSELECT list_reduce(\n ['a', 'b', 'c', 'd'],\n lambda x, y, i: x || ' - ' || CAST(i AS VARCHAR) || ' - ' || y, 'INITIAL'\n );\n```\n\n```text\nINITIAL - 1 - a - 2 - b - 3 - c - 4 - d\n```", "position": 16, "token_count": 214, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-functions-lambda-016", "document_id": "sql-functions-lambda", "position": 16, "token_count": 214, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda"}}
{"chunk_id": "sql-functions-lambda-017", "document_id": "sql-functions-lambda", "content": "## Limitations\n\nSubqueries in lambda expressions are currently not supported.\nFor example:\n\n```sql\nSELECT list_apply([1, 2, 3], lambda x: (SELECT 42) + x);\n```\n\n```console\nBinder Error:\nsubqueries in lambda expressions are not supported\n```", "position": 17, "token_count": 70, "has_code": true, "section_hierarchy": ["Limitations"], "metadata": {"chunk_id": "sql-functions-lambda-017", "document_id": "sql-functions-lambda", "position": 17, "token_count": 70, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Limitations"], "file_path": "sql/functions/lambda.md", "url": "/sql/functions/lambda", "title": "Lambda Functions", "category": null, "tags": [], "section_url": "/sql/functions/lambda#limitations"}}

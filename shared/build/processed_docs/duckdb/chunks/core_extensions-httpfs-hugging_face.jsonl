{"chunk_id": "core_extensions-httpfs-hugging_face-000", "document_id": "core_extensions-httpfs-hugging_face", "content": "The `httpfs` extension introduces support for the `hf://` protocol to access datasets hosted in [Hugging Face](https://huggingface.co/) repositories.\nSee the [announcement blog post]({% post_url 2024-05-29-access-150k-plus-datasets-from-hugging-face-with-duckdb %}) for details.", "position": 0, "token_count": 95, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-000", "document_id": "core_extensions-httpfs-hugging_face", "position": 0, "token_count": 95, "has_code": false, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face"}}
{"chunk_id": "core_extensions-httpfs-hugging_face-001", "document_id": "core_extensions-httpfs-hugging_face", "content": "## Usage\n\nHugging Face repositories can be queried using the following URL pattern:\n\n```text\nhf://datasets/⟨my_username⟩/⟨my_dataset⟩/⟨path_to_file⟩\n```\n\nFor example, to read a CSV file, you can use the following query:\n\n```sql\nSELECT *\nFROM 'hf://datasets/datasets-examples/doc-formats-csv-1/data.csv';", "position": 1, "token_count": 114, "has_code": true, "section_hierarchy": ["Usage"], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-001", "document_id": "core_extensions-httpfs-hugging_face", "position": 1, "token_count": 114, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Usage"], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face#usage"}}
{"chunk_id": "core_extensions-httpfs-hugging_face-002", "document_id": "core_extensions-httpfs-hugging_face", "content": "```\n\nWhere:\n\n* `datasets-examples` is the name of the user/organization\n* `doc-formats-csv-1` is the name of the dataset repository\n* `data.csv` is the file path in the repository\n\nThe result of the query is:\n\n| kind | sound |\n|---------|-------|\n| dog | woof |\n| cat | meow |\n| pokemon | pika |\n| human | hello |\n\nTo read a JSONL file, you can run:\n\n```sql\nSELECT *\nFROM 'hf://datasets/datasets-examples/doc-formats-jsonl-1/data.jsonl';\n```\n\nFinally, for reading a Parquet file, use the following query:\n\n```sql\nSELECT *\nFROM 'hf://datasets/datasets-examples/doc-formats-parquet-1/data/train-00000-of-00001.parquet';", "position": 2, "token_count": 227, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-002", "document_id": "core_extensions-httpfs-hugging_face", "position": 2, "token_count": 227, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face"}}
{"chunk_id": "core_extensions-httpfs-hugging_face-003", "document_id": "core_extensions-httpfs-hugging_face", "content": "```\n\nEach of these commands reads the data from the specified file format and displays it in a structured tabular format. Choose the appropriate command based on the file format you are working with.", "position": 3, "token_count": 41, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-003", "document_id": "core_extensions-httpfs-hugging_face", "position": 3, "token_count": 41, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face"}}
{"chunk_id": "core_extensions-httpfs-hugging_face-004", "document_id": "core_extensions-httpfs-hugging_face", "content": "## Creating a Local Table\n\nTo avoid accessing the remote endpoint for every query, you can save the data in a DuckDB table by running a [`CREATE TABLE ... AS` command]({% link docs/stable/sql/statements/create_table.md %}#create-table--as-select-ctas). For example:\n\n```sql\nCREATE TABLE data AS\n SELECT *\n FROM 'hf://datasets/datasets-examples/doc-formats-csv-1/data.csv';\n```\n\nThen, simply query the `data` table as follows:\n\n```sql\nSELECT *\nFROM data;\n```", "position": 4, "token_count": 150, "has_code": true, "section_hierarchy": ["Creating a Local Table"], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-004", "document_id": "core_extensions-httpfs-hugging_face", "position": 4, "token_count": 150, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Creating a Local Table"], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face#creating-a-local-table"}}
{"chunk_id": "core_extensions-httpfs-hugging_face-005", "document_id": "core_extensions-httpfs-hugging_face", "content": "## Multiple Files\n\nTo query all files under a specific directory, you can use a [glob pattern]({% link docs/stable/data/multiple_files/overview.md %}#multi-file-reads-and-globs). For example:\n\n```sql\nSELECT count(*) AS count\nFROM 'hf://datasets/cais/mmlu/astronomy/*.parquet';\n```\n\n| count |\n|------:|\n| 173 |\n\nBy using glob patterns, you can efficiently handle large datasets and perform comprehensive queries across multiple files, simplifying your data inspections and processing tasks.\nHere, you can see how you can look for questions that contain the word “planet” in astronomy:\n\n```sql\nSELECT count(*) AS count\nFROM 'hf://datasets/cais/mmlu/astronomy/*.parquet'\nWHERE question LIKE '%planet%';\n```\n\n| count |\n|------:|\n| 21 |", "position": 5, "token_count": 233, "has_code": true, "section_hierarchy": ["Multiple Files"], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-005", "document_id": "core_extensions-httpfs-hugging_face", "position": 5, "token_count": 233, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Multiple Files"], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face#multiple-files"}}
{"chunk_id": "core_extensions-httpfs-hugging_face-006", "document_id": "core_extensions-httpfs-hugging_face", "content": "## Versioning and Revisions\n\nIn Hugging Face repositories, dataset versions or revisions are different dataset updates. Each version is a snapshot at a specific time, allowing you to track changes and improvements. In git terms, it can be understood as a branch or specific commit.\n\nYou can query different dataset versions/revisions by using the following URL:\n\n```sql\nhf://datasets/⟨my_username⟩/⟨my_dataset⟩@⟨my_branch⟩/⟨path_to_file⟩\n```\n\nFor example:\n\n```sql\nSELECT *\nFROM 'hf://datasets/datasets-examples/doc-formats-csv-1@~parquet/**/*.parquet';", "position": 6, "token_count": 169, "has_code": true, "section_hierarchy": ["Versioning and Revisions"], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-006", "document_id": "core_extensions-httpfs-hugging_face", "position": 6, "token_count": 169, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Versioning and Revisions"], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face#versioning-and-revisions"}}
{"chunk_id": "core_extensions-httpfs-hugging_face-007", "document_id": "core_extensions-httpfs-hugging_face", "content": "```\n\n| kind | sound |\n|---------|-------|\n| dog | woof |\n| cat | meow |\n| pokemon | pika |\n| human | hello |\n\nThe previous query will read all Parquet files under the `~parquet` revision. This is a special branch where Hugging Face automatically generates the Parquet files of every dataset to enable efficient scanning.", "position": 7, "token_count": 93, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-007", "document_id": "core_extensions-httpfs-hugging_face", "position": 7, "token_count": 93, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face"}}
{"chunk_id": "core_extensions-httpfs-hugging_face-008", "document_id": "core_extensions-httpfs-hugging_face", "content": "## Authentication\n\nConfigure your Hugging Face Token in the DuckDB Secrets Manager to access private or gated datasets.\nFirst, visit [Hugging Face Settings – Tokens](https://huggingface.co/settings/tokens) to obtain your access token.\nSecond, set it in your DuckDB session using DuckDB’s [Secrets Manager]({% link docs/stable/configuration/secrets_manager.md %}). DuckDB supports two providers for managing secrets:\n\n### `CONFIG`\n\nThe user must pass all configuration information into the `CREATE SECRET` statement. To create a secret using the `CONFIG` provider, use the following command:\n\n```sql\nCREATE SECRET hf_token (\n TYPE huggingface,\n TOKEN 'your_hf_token'\n);\n```", "position": 8, "token_count": 178, "has_code": true, "section_hierarchy": ["`CONFIG`"], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-008", "document_id": "core_extensions-httpfs-hugging_face", "position": 8, "token_count": 178, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`CONFIG`"], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face#config"}}
{"chunk_id": "core_extensions-httpfs-hugging_face-009", "document_id": "core_extensions-httpfs-hugging_face", "content": "### `credential_chain`\n\nAutomatically tries to fetch credentials. For the Hugging Face token, it will try to get it from `~/.cache/huggingface/token`. To create a secret using the `credential_chain` provider, use the following command:\n\n```sql\nCREATE SECRET hf_token (\n TYPE huggingface,\n PROVIDER credential_chain\n);\n```", "position": 9, "token_count": 89, "has_code": true, "section_hierarchy": ["`credential_chain`"], "metadata": {"chunk_id": "core_extensions-httpfs-hugging_face-009", "document_id": "core_extensions-httpfs-hugging_face", "position": 9, "token_count": 89, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`credential_chain`"], "file_path": "core_extensions/httpfs/hugging_face.md", "url": "/core_extensions/httpfs/hugging_face", "title": "Hugging Face Support", "category": null, "tags": [], "section_url": "/core_extensions/httpfs/hugging_face#credentialchain"}}

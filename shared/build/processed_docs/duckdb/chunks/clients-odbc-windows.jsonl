{"chunk_id": "clients-odbc-windows-000", "document_id": "clients-odbc-windows", "content": "## Setup\n\nUsing the DuckDB ODBC API on Windows requires the following steps:\n\n1. The Microsoft Windows requires an ODBC Driver Manager to manage communication between applications and the ODBC drivers.\n The Driver Manager on Windows is provided in a DLL file `odbccp32.dll`, and other files and tools.\n For detailed information check out the [Common ODBC Component Files](https://docs.microsoft.com/en-us/previous-versions/windows/desktop/odbc/dn170563(v=vs.85)).\n\n2. DuckDB releases the ODBC driver as an asset. For Windows, download it from the [Windows ODBC asset (x86_64/AMD64)](https://github.com/duckdb/duckdb-odbc/releases/download/v{{ site.current_duckdb_odbc_version }}/duckdb_odbc-windows-amd64.zip).\n\n3. The archive contains the following artifacts:", "position": 0, "token_count": 236, "has_code": false, "section_hierarchy": ["Setup"], "metadata": {"chunk_id": "clients-odbc-windows-000", "document_id": "clients-odbc-windows", "position": 0, "token_count": 236, "has_code": false, "overlap_with_previous": false, "section_hierarchy": ["Setup"], "file_path": "clients/odbc/windows.md", "url": "/clients/odbc/windows", "title": "ODBC API on Windows", "category": null, "tags": [], "section_url": "/clients/odbc/windows#setup"}}
{"chunk_id": "clients-odbc-windows-001", "document_id": "clients-odbc-windows", "content": "3. The archive contains the following artifacts:\n\n * `duckdb_odbc.dll`: the DuckDB driver compiled for Windows.\n * `duckdb_odbc_setup.dll`: a setup DLL used by the Windows ODBC Data Source Administrator tool.\n * `odbc_install.exe`: an installation script to aid the configuration on Windows.\n\n Decompress the archive to a directory (e.g., `duckdb_odbc`).\n\n4. The `odbc_install.exe` binary performs the configuration of the DuckDB ODBC Driver on Windows. It depends on the `Odbccp32.dll` that provides functions to configure the ODBC registry entries.\n\n Inside the permanent directory (e.g., `duckdb_odbc`), double-click on the `odbc_install.exe`.\n\n Windows administrator privileges are required. In case of a non-administrator, a User Account Control prompt will occur.", "position": 1, "token_count": 224, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-odbc-windows-001", "document_id": "clients-odbc-windows", "position": 1, "token_count": 224, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/odbc/windows.md", "url": "/clients/odbc/windows", "title": "ODBC API on Windows", "category": null, "tags": [], "section_url": "/clients/odbc/windows"}}
{"chunk_id": "clients-odbc-windows-002", "document_id": "clients-odbc-windows", "content": "Windows administrator privileges are required. In case of a non-administrator, a User Account Control prompt will occur.\n\n5. `odbc_install.exe` adds a default DSN configuration into the ODBC registries with a default database `:memory:`.", "position": 2, "token_count": 59, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-odbc-windows-002", "document_id": "clients-odbc-windows", "position": 2, "token_count": 59, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/odbc/windows.md", "url": "/clients/odbc/windows", "title": "ODBC API on Windows", "category": null, "tags": [], "section_url": "/clients/odbc/windows"}}
{"chunk_id": "clients-odbc-windows-003", "document_id": "clients-odbc-windows", "content": "### DSN Windows Setup\n\nAfter the installation, it is possible to change the default DSN configuration or add a new one using the Windows ODBC Data Source Administrator tool `odbcad32.exe`.\n\nIt also can be launched thought the Windows start:\n\n### Default DuckDB DSN\n\nThe newly installed DSN is visible on the ***System DSN*** in the Windows ODBC Data Source Administrator tool:\n\n![Windows ODBC Config Tool](/images/blog/odbc/odbcad32_exe.png)\n\n### Changing DuckDB DSN\n\nWhen selecting the default DSN (i.e., `DuckDB`) or adding a new configuration, the following setup window will display:\n\n![DuckDB Windows DSN Setup](/images/blog/odbc/duckdb_DSN_setup.png)\n\nThis window allows you to set the DSN and the database file path associated with that DSN.", "position": 3, "token_count": 217, "has_code": false, "section_hierarchy": ["Changing DuckDB DSN"], "metadata": {"chunk_id": "clients-odbc-windows-003", "document_id": "clients-odbc-windows", "position": 3, "token_count": 217, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Changing DuckDB DSN"], "file_path": "clients/odbc/windows.md", "url": "/clients/odbc/windows", "title": "ODBC API on Windows", "category": null, "tags": [], "section_url": "/clients/odbc/windows#changing-duckdb-dsn"}}
{"chunk_id": "clients-odbc-windows-004", "document_id": "clients-odbc-windows", "content": "## More Detailed Windows Setup\n\nThere are two ways to configure the ODBC driver, either by altering the registry keys as detailed below,\nor by connecting with [`SQLDriverConnect`](https://learn.microsoft.com/en-us/sql/odbc/reference/syntax/sqldriverconnect-function?view=sql-server-ver16).\nA combination of the two is also possible.\n\nFurthermore, the ODBC driver supports all the [configuration options]({% link docs/stable/configuration/overview.md %})\nincluded in DuckDB.\n\n> If a configuration is set in both the connection string passed to `SQLDriverConnect` and in the `odbc.ini` file,\n> the one passed to `SQLDriverConnect` will take precedence.\n\nFor the details of the configuration parameters, see the [ODBC configuration page]({% link docs/stable/clients/odbc/configuration.md %}).", "position": 4, "token_count": 223, "has_code": false, "section_hierarchy": ["More Detailed Windows Setup"], "metadata": {"chunk_id": "clients-odbc-windows-004", "document_id": "clients-odbc-windows", "position": 4, "token_count": 223, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["More Detailed Windows Setup"], "file_path": "clients/odbc/windows.md", "url": "/clients/odbc/windows", "title": "ODBC API on Windows", "category": null, "tags": [], "section_url": "/clients/odbc/windows#more-detailed-windows-setup"}}
{"chunk_id": "clients-odbc-windows-005", "document_id": "clients-odbc-windows", "content": "### Registry Keys\n\nThe ODBC setup on Windows is based on registry keys (see [Registry Entries for ODBC Components](https://docs.microsoft.com/en-us/sql/odbc/reference/install/registry-entries-for-odbc-components?view=sql-server-ver15)).\nThe ODBC entries can be placed at the current user registry key (`HKCU`) or the system registry key (`HKLM`).\n\nWe have tested and used the system entries based on `HKLM->SOFTWARE->ODBC`.\nThe `odbc_install.exe` changes this entry that has two subkeys: `ODBC.INI` and `ODBCINST.INI`.\n\nThe `ODBC.INI` is where users usually insert DSN registry entries for the drivers.\n\nFor example, the DSN registry for DuckDB would look like this:", "position": 5, "token_count": 212, "has_code": false, "section_hierarchy": ["Registry Keys"], "metadata": {"chunk_id": "clients-odbc-windows-005", "document_id": "clients-odbc-windows", "position": 5, "token_count": 212, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Registry Keys"], "file_path": "clients/odbc/windows.md", "url": "/clients/odbc/windows", "title": "ODBC API on Windows", "category": null, "tags": [], "section_url": "/clients/odbc/windows#registry-keys"}}
{"chunk_id": "clients-odbc-windows-006", "document_id": "clients-odbc-windows", "content": "The `ODBC.INI` is where users usually insert DSN registry entries for the drivers.\n\nFor example, the DSN registry for DuckDB would look like this:\n\n![`HKLM->SOFTWARE->ODBC->ODBC.INI->DuckDB`](/images/blog/odbc/odbc_ini-registry-entry.png)\n\nThe `ODBCINST.INI` contains one entry for each ODBC driver and other keys predefined for [Windows ODBC configuration](https://docs.microsoft.com/en-us/sql/odbc/reference/install/registry-entries-for-odbc-components?view=sql-server-ver15).", "position": 6, "token_count": 173, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-odbc-windows-006", "document_id": "clients-odbc-windows", "position": 6, "token_count": 173, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/odbc/windows.md", "url": "/clients/odbc/windows", "title": "ODBC API on Windows", "category": null, "tags": [], "section_url": "/clients/odbc/windows"}}
{"chunk_id": "clients-odbc-windows-007", "document_id": "clients-odbc-windows", "content": "### Updating the ODBC Driver\n\nWhen a new version of the ODBC driver is released, installing the new version will overwrite the existing one.\nHowever, the installer doesn't always update the version number in the registry.\nTo ensure the correct version is used,\ncheck that `HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBCINST.INI\\DuckDB Driver` has the most recent version,\nand `HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBC.INI\\DuckDB\\Driver` has the correct path to the new driver.", "position": 7, "token_count": 131, "has_code": false, "section_hierarchy": ["Updating the ODBC Driver"], "metadata": {"chunk_id": "clients-odbc-windows-007", "document_id": "clients-odbc-windows", "position": 7, "token_count": 131, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Updating the ODBC Driver"], "file_path": "clients/odbc/windows.md", "url": "/clients/odbc/windows", "title": "ODBC API on Windows", "category": null, "tags": [], "section_url": "/clients/odbc/windows#updating-the-odbc-driver"}}

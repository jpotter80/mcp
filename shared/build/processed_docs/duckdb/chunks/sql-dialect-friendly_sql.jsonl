{"chunk_id": "sql-dialect-friendly_sql-000", "document_id": "sql-dialect-friendly_sql", "content": "DuckDB offers several advanced SQL features and syntactic sugar to make SQL queries more concise. We refer to these colloquially as “friendly SQL”.\n\n> Several of these features are also supported in other systems while some are (currently) exclusive to DuckDB.", "position": 0, "token_count": 56, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-000", "document_id": "sql-dialect-friendly_sql", "position": 0, "token_count": 56, "has_code": false, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-001", "document_id": "sql-dialect-friendly_sql", "content": "## Clauses", "position": 1, "token_count": 5, "has_code": false, "section_hierarchy": ["Clauses"], "metadata": {"chunk_id": "sql-dialect-friendly_sql-001", "document_id": "sql-dialect-friendly_sql", "position": 1, "token_count": 5, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Clauses"], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql#clauses"}}
{"chunk_id": "sql-dialect-friendly_sql-002", "document_id": "sql-dialect-friendly_sql", "content": "* Creating tables and inserting data:\n * [`CREATE OR REPLACE TABLE`]({% link docs/stable/sql/statements/create_table.md %}#create-or-replace): avoid `DROP TABLE IF EXISTS` statements in scripts.\n * [`CREATE TABLE ... AS SELECT` (CTAS)]({% link docs/stable/sql/statements/create_table.md %}#create-table--as-select-ctas): create a new table from the output of a table without manually defining a schema.\n * [`INSERT INTO ... BY NAME`]({% link docs/stable/sql/statements/insert.md %}#insert-into--by-name): this variant of the `INSERT` statement allows using column names instead of positions.", "position": 2, "token_count": 182, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-002", "document_id": "sql-dialect-friendly_sql", "position": 2, "token_count": 182, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-003", "document_id": "sql-dialect-friendly_sql", "content": "* [`INSERT OR IGNORE INTO ...`]({% link docs/stable/sql/statements/insert.md %}#insert-or-ignore-into): insert the rows that do not result in a conflict due to `UNIQUE` or `PRIMARY KEY` constraints.\n * [`INSERT OR REPLACE INTO ...`]({% link docs/stable/sql/statements/insert.md %}#insert-or-replace-into): insert the rows that do not result in a conflict due to `UNIQUE` or `PRIMARY KEY` constraints. For those that result in a conflict, replace the columns of the existing row to the new values of the to-be-inserted row.\n* Describing tables and computing statistics:\n * [`DESCRIBE`]({% link docs/stable/guides/meta/describe.md %}): provides a succinct summary of the schema of a table or query.", "position": 3, "token_count": 204, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-003", "document_id": "sql-dialect-friendly_sql", "position": 3, "token_count": 204, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-004", "document_id": "sql-dialect-friendly_sql", "content": "* [`DESCRIBE`]({% link docs/stable/guides/meta/describe.md %}): provides a succinct summary of the schema of a table or query.\n * [`SUMMARIZE`]({% link docs/stable/guides/meta/summarize.md %}): returns summary statistics for a table or query.\n* Making SQL clauses more compact and readable:\n * [`FROM`-first syntax with an optional `SELECT` clause]({% link docs/stable/sql/query_syntax/from.md %}#from-first-syntax): DuckDB allows queries in the form of `FROM tbl` which selects all columns (performing a `SELECT *` statement).\n * [`GROUP BY ALL`]({% link docs/stable/sql/query_syntax/groupby.md %}#group-by-all): omit the group-by columns by inferring them from the list of attributes in the `SELECT` clause.", "position": 4, "token_count": 227, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-004", "document_id": "sql-dialect-friendly_sql", "position": 4, "token_count": 227, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-005", "document_id": "sql-dialect-friendly_sql", "content": "* [`ORDER BY ALL`]({% link docs/stable/sql/query_syntax/orderby.md %}#order-by-all): shorthand to order on all columns (e.g., to ensure deterministic results).\n * [`SELECT * EXCLUDE`]({% link docs/stable/sql/expressions/star.md %}#exclude-clause): the `EXCLUDE` option allows excluding specific columns from the `*` expression.\n * [`SELECT * REPLACE`]({% link docs/stable/sql/expressions/star.md %}#replace-clause): the `REPLACE` option allows replacing specific columns with different expressions in a `*` expression.\n * [`UNION BY NAME`]({% link docs/stable/sql/query_syntax/setops.md %}#union-all-by-name): perform the `UNION` operation along the names of columns (instead of relying on positions).", "position": 5, "token_count": 217, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-005", "document_id": "sql-dialect-friendly_sql", "position": 5, "token_count": 217, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-006", "document_id": "sql-dialect-friendly_sql", "content": "* [Prefix aliases in the `SELECT` and `FROM` clauses]({% link docs/stable/sql/query_syntax/select.md %}): write `x: 42` instead of `42 AS x` for improved readability.\n * [Specifying a percentage of the table size for the `LIMIT` clause]({% link docs/stable/sql/query_syntax/limit.md %}): write `LIMIT 10%` to return 10% of the query results.\n* Transforming tables:\n * [`PIVOT`]({% link docs/stable/sql/statements/pivot.md %}) to turn long tables to wide tables.\n * [`UNPIVOT`]({% link docs/stable/sql/statements/unpivot.md %}) to turn wide tables to long tables.\n* Defining SQL-level variables:\n * [`SET VARIABLE`]({% link docs/stable/sql/statements/set.md %}#set-variable)", "position": 6, "token_count": 225, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-006", "document_id": "sql-dialect-friendly_sql", "position": 6, "token_count": 225, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-007", "document_id": "sql-dialect-friendly_sql", "content": "* Defining SQL-level variables:\n * [`SET VARIABLE`]({% link docs/stable/sql/statements/set.md %}#set-variable)\n * [`RESET VARIABLE`]({% link docs/stable/sql/statements/set.md %}#reset-variable)", "position": 7, "token_count": 69, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-007", "document_id": "sql-dialect-friendly_sql", "position": 7, "token_count": 69, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-008", "document_id": "sql-dialect-friendly_sql", "content": "## Query Features", "position": 8, "token_count": 6, "has_code": false, "section_hierarchy": ["Query Features"], "metadata": {"chunk_id": "sql-dialect-friendly_sql-008", "document_id": "sql-dialect-friendly_sql", "position": 8, "token_count": 6, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Query Features"], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql#query-features"}}
{"chunk_id": "sql-dialect-friendly_sql-009", "document_id": "sql-dialect-friendly_sql", "content": "* [Column aliases in `WHERE`, `GROUP BY`, and `HAVING`]({% post_url 2022-05-04-friendlier-sql %}#column-aliases-in-where--group-by--having). (Note that column aliases cannot be used in the `ON` clause of [`JOIN` clauses]({% link docs/stable/sql/query_syntax/from.md %}#joins).)\n* [`COLUMNS()` expression]({% link docs/stable/sql/expressions/star.md %}#columns-expression) can be used to execute the same expression on multiple columns:\n * [with regular expressions]({% post_url 2023-08-23-even-friendlier-sql %}#columns-with-regular-expressions)\n * [with `EXCLUDE` and `REPLACE`]({% post_url 2023-08-23-even-friendlier-sql %}#columns-with-exclude-and-replace)", "position": 9, "token_count": 233, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-009", "document_id": "sql-dialect-friendly_sql", "position": 9, "token_count": 233, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-010", "document_id": "sql-dialect-friendly_sql", "content": "* [with `EXCLUDE` and `REPLACE`]({% post_url 2023-08-23-even-friendlier-sql %}#columns-with-exclude-and-replace)\n * [with lambda functions]({% post_url 2023-08-23-even-friendlier-sql %}#columns-with-lambda-functions)\n* Reusable column aliases (also known as “lateral column aliases”), e.g.: `SELECT i + 1 AS j, j + 2 AS k FROM range(0, 3) t(i)`\n* Advanced aggregation features for analytical (OLAP) queries:\n * [`FILTER` clause]({% link docs/stable/sql/query_syntax/filter.md %})\n * [`GROUPING SETS`, `GROUP BY CUBE`, `GROUP BY ROLLUP` clauses]({% link docs/stable/sql/query_syntax/grouping_sets.md %})", "position": 10, "token_count": 217, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-010", "document_id": "sql-dialect-friendly_sql", "position": 10, "token_count": 217, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-011", "document_id": "sql-dialect-friendly_sql", "content": "* [`GROUPING SETS`, `GROUP BY CUBE`, `GROUP BY ROLLUP` clauses]({% link docs/stable/sql/query_syntax/grouping_sets.md %})\n* [`count()` shorthand]({% link docs/stable/sql/functions/aggregates.md %}) for `count(*)`\n* [`IN` operator for lists and maps]({% link docs/stable/sql/expressions/in.md %})\n* [Specifying column names for common table expressions (`WITH`)]({% link docs/stable/sql/query_syntax/with.md %}#basic-cte-examples)\n* [Specifying column names in the `JOIN` clause]({% link docs/stable/sql/query_syntax/from.md %}#shorthands-in-the-join-clause)", "position": 11, "token_count": 203, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-011", "document_id": "sql-dialect-friendly_sql", "position": 11, "token_count": 203, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-012", "document_id": "sql-dialect-friendly_sql", "content": "* [Specifying column names in the `JOIN` clause]({% link docs/stable/sql/query_syntax/from.md %}#shorthands-in-the-join-clause)\n* [Using `VALUES` in the `JOIN` clause]({% link docs/stable/sql/query_syntax/from.md %}#shorthands-in-the-join-clause)\n* [Using `VALUES` in the anchor part of common table expressions]({% link docs/stable/sql/query_syntax/with.md %}#using-values)", "position": 12, "token_count": 134, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-012", "document_id": "sql-dialect-friendly_sql", "position": 12, "token_count": 134, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-013", "document_id": "sql-dialect-friendly_sql", "content": "## Literals and Identifiers\n\n* [Case-insensitivity while maintaining case of entities in the catalog]({% link docs/stable/sql/dialect/keywords_and_identifiers.md %}#case-sensitivity-of-identifiers)\n* [Deduplicating identifiers]({% link docs/stable/sql/dialect/keywords_and_identifiers.md %}#deduplicating-identifiers)\n* [Underscores as digit separators in numeric literals]({% link docs/stable/sql/dialect/keywords_and_identifiers.md %}#numeric-literals)\n\n## Data Types\n\n* [`MAP` data type]({% link docs/stable/sql/data_types/map.md %})\n* [`UNION` data type]({% link docs/stable/sql/data_types/union.md %})", "position": 13, "token_count": 220, "has_code": false, "section_hierarchy": ["Data Types"], "metadata": {"chunk_id": "sql-dialect-friendly_sql-013", "document_id": "sql-dialect-friendly_sql", "position": 13, "token_count": 220, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Data Types"], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql#data-types"}}
{"chunk_id": "sql-dialect-friendly_sql-014", "document_id": "sql-dialect-friendly_sql", "content": "## Data Import", "position": 14, "token_count": 6, "has_code": false, "section_hierarchy": ["Data Import"], "metadata": {"chunk_id": "sql-dialect-friendly_sql-014", "document_id": "sql-dialect-friendly_sql", "position": 14, "token_count": 6, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Data Import"], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql#data-import"}}
{"chunk_id": "sql-dialect-friendly_sql-015", "document_id": "sql-dialect-friendly_sql", "content": "* [Auto-detecting the headers and schema of CSV files]({% link docs/stable/data/csv/auto_detection.md %})\n* Directly querying [CSV files]({% link docs/stable/data/csv/overview.md %}) and [Parquet files]({% link docs/stable/data/parquet/overview.md %})\n* [Replacement scans]({% link docs/stable/guides/glossary.md %}):\n * You can load from files using the syntax `FROM 'my.csv'`, `FROM 'my.csv.gz'`, `FROM 'my.parquet'`, etc.\n * In Python, you can [access Pandas data frames using `FROM df`]({% link docs/stable/guides/python/export_pandas.md %}).", "position": 15, "token_count": 205, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-015", "document_id": "sql-dialect-friendly_sql", "position": 15, "token_count": 205, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-016", "document_id": "sql-dialect-friendly_sql", "content": "* In Python, you can [access Pandas data frames using `FROM df`]({% link docs/stable/guides/python/export_pandas.md %}).\n* [Filename expansion (globbing)]({% link docs/stable/sql/functions/pattern_matching.md %}#globbing), e.g.: `FROM 'my-data/part-*.parquet'`", "position": 16, "token_count": 101, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-016", "document_id": "sql-dialect-friendly_sql", "position": 16, "token_count": 101, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-017", "document_id": "sql-dialect-friendly_sql", "content": "## Functions and Expressions", "position": 17, "token_count": 7, "has_code": false, "section_hierarchy": ["Functions and Expressions"], "metadata": {"chunk_id": "sql-dialect-friendly_sql-017", "document_id": "sql-dialect-friendly_sql", "position": 17, "token_count": 7, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Functions and Expressions"], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql#functions-and-expressions"}}
{"chunk_id": "sql-dialect-friendly_sql-018", "document_id": "sql-dialect-friendly_sql", "content": "* [Dot operator for function chaining]({% link docs/stable/sql/functions/overview.md %}#function-chaining-via-the-dot-operator): `SELECT ('hello').upper()`\n* String formatters:\n the [`format()` function with the `fmt` syntax]({% link docs/stable/sql/functions/text.md %}#fmt-syntax) and\n the [`printf() function`]({% link docs/stable/sql/functions/text.md %}#printf-syntax)\n* [List comprehensions]({% post_url 2023-08-23-even-friendlier-sql %}#list-comprehensions)\n* [List slicing]({% post_url 2022-05-04-friendlier-sql %}#string-slicing) and indexing from the back (`[-1]`)", "position": 18, "token_count": 214, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-018", "document_id": "sql-dialect-friendly_sql", "position": 18, "token_count": 214, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-019", "document_id": "sql-dialect-friendly_sql", "content": "* [List slicing]({% post_url 2022-05-04-friendlier-sql %}#string-slicing) and indexing from the back (`[-1]`)\n* [String slicing]({% post_url 2022-05-04-friendlier-sql %}#string-slicing)\n* [`STRUCT.*` notation]({% post_url 2022-05-04-friendlier-sql %}#struct-dot-notation)\n* [Creating `LIST` using square brackets]({% link docs/stable/sql/data_types/list.md %}#creating-lists)\n* [Simple `LIST` and `STRUCT` creation]({% post_url 2022-05-04-friendlier-sql %}#simple-list-and-struct-creation)", "position": 19, "token_count": 198, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-019", "document_id": "sql-dialect-friendly_sql", "position": 19, "token_count": 198, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-020", "document_id": "sql-dialect-friendly_sql", "content": "* [Simple `LIST` and `STRUCT` creation]({% post_url 2022-05-04-friendlier-sql %}#simple-list-and-struct-creation)\n* [Updating the schema of `STRUCT`s]({% link docs/stable/sql/data_types/struct.md %}#updating-the-schema)", "position": 20, "token_count": 95, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-020", "document_id": "sql-dialect-friendly_sql", "position": 20, "token_count": 95, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-021", "document_id": "sql-dialect-friendly_sql", "content": "## Join Types\n\n* [`ASOF` joins]({% link docs/stable/sql/query_syntax/from.md %}#as-of-joins)\n* [`LATERAL` joins]({% link docs/stable/sql/query_syntax/from.md %}#lateral-joins)\n* [`POSITIONAL` joins]({% link docs/stable/sql/query_syntax/from.md %}#positional-joins)\n\n## Trailing Commas\n\nDuckDB allows [trailing commas](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Trailing_commas),\nboth when listing entities (e.g., column and table names) and when constructing [`LIST` items]({% link docs/stable/sql/data_types/list.md %}#creating-lists).\nFor example, the following query works:\n\n```sql\nSELECT\n 42 AS x,\n ['a', 'b', 'c',] AS y,\n 'hello world' AS z,\n;\n```", "position": 21, "token_count": 248, "has_code": true, "section_hierarchy": ["Trailing Commas"], "metadata": {"chunk_id": "sql-dialect-friendly_sql-021", "document_id": "sql-dialect-friendly_sql", "position": 21, "token_count": 248, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Trailing Commas"], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql#trailing-commas"}}
{"chunk_id": "sql-dialect-friendly_sql-022", "document_id": "sql-dialect-friendly_sql", "content": "## \"Top-N in Group\" Queries\n\nComputing the \"top-N rows in a group\" ordered by some criteria is a common task in SQL that unfortunately often requires a complex query involving window functions and/or subqueries.", "position": 22, "token_count": 51, "has_code": false, "section_hierarchy": ["\"Top-N in Group\" Queries"], "metadata": {"chunk_id": "sql-dialect-friendly_sql-022", "document_id": "sql-dialect-friendly_sql", "position": 22, "token_count": 51, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["\"Top-N in Group\" Queries"], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql#top-n-in-group-queries"}}
{"chunk_id": "sql-dialect-friendly_sql-023", "document_id": "sql-dialect-friendly_sql", "content": "To aid in this, DuckDB provides the aggregate functions [`max(arg, n)`]({% link docs/stable/sql/functions/aggregates.md %}#maxarg-n), [`min(arg, n)`]({% link docs/stable/sql/functions/aggregates.md %}#minarg-n), [`arg_max(arg, val, n)`]({% link docs/stable/sql/functions/aggregates.md %}#arg_maxarg-val-n), [`arg_min(arg, val,", "position": 23, "token_count": 148, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-023", "document_id": "sql-dialect-friendly_sql", "position": 23, "token_count": 148, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-024", "document_id": "sql-dialect-friendly_sql", "content": "%}#arg_maxarg-val-n), [`arg_min(arg, val, n)`]({% link docs/stable/sql/functions/aggregates.md %}#arg_minarg-val-n), [`max_by(arg, val, n)`]({% link docs/stable/sql/functions/aggregates.md %}#max_byarg-val-n) and [`min_by(arg, val, n)`]({% link docs/stable/sql/functions/aggregates.md %}#min_byarg-val-n) to efficiently return the", "position": 24, "token_count": 159, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-024", "document_id": "sql-dialect-friendly_sql", "position": 24, "token_count": 159, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-025", "document_id": "sql-dialect-friendly_sql", "content": "%}#min_byarg-val-n) to efficiently return the \"top\" `n` rows in a group based on a specific column in either ascending or descending order.", "position": 25, "token_count": 41, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-025", "document_id": "sql-dialect-friendly_sql", "position": 25, "token_count": 41, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-026", "document_id": "sql-dialect-friendly_sql", "content": "For example, let's use the following table:\n\n```sql\nSELECT * FROM t1;", "position": 26, "token_count": 23, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-026", "document_id": "sql-dialect-friendly_sql", "position": 26, "token_count": 23, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-027", "document_id": "sql-dialect-friendly_sql", "content": "```\n\n```text\n┌─────────┬───────┐\n│ grp │ val │\n│ varchar │ int32 │\n├─────────┼───────┤\n│ a │ 2 │\n│ a │ 1 │\n│ b │ 5 │\n│ b │ 4 │\n│ a │ 3 │\n│ b │ 6 │\n└─────────┴───────┘\n```\n\nWe want to get a list of the top-3 `val` values in each group `grp`. The conventional way to do this is to use a window function in a subquery:\n\n```sql\nSELECT array_agg(rs.val), rs.grp\nFROM\n (SELECT val, grp, row_number() OVER (PARTITION BY grp ORDER BY val DESC) AS rid\n FROM t1 ORDER BY val DESC) AS rs\nWHERE rid < 4\nGROUP BY rs.grp;\n```\n\n```text\n┌───────────────────┬─────────┐\n│ array_agg(rs.val) │ grp │\n│ int32[] │ varchar │\n├───────────────────┼─────────┤\n│ [3, 2, 1] │ a │\n│ [6, 5, 4] │ b │\n└───────────────────┴─────────┘", "position": 27, "token_count": 224, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-027", "document_id": "sql-dialect-friendly_sql", "position": 27, "token_count": 224, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-028", "document_id": "sql-dialect-friendly_sql", "content": "```\n\nBut in DuckDB, we can do this much more concisely (and efficiently!):\n\n```sql\nSELECT max(val, 3) FROM t1 GROUP BY grp;\n```\n\n```text\n┌─────────────┐\n│ max(val, 3) │\n│ int32[] │\n├─────────────┤\n│ [3, 2, 1] │\n│ [6, 5, 4] │\n└─────────────┘\n```", "position": 28, "token_count": 89, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "sql-dialect-friendly_sql-028", "document_id": "sql-dialect-friendly_sql", "position": 28, "token_count": 89, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql"}}
{"chunk_id": "sql-dialect-friendly_sql-029", "document_id": "sql-dialect-friendly_sql", "content": "## Related Blog Posts\n\n* [“Friendlier SQL with DuckDB”]({% post_url 2022-05-04-friendlier-sql %}) blog post\n* [“Even Friendlier SQL with DuckDB”]({% post_url 2023-08-23-even-friendlier-sql %}) blog post\n* [“SQL Gymnastics: Bending SQL into Flexible New Shapes”]({% post_url 2024-03-01-sql-gymnastics %}) blog post", "position": 29, "token_count": 114, "has_code": false, "section_hierarchy": ["Related Blog Posts"], "metadata": {"chunk_id": "sql-dialect-friendly_sql-029", "document_id": "sql-dialect-friendly_sql", "position": 29, "token_count": 114, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Related Blog Posts"], "file_path": "sql/dialect/friendly_sql.md", "url": "/sql/dialect/friendly_sql", "title": "Friendly SQL", "category": null, "tags": [], "section_url": "/sql/dialect/friendly_sql#related-blog-posts"}}

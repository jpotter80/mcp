{"chunk_id": "core_extensions-avro-000", "document_id": "core_extensions-avro", "content": "The `avro` extension enables DuckDB to read [Apache Avro](https://avro.apache.org) files.\n\n> The `avro` extensions was [released as a community extension in late 2024]({% post_url 2024-12-09-duckdb-avro-extension %}) and became a core extension in early 2025.\n\n## The `read_avro` Function\n\nThe extension adds a single DuckDB function, `read_avro`. This function can be used like so:\n\n```sql\nFROM read_avro('⟨some_file⟩.avro');\n```\n\nThis function will expose the contents of the Avro file as a DuckDB table. You can then use any arbitrary SQL constructs to further transform this table.", "position": 0, "token_count": 176, "has_code": true, "section_hierarchy": ["The `read_avro` Function"], "metadata": {"chunk_id": "core_extensions-avro-000", "document_id": "core_extensions-avro", "position": 0, "token_count": 176, "has_code": true, "overlap_with_previous": false, "section_hierarchy": ["The `read_avro` Function"], "file_path": "core_extensions/avro.md", "url": "/core_extensions/avro", "title": "Avro Extension", "category": null, "tags": [], "section_url": "/core_extensions/avro#the-readavro-function"}}
{"chunk_id": "core_extensions-avro-001", "document_id": "core_extensions-avro", "content": "## File IO\n\nThe `read_avro` function is integrated into DuckDB's file system abstraction, meaning you can read Avro files directly from, e.g., HTTP or S3 sources. For example:\n\n```sql\nFROM read_avro('http://blobs.duckdb.org/data/userdata1.avro');\nFROM read_avro('s3://⟨your-bucket⟩/⟨some_file⟩.avro');\n```\n\nshould \"just\" work.\n\nYou can also *glob* multiple files in a single read call or pass a list of files to the functions:\n\n```sql\nFROM read_avro('some_file_*.avro');\nFROM read_avro(['some_file_1.avro', 'some_file_2.avro']);", "position": 1, "token_count": 201, "has_code": true, "section_hierarchy": ["File IO"], "metadata": {"chunk_id": "core_extensions-avro-001", "document_id": "core_extensions-avro", "position": 1, "token_count": 201, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["File IO"], "file_path": "core_extensions/avro.md", "url": "/core_extensions/avro", "title": "Avro Extension", "category": null, "tags": [], "section_url": "/core_extensions/avro#file-io"}}
{"chunk_id": "core_extensions-avro-002", "document_id": "core_extensions-avro", "content": "```\n\nIf the filenames somehow contain valuable information (as is unfortunately all-too-common), you can pass the `filename` argument to `read_avro`:\n\n```sql\nFROM read_avro('some_file_*.avro', filename=true);\n```\n\nThis will result in an additional column in the result set that contains the actual filename of the Avro file.", "position": 2, "token_count": 95, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-avro-002", "document_id": "core_extensions-avro", "position": 2, "token_count": 95, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/avro.md", "url": "/core_extensions/avro", "title": "Avro Extension", "category": null, "tags": [], "section_url": "/core_extensions/avro"}}
{"chunk_id": "core_extensions-avro-003", "document_id": "core_extensions-avro", "content": "## Schema Conversion\n\nThis extension automatically translates the Avro Schema to the DuckDB schema. *All* Avro types can be translated, except for *recursive type definitions*, which DuckDB does not support.\n\nThe type mapping is very straightforward except for Avro's \"unique\" way of handling `NULL`. Unlike other systems, Avro does not treat `NULL` as a possible value in a range of e.g. `INTEGER` but instead represents `NULL` as a union of the actual type with a special `NULL` type. This is different to DuckDB, where any value can be `NULL`. Of course DuckDB also supports `UNION` types, but this would be quite cumbersome to work with.", "position": 3, "token_count": 159, "has_code": false, "section_hierarchy": ["Schema Conversion"], "metadata": {"chunk_id": "core_extensions-avro-003", "document_id": "core_extensions-avro", "position": 3, "token_count": 159, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Schema Conversion"], "file_path": "core_extensions/avro.md", "url": "/core_extensions/avro", "title": "Avro Extension", "category": null, "tags": [], "section_url": "/core_extensions/avro#schema-conversion"}}
{"chunk_id": "core_extensions-avro-004", "document_id": "core_extensions-avro", "content": "This extension *simplifies* the Avro schema where possible: An Avro union of any type and the special null type is simplified to just the non-null type. For example, an Avro record of the union type `[\"int\",\"null\"]` becomes a DuckDB `INTEGER`, which just happens to be `NULL` sometimes. Similarly, an Avro union that contains only a single type is converted to the type it contains. For example, an Avro record of the union type `[\"int\"]` also becomes a DuckDB `INTEGER`.\n\nThe extension also \"flattens\" the Avro schema. Avro defines tables as root-level \"record\" fields, which are the same as DuckDB `STRUCT` fields. For more convenient handling, this extension turns the entries of a single top-level record into top-level columns.", "position": 4, "token_count": 189, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "core_extensions-avro-004", "document_id": "core_extensions-avro", "position": 4, "token_count": 189, "has_code": false, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "core_extensions/avro.md", "url": "/core_extensions/avro", "title": "Avro Extension", "category": null, "tags": [], "section_url": "/core_extensions/avro"}}
{"chunk_id": "core_extensions-avro-005", "document_id": "core_extensions-avro", "content": "## Implementation\n\nInternally, this extension uses the \"official\" [Apache Avro C API](https://avro.apache.org/docs/++version++/api/c/), albeit with some minor patching to allow reading of Avro files from memory.", "position": 5, "token_count": 64, "has_code": false, "section_hierarchy": ["Implementation"], "metadata": {"chunk_id": "core_extensions-avro-005", "document_id": "core_extensions-avro", "position": 5, "token_count": 64, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Implementation"], "file_path": "core_extensions/avro.md", "url": "/core_extensions/avro", "title": "Avro Extension", "category": null, "tags": [], "section_url": "/core_extensions/avro#implementation"}}
{"chunk_id": "core_extensions-avro-006", "document_id": "core_extensions-avro", "content": "## Limitations and Future Plans\n\n* This extension currently does not make use of **parallelism** when reading either a single (large) Avro file or when reading a list of files. Adding support for parallelism in the latter case is on the roadmap.\n* There is currently no support for neither projection nor filter **pushdown**, but this is also planned at a later stage.\n* There is currently no support for the Wasm or the Windows-MinGW builds of DuckDB due to issues with the Avro library dependency (sigh again). We plan to fix this eventually.\n* As mentioned above, DuckDB cannot express recursive type definitions that Avro has, this is unlikely to ever change.\n* There is no support to allow users to provide a separate Avro schema file. This is unlikely to change, all Avro files we have seen so far had their schema embedded.\n* There is currently no support for the `union_by_name` flag that other readers in DuckDB support. This is planned for the future.", "position": 6, "token_count": 223, "has_code": false, "section_hierarchy": ["Limitations and Future Plans"], "metadata": {"chunk_id": "core_extensions-avro-006", "document_id": "core_extensions-avro", "position": 6, "token_count": 223, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Limitations and Future Plans"], "file_path": "core_extensions/avro.md", "url": "/core_extensions/avro", "title": "Avro Extension", "category": null, "tags": [], "section_url": "/core_extensions/avro#limitations-and-future-plans"}}

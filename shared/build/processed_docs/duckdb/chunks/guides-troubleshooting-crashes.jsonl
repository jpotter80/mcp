{"chunk_id": "guides-troubleshooting-crashes-000", "document_id": "guides-troubleshooting-crashes", "content": "DuckDB is [thoroughly tested]({% link why_duckdb.md %}#thoroughly-tested) via an extensive test suite.\nHowever, bugs can still occur and these can sometimes lead to crashes.\nThis page contains practical information on how to troubleshoot DuckDB crashes.", "position": 0, "token_count": 60, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "guides-troubleshooting-crashes-000", "document_id": "guides-troubleshooting-crashes", "position": 0, "token_count": 60, "has_code": false, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "guides/troubleshooting/crashes.md", "url": "/guides/troubleshooting/crashes", "title": "Crashes", "category": null, "tags": [], "section_url": "/guides/troubleshooting/crashes"}}
{"chunk_id": "guides-troubleshooting-crashes-001", "document_id": "guides-troubleshooting-crashes", "content": "## Types of Crashes\n\nThere are a few major types of crashes:\n\n* **Termination signals:** The process stops with a `SIGSEGV` (segmentation fault), `SIGABRT`, etc.: these should never occur. Please [submit an issue](#submitting-an-issue).\n\n* **Internal errors:** an operation may result in an [`Internal Error`]({% link docs/stable/dev/internal_errors.md %}), e.g.:\n\n ```console\n INTERNAL Error:\n Attempted to access index 3 within vector of size 3\n ```\n\n After encountering an internal error, DuckDB enters a restricted mode where any further operations will result in the following error message:\n\n ```console\n FATAL Error:\n Failed: database has been invalidated because of a previous fatal error.\n The database must be restarted prior to being used again.", "position": 1, "token_count": 194, "has_code": true, "section_hierarchy": ["Types of Crashes"], "metadata": {"chunk_id": "guides-troubleshooting-crashes-001", "document_id": "guides-troubleshooting-crashes", "position": 1, "token_count": 194, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Types of Crashes"], "file_path": "guides/troubleshooting/crashes.md", "url": "/guides/troubleshooting/crashes", "title": "Crashes", "category": null, "tags": [], "section_url": "/guides/troubleshooting/crashes#types-of-crashes"}}
{"chunk_id": "guides-troubleshooting-crashes-002", "document_id": "guides-troubleshooting-crashes", "content": "```\n\n* **Out of memory errors:** A DuckDB crash can also be a symptom of the operating system killing the process.\n For example, many Linux distributions run an [OOM reaper or OOM killer process](https://learn.redhat.com/t5/Platform-Linux/Out-of-Memory-Killer/td-p/48828), which kills processes to free up their memory and thus prevents the operating system from running out of memory.\n If your DuckDB session is killed by the OOM reaper, consult the [“OOM errors” page]({% link docs/stable/guides/troubleshooting/oom_errors.md %})", "position": 2, "token_count": 155, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "guides-troubleshooting-crashes-002", "document_id": "guides-troubleshooting-crashes", "position": 2, "token_count": 155, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "guides/troubleshooting/crashes.md", "url": "/guides/troubleshooting/crashes", "title": "Crashes", "category": null, "tags": [], "section_url": "/guides/troubleshooting/crashes"}}
{"chunk_id": "guides-troubleshooting-crashes-003", "document_id": "guides-troubleshooting-crashes", "content": "## Recovering Data\n\nIf your DuckDB session was writing to a persistent database file prior to crashing,\nthere might be a WAL ([write-ahead log](https://en.wikipedia.org/wiki/Write-ahead_logging)) file next to your database named `⟨database_filename⟩.wal`{:.language-sql .highlight}.\nTo recover data from the WAL file, simply start a new DuckDB session on the persistent database.\nDuckDB will then replay the write-ahead log and perform a [checkpoint operation]({% link docs/stable/sql/statements/checkpoint.md %}), restoring the database to the state before the crash.", "position": 3, "token_count": 148, "has_code": false, "section_hierarchy": ["Recovering Data"], "metadata": {"chunk_id": "guides-troubleshooting-crashes-003", "document_id": "guides-troubleshooting-crashes", "position": 3, "token_count": 148, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Recovering Data"], "file_path": "guides/troubleshooting/crashes.md", "url": "/guides/troubleshooting/crashes", "title": "Crashes", "category": null, "tags": [], "section_url": "/guides/troubleshooting/crashes#recovering-data"}}
{"chunk_id": "guides-troubleshooting-crashes-004", "document_id": "guides-troubleshooting-crashes", "content": "## Troubleshooting the Crash\n\n### Using the Latest Stable and Preview Builds\n\nDuckDB is constantly improving, so there is a chance that the bug you have encountered has already been fixed in the codebase.\nFirst, try updating to the [**latest stable build**]({% link install/index.html %}?version=stable).\nIf this doesn't resolve the problem, try using the [**preview build**]({% link install/index.html %}?version=main) (also known as the “nightly build”).\n\nIf you would like use DuckDB with an [open pull request](https://github.com/duckdb/duckdb/pulls) applied to the codebase,\nyou can try [building it from source]({% link docs/stable/dev/building/overview.md %}).", "position": 4, "token_count": 193, "has_code": false, "section_hierarchy": ["Using the Latest Stable and Preview Builds"], "metadata": {"chunk_id": "guides-troubleshooting-crashes-004", "document_id": "guides-troubleshooting-crashes", "position": 4, "token_count": 193, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Using the Latest Stable and Preview Builds"], "file_path": "guides/troubleshooting/crashes.md", "url": "/guides/troubleshooting/crashes", "title": "Crashes", "category": null, "tags": [], "section_url": "/guides/troubleshooting/crashes#using-the-latest-stable-and-preview-builds"}}
{"chunk_id": "guides-troubleshooting-crashes-005", "document_id": "guides-troubleshooting-crashes", "content": "### Search for Existing Issues\n\nThere is a chance that someone else already reported the bug that causes the crash.\nPlease search in the [GitHub issue tracker](https://github.com/duckdb/duckdb/issues) for the error message to see potentially related issues.\nDuckDB has a large community and there may be some suggestions for a workaround.\n\n### Disabling the Query Optimizer\n\nSome crashes are caused by DuckDB's query optimizer component.\nTo identify whether the optimizer is causing the crash, try to turn it off and re-run the query:\n\n```sql\nPRAGMA disable_optimizer;\n```\n\nIf the query finishes successfully, then the crash was caused by one or more optimizer rules.\nTo pinpoint the specific rules that caused the crash, you can try to [selectively disable optimizer rules]({% link docs/stable/configuration/pragmas.md %}#selectively-disabling-optimizers). This way, your query can still benefit from the rest of the optimizer rules.", "position": 5, "token_count": 243, "has_code": true, "section_hierarchy": ["Disabling the Query Optimizer"], "metadata": {"chunk_id": "guides-troubleshooting-crashes-005", "document_id": "guides-troubleshooting-crashes", "position": 5, "token_count": 243, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Disabling the Query Optimizer"], "file_path": "guides/troubleshooting/crashes.md", "url": "/guides/troubleshooting/crashes", "title": "Crashes", "category": null, "tags": [], "section_url": "/guides/troubleshooting/crashes#disabling-the-query-optimizer"}}
{"chunk_id": "guides-troubleshooting-crashes-006", "document_id": "guides-troubleshooting-crashes", "content": "### Try to Isolate the Issue\n\nSome issues are caused by the interplay of different components and extensions, or are specific to certain platforms or client languages.\nYou can often isolate the issue to a smaller problem.\n\n#### Reproducing in Plain SQL\n\nIssues can also occur due to differences in client libraries.\nTo understand whether this is the case, try reproducing the issue using plain SQL queries with the [DuckDB CLI client]({% link docs/stable/clients/cli/overview.md %}).\nIf you cannot reproduce the issue in the command line client, it is likely related to the client library.\n\n#### Different Hardware Setup\n\nAccording to our experience, several crashes occur due to faulty hardware (overheating hard drives, overclocked CPUs, etc.).\nTherefore, it's worth trying another computer to run the same workload.", "position": 6, "token_count": 191, "has_code": false, "section_hierarchy": ["Different Hardware Setup"], "metadata": {"chunk_id": "guides-troubleshooting-crashes-006", "document_id": "guides-troubleshooting-crashes", "position": 6, "token_count": 191, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Different Hardware Setup"], "file_path": "guides/troubleshooting/crashes.md", "url": "/guides/troubleshooting/crashes", "title": "Crashes", "category": null, "tags": [], "section_url": "/guides/troubleshooting/crashes#different-hardware-setup"}}
{"chunk_id": "guides-troubleshooting-crashes-007", "document_id": "guides-troubleshooting-crashes", "content": "#### Decomposing the Query\n\nIt's a good idea to try to break down the query into multiple smaller queries with each using a separate DuckDB extension and SQL feature.\n\nFor example, if you have a query that targets a dataset in an AWS S3 bucket and performs two joins on it, try to rewrite it as a series of smaller steps as follows.\nDownload the dataset's files manually and load them into DuckDB.\nThen perform the first join and the second join separately.\nIf the multi-step approach still exhibits the crash at some step, then the query that triggers the crash is a good basis for a minimal reproducible example.If the multi-step approach works and the multi-step process no longer crashes, try to reconstruct the original query and observe which step reintroduces the error.\nIn both cases, you will have a better understanding of what is causing the issue and potentially also a workaround that you can use right away.\nIn any case, please consider [submitting an issue](#submitting-an-issue) with your findings.", "position": 7, "token_count": 231, "has_code": false, "section_hierarchy": ["Decomposing the Query"], "metadata": {"chunk_id": "guides-troubleshooting-crashes-007", "document_id": "guides-troubleshooting-crashes", "position": 7, "token_count": 231, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Decomposing the Query"], "file_path": "guides/troubleshooting/crashes.md", "url": "/guides/troubleshooting/crashes", "title": "Crashes", "category": null, "tags": [], "section_url": "/guides/troubleshooting/crashes#decomposing-the-query"}}
{"chunk_id": "guides-troubleshooting-crashes-008", "document_id": "guides-troubleshooting-crashes", "content": "## Submitting an Issue\n\nIf you found a crash in DuckDB, please consider submitting an issue in our [GitHub issue tracker](https://github.com/duckdb/duckdb/issues) with a [minimal reproducible example](https://en.wikipedia.org/wiki/Minimal_reproducible_example).", "position": 8, "token_count": 83, "has_code": false, "section_hierarchy": ["Submitting an Issue"], "metadata": {"chunk_id": "guides-troubleshooting-crashes-008", "document_id": "guides-troubleshooting-crashes", "position": 8, "token_count": 83, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Submitting an Issue"], "file_path": "guides/troubleshooting/crashes.md", "url": "/guides/troubleshooting/crashes", "title": "Crashes", "category": null, "tags": [], "section_url": "/guides/troubleshooting/crashes#submitting-an-issue"}}

{"chunk_id": "clients-python-dbapi-000", "document_id": "clients-python-dbapi", "content": "The standard DuckDB Python API provides a SQL interface compliant with the [DB-API 2.0 specification described by PEP 249](https://www.python.org/dev/peps/pep-0249/) similar to the [SQLite Python API](https://docs.python.org/3.7/library/sqlite3.html).", "position": 0, "token_count": 84, "has_code": false, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-dbapi-000", "document_id": "clients-python-dbapi", "position": 0, "token_count": 84, "has_code": false, "overlap_with_previous": false, "section_hierarchy": [], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi"}}
{"chunk_id": "clients-python-dbapi-001", "document_id": "clients-python-dbapi", "content": "## Connection\n\nTo use the module, you must first create a `DuckDBPyConnection` object that represents a connection to a database.\nThis is done through the [`duckdb.connect`]({% link docs/stable/clients/python/reference/index.md %}#duckdb.connect) method.\n\nThe 'config' keyword argument can be used to provide a `dict` that contains key->value pairs referencing [settings]({% link docs/stable/configuration/overview.md %}#configuration-reference) understood by DuckDB.", "position": 1, "token_count": 129, "has_code": false, "section_hierarchy": ["Connection"], "metadata": {"chunk_id": "clients-python-dbapi-001", "document_id": "clients-python-dbapi", "position": 1, "token_count": 129, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Connection"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#connection"}}
{"chunk_id": "clients-python-dbapi-002", "document_id": "clients-python-dbapi", "content": "### In-Memory Connection\n\nThe special value `:memory:` can be used to create an **in-memory database**. Note that for an in-memory database no data is persisted to disk (i.e., all data is lost when you exit the Python process).\n\n#### Named In-memory Connections\n\nThe special value `:memory:` can also be postfixed with a name, for example: `:memory:conn3`.\nWhen a name is provided, subsequent `duckdb.connect` calls will create a new connection to the same database, sharing the catalogs (views, tables, macros etc.).\n\nUsing `:memory:` without a name will always create a new and separate database instance.\n\n### Default Connection\n\nBy default we create an (unnamed) **in-memory-database** that lives inside the `duckdb` module.\nEvery method of `DuckDBPyConnection` is also available on the `duckdb` module, this connection is what's used by these methods.\n\nThe special value `:default:` can be used to get this default connection.", "position": 2, "token_count": 242, "has_code": false, "section_hierarchy": ["Default Connection"], "metadata": {"chunk_id": "clients-python-dbapi-002", "document_id": "clients-python-dbapi", "position": 2, "token_count": 242, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["Default Connection"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#default-connection"}}
{"chunk_id": "clients-python-dbapi-003", "document_id": "clients-python-dbapi", "content": "### File-Based Connection\n\nIf the `database` is a file path, a connection to a persistent database is established.\nIf the file does not exist the file will be created (the extension of the file is irrelevant and can be `.db`, `.duckdb` or anything else).\n\n#### `read_only` Connections\n\nIf you would like to connect in read-only mode, you can set the `read_only` flag to `True`. If the file does not exist, it is **not** created when connecting in read-only mode.\nRead-only mode is required if multiple Python processes want to access the same database file at the same time.\n\n```python\nimport duckdb\n\nduckdb.execute(\"CREATE TABLE tbl AS SELECT 42 a\")\ncon = duckdb.connect(\":default:\")\ncon.sql(\"SELECT * FROM tbl\")", "position": 3, "token_count": 195, "has_code": true, "section_hierarchy": ["`read_only` Connections"], "metadata": {"chunk_id": "clients-python-dbapi-003", "document_id": "clients-python-dbapi", "position": 3, "token_count": 195, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["`read_only` Connections"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#readonly-connections"}}
{"chunk_id": "clients-python-dbapi-004", "document_id": "clients-python-dbapi", "content": "# or\nduckdb.default_connection().sql(\"SELECT * FROM tbl\")\n```\n\n```text\n┌───────┐\n│ a │\n│ int32 │\n├───────┤\n│ 42 │\n└───────┘\n```\n\n```python\nimport duckdb\n\n# to start an in-memory database\ncon = duckdb.connect(database = \":memory:\")\n# to use a database file (not shared between processes)\ncon = duckdb.connect(database = \"my-db.duckdb\", read_only = False)\n# to use a database file (shared between processes)\ncon = duckdb.connect(database = \"my-db.duckdb\", read_only = True)", "position": 4, "token_count": 147, "has_code": true, "section_hierarchy": ["to use a database file (shared between processes)"], "metadata": {"chunk_id": "clients-python-dbapi-004", "document_id": "clients-python-dbapi", "position": 4, "token_count": 147, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["to use a database file (shared between processes)"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#to-use-a-database-file-shared-between-processes"}}
{"chunk_id": "clients-python-dbapi-005", "document_id": "clients-python-dbapi", "content": "# to explicitly get the default connection\ncon = duckdb.connect(database = \":default:\")\n```\n\nIf you want to create a second connection to an existing database, you can use the `cursor()` method. This might be useful for example to allow parallel threads running queries independently. A single connection is thread-safe but is locked for the duration of the queries, effectively serializing database access in this case.\n\nConnections are closed implicitly when they go out of scope or if they are explicitly closed using `close()`. Once the last connection to a database instance is closed, the database instance is closed as well.", "position": 5, "token_count": 138, "has_code": true, "section_hierarchy": ["to explicitly get the default connection"], "metadata": {"chunk_id": "clients-python-dbapi-005", "document_id": "clients-python-dbapi", "position": 5, "token_count": 138, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["to explicitly get the default connection"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#to-explicitly-get-the-default-connection"}}
{"chunk_id": "clients-python-dbapi-006", "document_id": "clients-python-dbapi", "content": "## Querying\n\nSQL queries can be sent to DuckDB using the `execute()` method of connections. Once a query has been executed, results can be retrieved using the `fetchone` and `fetchall` methods on the connection. `fetchall` will retrieve all results and complete the transaction. `fetchone` will retrieve a single row of results each time that it is invoked until no more results are available. The transaction will only close once `fetchone` is called and there are no more results remaining (the return value will be `None`). As an example, in the case of a query only returning a single row, `fetchone` should be called once to retrieve the results and a second time to close the transaction. Below are some short examples:\n\n```python", "position": 6, "token_count": 167, "has_code": true, "section_hierarchy": ["Querying"], "metadata": {"chunk_id": "clients-python-dbapi-006", "document_id": "clients-python-dbapi", "position": 6, "token_count": 167, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Querying"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#querying"}}
{"chunk_id": "clients-python-dbapi-007", "document_id": "clients-python-dbapi", "content": "# create a table\ncon.execute(\"CREATE TABLE items (item VARCHAR, value DECIMAL(10, 2), count INTEGER)\")\n# insert two items into the table\ncon.execute(\"INSERT INTO items VALUES ('jeans', 20.0, 1), ('hammer', 42.2, 2)\")\n\n# retrieve the items again\ncon.execute(\"SELECT * FROM items\")\nprint(con.fetchall())\n# [('jeans', Decimal('20.00'), 1), ('hammer', Decimal('42.20'), 2)]\n\n# retrieve the items one at a time\ncon.execute(\"SELECT * FROM items\")\nprint(con.fetchone())\n# ('jeans', Decimal('20.00'), 1)\nprint(con.fetchone())\n# ('hammer', Decimal('42.20'), 2)\nprint(con.fetchone()) # This closes the transaction. Any subsequent calls to .fetchone will return None", "position": 7, "token_count": 231, "has_code": false, "section_hierarchy": ["('hammer', Decimal('42.20'), 2)"], "metadata": {"chunk_id": "clients-python-dbapi-007", "document_id": "clients-python-dbapi", "position": 7, "token_count": 231, "has_code": false, "overlap_with_previous": true, "section_hierarchy": ["('hammer', Decimal('42.20'), 2)"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#hammer-decimal4220-2"}}
{"chunk_id": "clients-python-dbapi-008", "document_id": "clients-python-dbapi", "content": "# None\n```\n\nThe `description` property of the connection object contains the column names as per the standard.", "position": 8, "token_count": 25, "has_code": true, "section_hierarchy": ["None"], "metadata": {"chunk_id": "clients-python-dbapi-008", "document_id": "clients-python-dbapi", "position": 8, "token_count": 25, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["None"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#none"}}
{"chunk_id": "clients-python-dbapi-009", "document_id": "clients-python-dbapi", "content": "### Prepared Statements\n\nDuckDB also supports [prepared statements]({% link docs/stable/sql/query_syntax/prepared_statements.md %}) in the API with the `execute` and `executemany` methods. The values may be passed as an additional parameter after a query that contains `?` or `$1` (dollar symbol and a number) placeholders. Using the `?` notation adds the values in the same sequence as passed within the Python parameter. Using the `$` notation allows for values to be reused within the SQL statement based on the number and index of the value found within the Python parameter. Values are converted according to the [conversion rules]({% link docs/stable/clients/python/conversion.md %}#object-conversion-python-object-to-duckdb).\n\nHere are some examples. First, insert a row using a [prepared statement]({% link docs/stable/sql/query_syntax/prepared_statements.md %}):\n\n```python\ncon.execute(\"INSERT INTO items VALUES (?, ?, ?)\", [\"laptop\", 2000, 1])", "position": 9, "token_count": 252, "has_code": true, "section_hierarchy": ["Prepared Statements"], "metadata": {"chunk_id": "clients-python-dbapi-009", "document_id": "clients-python-dbapi", "position": 9, "token_count": 252, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Prepared Statements"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#prepared-statements"}}
{"chunk_id": "clients-python-dbapi-010", "document_id": "clients-python-dbapi", "content": "```\n\nSecond, insert several rows using a [prepared statement]({% link docs/stable/sql/query_syntax/prepared_statements.md %}):\n\n```python\ncon.executemany(\"INSERT INTO items VALUES (?, ?, ?)\", [[\"chainsaw\", 500, 10], [\"iphone\", 300, 2]] )\n```\n\nQuery the database using a [prepared statement]({% link docs/stable/sql/query_syntax/prepared_statements.md %}):\n\n```python\ncon.execute(\"SELECT item FROM items WHERE value > ?\", [400])\nprint(con.fetchall())\n```\n\n```text\n[('laptop',), ('chainsaw',)]", "position": 10, "token_count": 178, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-dbapi-010", "document_id": "clients-python-dbapi", "position": 10, "token_count": 178, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi"}}
{"chunk_id": "clients-python-dbapi-011", "document_id": "clients-python-dbapi", "content": "```\n\n```text\n[('laptop',), ('chainsaw',)]\n```\n\nQuery using the `$` notation for a [prepared statement]({% link docs/stable/sql/query_syntax/prepared_statements.md %}) and reused values:\n\n```python\ncon.execute(\"SELECT $1, $1, $2\", [\"duck\", \"goose\"])\nprint(con.fetchall())\n```\n\n```text\n[('duck', 'duck', 'goose')]\n```\n\n> Warning Do *not* use `executemany` to insert large amounts of data into DuckDB. See the [data ingestion page]({% link docs/stable/clients/python/data_ingestion.md %}) for better options.", "position": 11, "token_count": 190, "has_code": true, "section_hierarchy": [], "metadata": {"chunk_id": "clients-python-dbapi-011", "document_id": "clients-python-dbapi", "position": 11, "token_count": 190, "has_code": true, "overlap_with_previous": true, "section_hierarchy": [], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi"}}
{"chunk_id": "clients-python-dbapi-012", "document_id": "clients-python-dbapi", "content": "## Named Parameters\n\nBesides the standard unnamed parameters, like `$1`, `$2` etc., it's also possible to supply named parameters, like `$my_parameter`.\nWhen using named parameters, you have to provide a dictionary mapping of `str` to value in the `parameters` argument.\nAn example use is the following:\n\n```python\nimport duckdb\n\nres = duckdb.execute(\"\"\"\n SELECT\n $my_param,\n $other_param,\n $also_param\n \"\"\",\n {\n \"my_param\": 5,\n \"other_param\": \"DuckDB\",\n \"also_param\": [42]\n }\n).fetchall()\nprint(res)\n```\n\n```text\n[(5, 'DuckDB', [42])]\n```", "position": 12, "token_count": 182, "has_code": true, "section_hierarchy": ["Named Parameters"], "metadata": {"chunk_id": "clients-python-dbapi-012", "document_id": "clients-python-dbapi", "position": 12, "token_count": 182, "has_code": true, "overlap_with_previous": true, "section_hierarchy": ["Named Parameters"], "file_path": "clients/python/dbapi.md", "url": "/clients/python/dbapi", "title": "Python DB API", "category": null, "tags": [], "section_url": "/clients/python/dbapi#named-parameters"}}
